{"pageProps":{"post":{"mdxSource":"var Component=(()=>{var u=Object.create;var c=Object.defineProperty;var p=Object.getOwnPropertyDescriptor;var m=Object.getOwnPropertyNames;var y=Object.getPrototypeOf,g=Object.prototype.hasOwnProperty;var s=i=>c(i,\"__esModule\",{value:!0});var w=(i,n)=>()=>(n||i((n={exports:{}}).exports,n),n.exports),v=(i,n)=>{s(i);for(var o in n)c(i,o,{get:n[o],enumerable:!0})},f=(i,n,o)=>{if(n&&typeof n==\"object\"||typeof n==\"function\")for(let t of m(n))!g.call(i,t)&&t!==\"default\"&&c(i,t,{get:()=>n[t],enumerable:!(o=p(n,t))||o.enumerable});return i},b=i=>f(s(c(i!=null?u(y(i)):{},\"default\",i&&i.__esModule&&\"default\"in i?{get:()=>i.default,enumerable:!0}:{value:i,enumerable:!0})),i);var r=w((x,h)=>{h.exports=_jsx_runtime});var A={};v(A,{default:()=>L,frontmatter:()=>k});var e=b(r()),k={title:\"How To Setup Local Tuya With Home Assistant\",author:\"Amrut Prabhu\",categories:\"\",tags:[\"Tuya\",\"Local Tuya\",\"Smart Wifi Plug\",\"Home Assistant\"],\"photo-credits\":null,\"applaud-link\":\"2021/spring-boot-stream-kafka.json\",date:\"2023-08-24\",draft:!1,summary:\"In this article, we will be looking at how we control Tuya Devices Locally using Local Tuya.\",imageUrl:\"/static/images/2023/local-tuya-setup-in-home-assistant/cover.jpg\",actualUrl:\"auto-generated\",customUrl:\"auto-generated\",youtubeLink:\"https://www.youtube.com/embed/wtzw_d4KMEQ\"};function T(i={}){let{wrapper:n}=i.components||{};return n?(0,e.jsx)(n,Object.assign({},i,{children:(0,e.jsx)(o,{})})):o();function o(){let t=Object.assign({p:\"p\",h2:\"h2\",a:\"a\",span:\"span\",ol:\"ol\",li:\"li\",strong:\"strong\",ul:\"ul\",img:\"img\",div:\"div\"},i.components),{TOCInline:l,Image:a}=t;return a||d(\"Image\",!0),l||d(\"TOCInline\",!0),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(t.p,{children:\"In this article, we will be looking at how we control Tuya Devices Locally using Local Tuya.\"}),`\n`,(0,e.jsx)(l,{toc:i.toc,asDisclosure:!0}),`\n`,(0,e.jsxs)(t.h2,{id:\"pre-requisites\",children:[(0,e.jsx)(t.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#pre-requisites\",children:(0,e.jsx)(t.span,{className:\"icon icon-link\"})}),\"Pre-Requisites\"]}),`\n`,(0,e.jsxs)(t.ol,{children:[`\n`,(0,e.jsxs)(t.li,{children:[\"You have \",(0,e.jsx)(t.strong,{children:\"Home Assistant OS\"}),\" or \",(0,e.jsx)(t.strong,{children:\"Home Assistant Container\"}),\" setup.\"]}),`\n`]}),`\n`,(0,e.jsxs)(t.p,{children:[\"You can check \",(0,e.jsx)(t.a,{href:\"https://smarthomecircle.com/connect-wifi-on-home-assistant-on-startup\",children:\"this\"}),\" article if you setting up Home Assistant OS for the first time or \",(0,e.jsx)(t.a,{href:\"https://smarthomecircle.com/run-home-assistant-container-with-docker\",children:\"this\"}),\" article if you want to set up Home Assistant Container.\"]}),`\n`,(0,e.jsxs)(t.ol,{start:\"2\",children:[`\n`,(0,e.jsx)(t.li,{children:\"You have HACS Installed.\"}),`\n`]}),`\n`,(0,e.jsx)(t.p,{children:\"If you have not installed it, here is a step-by-step guide to install it on Home Assistant OS and Home Assistant Docker container.\"}),`\n`,(0,e.jsxs)(t.ol,{start:\"3\",children:[`\n`,(0,e.jsx)(t.li,{children:\"Any Tuya device. In this case, we will be using the Tuya Wifi Plug.\"}),`\n`]}),`\n`,(0,e.jsx)(t.p,{children:\"You can buy it from this link:\"}),`\n`,(0,e.jsxs)(t.ul,{children:[`\n`,(0,e.jsxs)(t.li,{children:[(0,e.jsx)(t.a,{href:\"https://amzn.to/3KKg32j\",children:\"Tuya Wifi Plug\"}),`\n`,(0,e.jsx)(t.a,{href:\"https://amzn.to/3KKg32j\",children:(0,e.jsx)(t.img,{src:\"/static/images/2023/local-tuya-setup-in-home-assistant/tuya-smart-plug.jpg\",alt:\"Zigbee Plug\"})})]}),`\n`]}),`\n`,(0,e.jsxs)(t.ol,{start:\"4\",children:[`\n`,(0,e.jsx)(t.li,{children:\"Tuya device setup with either Tuya app or Smart Life app.\"}),`\n`]}),`\n`,(0,e.jsxs)(t.h2,{id:\"installing-local-tuya-integration-in-home-assistant\",children:[(0,e.jsx)(t.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#installing-local-tuya-integration-in-home-assistant\",children:(0,e.jsx)(t.span,{className:\"icon icon-link\"})}),\"Installing Local Tuya Integration in Home Assistant\"]}),`\n`,(0,e.jsx)(t.p,{children:\"Once you have HACS installed, head over to the HACs interface, click on \\u201CExplore and Download Repository\\u201D and search for Local Tuya Integration.\"}),`\n`,(0,e.jsx)(t.div,{children:(0,e.jsx)(a,{alt:\"1-hacs-local-tuya\",src:\"/static/images/2023/local-tuya-setup-in-home-assistant/1-hacs-local-tuya.webp\",width:\"1694\",height:\"842\"})}),`\n`,(0,e.jsx)(t.p,{children:\"Once you find it, click on it and\"}),`\n`,(0,e.jsx)(t.p,{children:\"Next, in Home Assistant UI, click on \\u201CSettings\\u201D in the left panel and then click on \\u201CDevices & Services\\u201D, then click on \\u201CAdd integration\\u201D on the bottom right-hand corner.\"}),`\n`,(0,e.jsx)(t.p,{children:\"Next, search for \\u201CZigbee Home Automation\\u201D and click on the \\u201CDownload\\u201D button, select the latest version, and click \\u201COk\\u201D.\"}),`\n`,(0,e.jsx)(t.p,{children:\"Once the repository gets downloaded you will have add the integration.\"}),`\n`,(0,e.jsx)(t.p,{children:\"For this, go to \\u201CSettings\\u201D then \\u201CDevices & Services\\u201D, click on \\u201CAdd Integration\\u201D and search for Local Tuya.\"}),`\n`,(0,e.jsx)(t.div,{children:(0,e.jsx)(a,{alt:\"2-integration-local-tuya\",src:\"/static/images/2023/local-tuya-setup-in-home-assistant/2-integration-local-tuya.webp\",width:\"1600\",height:\"688\"})}),`\n`,(0,e.jsx)(t.p,{children:\"Now, it will ask you for a Cloud API integration.\"}),`\n`,(0,e.jsx)(t.p,{children:\"Since we are not going to integrate with the cloud, click the checkbox a the bottom \\u201CDo not configure Cloud API Account\\u201D\"}),`\n`,(0,e.jsx)(t.div,{children:(0,e.jsx)(a,{alt:\"3-no-cloud-api-integration\",src:\"/static/images/2023/local-tuya-setup-in-home-assistant/3-no-cloud-api-integration.webp\",width:\"1792\",height:\"466\"})}),`\n`,(0,e.jsx)(t.p,{children:\"With this, the Local Tuya Integration is ready for use.\"}),`\n`,(0,e.jsxs)(t.h2,{id:\"adding-device-to-home-assistant-using-local-tuya\",children:[(0,e.jsx)(t.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#adding-device-to-home-assistant-using-local-tuya\",children:(0,e.jsx)(t.span,{className:\"icon icon-link\"})}),\"Adding Device To Home Assistant using Local Tuya\"]}),`\n`,(0,e.jsx)(t.p,{children:\"Now, let\\u2019s consider you have your Tuya device connected to your Wifi network using the Smart Life app.\"}),`\n`,(0,e.jsx)(t.p,{children:\"Next, make sure to connect the plug to a power outlet and then connect some device to it such that it's consuming some energy. (It could be your phone charger actively charging your mobile phone).\"}),`\n`,(0,e.jsx)(t.p,{children:\"We would be using the values of the energy consumption that shows up in the Smart Life app to properly configure the plug in Local Tuya.\"}),`\n`,(0,e.jsx)(t.p,{children:\"With this done we will search for this plug which is connected to your Wifi network using the Local Tuya integration.\"}),`\n`,(0,e.jsx)(t.p,{children:\"For this, we will open the Local Tuya Integration and click on \\u201CConfigure\\u201D and then select the action \\u201CAdd a new Device\\u201D.\"}),`\n`,(0,e.jsx)(t.div,{children:(0,e.jsx)(a,{alt:\"4-add-local-tuya-device\",src:\"/static/images/2023/local-tuya-setup-in-home-assistant/4-add-local-tuya-device.webp\",width:\"2092\",height:\"1174\"})}),`\n`,(0,e.jsx)(t.p,{children:\"Now, it will show you the device id of your Tuya device.\"}),`\n`,(0,e.jsx)(t.div,{children:(0,e.jsx)(a,{alt:\"5-device-id-local-tuya\",src:\"/static/images/2023/local-tuya-setup-in-home-assistant/5-device-id-local-tuya.webp\",width:\"1970\",height:\"972\"})}),`\n`,(0,e.jsx)(t.p,{children:\"You can verify the device id of your device by checking the \\u201Cdevice information\\u201D in the Smart Life app as shown above.\"}),`\n`,(0,e.jsx)(t.p,{children:\"Next, we will have to fill in the local key.\"}),`\n`,(0,e.jsx)(t.div,{children:(0,e.jsx)(a,{alt:\"6-empty-local-key\",src:\"/static/images/2023/local-tuya-setup-in-home-assistant/6-empty-local-key.webp\",width:\"1756\",height:\"956\"})}),`\n`,(0,e.jsx)(t.p,{children:\"For this, we will have to create a Tuya developer account to find the Local key.\"}),`\n`,(0,e.jsxs)(t.h2,{id:\"finding-local-key-for-tuya-devices\",children:[(0,e.jsx)(t.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#finding-local-key-for-tuya-devices\",children:(0,e.jsx)(t.span,{className:\"icon icon-link\"})}),\"Finding Local Key For Tuya Devices\"]}),`\n`,(0,e.jsx)(t.p,{children:\"To find the Local key, you will have to create a Tuya developer account.\"}),`\n`,(0,e.jsx)(t.p,{children:\"We will only need this account to find the Local Key and then we can delete the account.\"}),`\n`,(0,e.jsxs)(t.p,{children:[\"For this, head to \",(0,e.jsx)(t.a,{href:\"https://iot.tuya.com/\",children:\"https://iot.tuya.com/\"}),\" and create a developer account.\"]}),`\n`,(0,e.jsx)(t.p,{children:\"Once you have logged in, click on the \\u201CCloud\\u201D icon on the left menu bar and then click on \\u201CCreate Cloud Project\\u201D\"}),`\n`,(0,e.jsx)(t.p,{children:\"Here, specify any project name, any industry, any development method, and then any data center that you wish.\"}),`\n`,(0,e.jsx)(t.p,{children:\"Remember we won\\u2019t be needing this project after we find the Local keys.\"}),`\n`,(0,e.jsx)(t.div,{children:(0,e.jsx)(a,{alt:\"7-cloud-project\",src:\"/static/images/2023/local-tuya-setup-in-home-assistant/7-cloud-project.webp\",width:\"2660\",height:\"1114\"})}),`\n`,(0,e.jsx)(t.p,{children:\"Once the project is created, click on the \\u201CDevices\\u201D tab and then click on \\u201CLink Tuya app\\u201D.\"}),`\n`,(0,e.jsx)(t.div,{children:(0,e.jsx)(a,{alt:\"8-link-app\",src:\"/static/images/2023/local-tuya-setup-in-home-assistant/8-link-app.webp\",width:\"1662\",height:\"688\"})}),`\n`,(0,e.jsx)(t.p,{children:\"Now, scan the QR code using your Smart Life app, by selecting the add device option in the app and scan the QR code.\"}),`\n`,(0,e.jsx)(t.p,{children:\"With this, the app is now linked to the cloud project.\"}),`\n`,(0,e.jsx)(t.p,{children:\"Next, click on \\u201CCloud\\u201D on the left panel and select \\u201CAPI Explorer\\u201D\"}),`\n`,(0,e.jsx)(t.div,{children:(0,e.jsx)(a,{alt:\"9-api-explorer\",src:\"/static/images/2023/local-tuya-setup-in-home-assistant/9-api-explorer.webp\",width:\"1522\",height:\"712\"})}),`\n`,(0,e.jsx)(t.p,{children:\"This will open in a new tab.\"}),`\n`,(0,e.jsx)(t.p,{children:\"Now, in this new tab, click on \\u201CDevice Management\\u201D in the left panel and then click on \\u201CQuery Device Details\\u201D, enter the device id of your tuya device, and click on \\u201CSubmit Request\\u201D\"}),`\n`,(0,e.jsx)(t.div,{children:(0,e.jsx)(a,{alt:\"10-query-device\",src:\"/static/images/2023/local-tuya-setup-in-home-assistant/10-query-device.webp\",width:\"1974\",height:\"948\"})}),`\n`,(0,e.jsx)(t.p,{children:\"This will show a response. You need to now use the Local Key in the response as shown below.\"}),`\n`,(0,e.jsx)(t.div,{children:(0,e.jsx)(a,{alt:\"11-local-key\",src:\"/static/images/2023/local-tuya-setup-in-home-assistant/11-local-key.webp\",width:\"2108\",height:\"928\"})}),`\n`,(0,e.jsxs)(t.h2,{id:\"adding-local-key-to-local-tuya-device\",children:[(0,e.jsx)(t.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#adding-local-key-to-local-tuya-device\",children:(0,e.jsx)(t.span,{className:\"icon icon-link\"})}),\"Adding Local Key to Local Tuya Device\"]}),`\n`,(0,e.jsx)(t.p,{children:\"Once you have figured out the Local Key, add it to the Local Tuya setup.\"}),`\n`,(0,e.jsx)(t.div,{children:(0,e.jsx)(a,{alt:\"12-configure-local-key\",src:\"/static/images/2023/local-tuya-setup-in-home-assistant/12-configure-local-key.webp\",width:\"1814\",height:\"906\"})}),`\n`,(0,e.jsx)(t.p,{children:\"Now click next and here we will configure the Consumption value.\"}),`\n`,(0,e.jsx)(t.p,{children:\"For this, open the power consumption section in the Smart Life app and check the current consumption values.\"}),`\n`,(0,e.jsx)(t.p,{children:\"You will have to select the values that are close to the values in the drop. You can ignore the decimal points, but if the numbers match you can probably use the value.\"}),`\n`,(0,e.jsx)(t.div,{children:(0,e.jsx)(a,{alt:\"13-select-voltage-values\",src:\"/static/images/2023/local-tuya-setup-in-home-assistant/13-select-voltage-values.webp\",width:\"2000\",height:\"1016\"})}),`\n`,(0,e.jsx)(t.p,{children:\"For example, in the above image, the voltage value even though it shows, 232.1, you can select the number 2321.\"}),`\n`,(0,e.jsx)(t.p,{children:\"Same thing you would have to do for the current and current consumption values.\"}),`\n`,(0,e.jsx)(t.p,{children:\"Once you do that click on finish.\"}),`\n`,(0,e.jsx)(t.p,{children:\"You should be able to see the plug now in Home Assistant.\"}),`\n`,(0,e.jsx)(t.div,{children:(0,e.jsx)(a,{alt:\"14-switch-home-assistant\",src:\"/static/images/2023/local-tuya-setup-in-home-assistant/14-switch-home-assistant.webp\",width:\"1572\",height:\"660\"})}),`\n`,(0,e.jsxs)(t.h2,{id:\"verify-energy-consumption-values\",children:[(0,e.jsx)(t.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#verify-energy-consumption-values\",children:(0,e.jsx)(t.span,{className:\"icon icon-link\"})}),\"Verify Energy Consumption Values\"]}),`\n`,(0,e.jsx)(t.p,{children:\"To verify the energy consumption values are correct, click on the \\u201CDeveloper Tools\\u201D in Home Assistant and select the \\u201CStates\\u201D tab.\"}),`\n`,(0,e.jsx)(t.p,{children:\"Now here filter the entities by the switch entity name you gave.\"}),`\n`,(0,e.jsx)(t.p,{children:\"Now in the fouth column compare the values with the Smart Life app.\"}),`\n`,(0,e.jsx)(t.p,{children:\"If they match, it's all good.\"}),`\n`,(0,e.jsx)(t.p,{children:\"But if they are not correct and don\\u2019t match that on the app, you will have to reconfigure the values.\"}),`\n`,(0,e.jsx)(t.p,{children:\"For this, you can head over to the Local Tuya Integration again, Click on \\u201CConfigure\\u201D then this time select \\u201CEdit a device\\u201D\"}),`\n`,(0,e.jsx)(t.div,{children:(0,e.jsx)(a,{alt:\"15-edit-device\",src:\"/static/images/2023/local-tuya-setup-in-home-assistant/15-edit-device.webp\",width:\"1468\",height:\"808\"})}),`\n`,(0,e.jsx)(t.p,{children:\"Now, when you create the energy consumption value section, you will just have to try with a different value and see if it works.\"}),`\n`,(0,e.jsx)(t.p,{children:\"Its a bit difficult to get it correct in the first go, so you might have to keep trying different values for sometime. \\u{1F642}\"}),`\n`,(0,e.jsx)(t.p,{children:\"Once you find the correct values, it should be all fine.\"}),`\n`,(0,e.jsx)(t.div,{children:(0,e.jsx)(a,{alt:\"16-correct-consumption-values\",src:\"/static/images/2023/local-tuya-setup-in-home-assistant/16-correct-consumption-values.webp\",width:\"1536\",height:\"976\"})}),`\n`,(0,e.jsx)(t.p,{children:\"If you are interested in more such Home Automation Setups and Ideas, you can read the following three articles\"}),`\n`,(0,e.jsxs)(t.ul,{children:[`\n`,(0,e.jsx)(t.li,{children:(0,e.jsx)(t.a,{href:\"https://smarthomecircle.com/esp32-cam-esphome-with-home-assistant\",children:(0,e.jsx)(t.strong,{children:\"Setup ESP32 CAM With ESP Home and Home Assistant\"})})}),`\n`,(0,e.jsx)(t.li,{children:(0,e.jsx)(t.a,{href:\"https://smarthomecircle.com/add-matter-devices-to-home-assistant\",children:(0,e.jsx)(t.strong,{children:\"Adding a Matter Device to Home Assistant\"})})}),`\n`,(0,e.jsx)(t.li,{children:(0,e.jsx)(t.a,{href:\"https://smarthomecircle.com/air-quality-sensor-and-light-sensor-esp32-home-assistant\",children:(0,e.jsx)(t.strong,{children:\"Build Air Quality Monitor With Light Sensor For Home Assistant\"})})}),`\n`]})]})}}var L=T;function d(i,n){throw new Error(\"Expected \"+(n?\"component\":\"object\")+\" `\"+i+\"` to be defined: you likely forgot to import, pass, or provide it.\")}return A;})();\n;return Component;","toc":[{"value":"Pre-Requisites","url":"#pre-requisites","depth":2},{"value":"Installing Local Tuya Integration in Home Assistant","url":"#installing-local-tuya-integration-in-home-assistant","depth":2},{"value":"Adding Device To Home Assistant using Local Tuya","url":"#adding-device-to-home-assistant-using-local-tuya","depth":2},{"value":"Finding Local Key For Tuya Devices","url":"#finding-local-key-for-tuya-devices","depth":2},{"value":"Adding Local Key to Local Tuya Device","url":"#adding-local-key-to-local-tuya-device","depth":2},{"value":"Verify Energy Consumption Values","url":"#verify-energy-consumption-values","depth":2}],"frontMatter":{"readingTime":{"text":"6 min read","minutes":5.7,"time":342000,"words":1140},"slug":"2023/how-to-setup-local-tuya-in-home-assistant","fileName":"2023/how-to-setup-local-tuya-in-home-assistant.md","title":"How To Setup Local Tuya With Home Assistant","author":"Amrut Prabhu","categories":"","tags":["Tuya","Local Tuya","Smart Wifi Plug","Home Assistant"],"photo-credits":null,"applaud-link":"2021/spring-boot-stream-kafka.json","date":"2023-08-24T00:00:00.000Z","draft":false,"summary":"In this article, we will be looking at how we control Tuya Devices Locally using Local Tuya.","imageUrl":"/static/images/2023/local-tuya-setup-in-home-assistant/cover.jpg","actualUrl":"2023/how-to-setup-local-tuya-in-home-assistant","customUrl":"how-to-setup-local-tuya-in-home-assistant","youtubeLink":"https://www.youtube.com/embed/wtzw_d4KMEQ"}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.775,"time":46500,"words":155},"slug":["default"],"fileName":"default.md","name":"Amrut Prabhu","avatar":"/static/images/avatar-small.jpg","avatarBig":"/static/images/avatar-big.jpg","occupation":"","company":"","email":"SmartHomeCircle@gmail.com","twitter":"https://twitter.com/amrutprabhu42","linkedin":"","github":"","youtube":"https://www.youtube.com/@SmartHomeCircle","customUrl":"default","actualUrl":"default","date":null}],"prev":{"title":"Connect Zigbee Plug Using Sonoff Zigbee 3.0 USB Dongle Plus To Home Assistant - Step By Step Guide","author":"Amrut Prabhu","categories":"","tags":["Zigbee","Sonoff Dongle Plus","Home Assistant"],"photo-credits":null,"applaud-link":"2021/spring-boot-stream-kafka.json","date":"2023-08-17T00:00:00.000Z","draft":false,"summary":"In this article, we will be looking at how we can connect Zigbee Devices using Sonoff Zigbee 3.0 USB Dongle Plus to Home Assistant.","imageUrl":"/static/images/2023/sonoff-zigbee-3-dongle-home-assistant/cover.jpg","actualUrl":"2023/connect-zigbee-device-using-sonoff-zigbee-3-dongle-plus-to-home-assistant","customUrl":"connect-zigbee-device-using-sonoff-zigbee-3-dongle-plus-to-home-assistant","youtubeLink":"https://www.youtube.com/embed/DynzcuwaY7s","slug":"connect-zigbee-device-using-sonoff-zigbee-3-dongle-plus-to-home-assistant"},"next":{"title":"How I Setup MQTT Broker Docker Container Or Addon In Home Assistant — Step-By-Step Guide","author":"Amrut Prabhu","categories":"","tags":["MQTT","Home Assistant","Docker"],"photo-credits":null,"applaud-link":"2021/spring-boot-stream-kafka.json","date":"2023-09-07T00:00:00.000Z","draft":false,"summary":"In this article, we will be looking at how we configure Frigate to detect object and then connect it to Home Assistant to receive notification.","imageUrl":"/static/images/2023/mqtt-broker-setup/cover.jpg","actualUrl":"2023/how-to-setup-mqtt-docker-container-with-home-assistant","customUrl":"how-to-setup-mqtt-docker-container-with-home-assistant","youtubeLink":"","slug":"how-to-setup-mqtt-docker-container-with-home-assistant"}},"__N_SSG":true}