<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><script>!function(){try {var d=document.documentElement.classList;d.remove('light','dark');var e=localStorage.getItem('theme');d.add('light');if("system"===e||(!e&&false)){var t="(prefers-color-scheme: dark)",m=window.matchMedia(t);m.media!==t||m.matches?d.add('dark'):d.add('light')}else if(e) d.add(e)}catch(e){}}()</script><meta content="width=device-width, initial-scale=1" name="viewport"/><title>How I Created My Voice Assistant With On-Device Wake Word Detection On ESP32 Using Micro Wake Word | Smart Home Circle</title><meta name="robots" content="follow, index"/><meta name="description" content="In this article, we will look at how I created my Voice Assistant with an ESP32 S3 with on-device Wake Word detection using MicroWake Word to send commands to Home Assistant"/><meta property="og:url" content="https://smarthomecircle.com/How-I-created-my-voice-assistant-with-on-device-wake-word-using-home-assistant"/><meta property="og:type" content="article"/><meta property="og:site_name" content="Smart Home Circle"/><meta property="og:description" content="In this article, we will look at how I created my Voice Assistant with an ESP32 S3 with on-device Wake Word detection using MicroWake Word to send commands to Home Assistant"/><meta property="og:title" content="How I Created My Voice Assistant With On-Device Wake Word Detection On ESP32 Using Micro Wake Word"/><meta property="og:image" content="https://smarthomecircle.com/static/images/2024/created-my-voice-assistant/cover.webp"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="https://twitter.com/smarthomecircle"/><meta name="twitter:title" content="How I Created My Voice Assistant With On-Device Wake Word Detection On ESP32 Using Micro Wake Word"/><meta name="twitter:description" content="In this article, we will look at how I created my Voice Assistant with an ESP32 S3 with on-device Wake Word detection using MicroWake Word to send commands to Home Assistant"/><meta name="twitter:image" content="https://smarthomecircle.com/static/images/2024/created-my-voice-assistant/cover.webp"/><meta property="article:published_time" content="2024-05-23T00:00:00.000Z"/><link rel="canonical" href="https://smarthomecircle.com/How-I-created-my-voice-assistant-with-on-device-wake-word-using-home-assistant"/><meta name="next-head-count" content="19"/><link rel="apple-touch-icon" sizes="76x76" href="/static/favicons/icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/static/favicons/icon.png"/><link rel="icon" type="image/png" sizes="16x16" href="/static/favicons/icon.png"/><link rel="manifest" href="/static/favicons/site.webmanifest"/><meta name="msapplication-TileColor" content="#000000"/><meta name="theme-color" content="#000000"/><link rel="alternate" type="application/rss+xml" href="/feed.xml"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"/><script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7490174059724719" crossorigin="anonymous"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" integrity="sha384-Um5gpz1odJg5Z4HAmzPtgZKdTBHZdw8S29IecapCSB31ligYPhHQZMIlWLYQGVoc" crossorigin="anonymous"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin /><link rel="preload" href="/_next/static/css/5f7beb8f2b5ae8c0.css" as="style" crossorigin=""/><link rel="stylesheet" href="/_next/static/css/5f7beb8f2b5ae8c0.css" crossorigin="" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" crossorigin="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-6009730556bddae7.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/main-813e4218627b5a82.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/pages/_app-9948ba1951d3eeac.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/146-6e5e503440377105.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/158-8fd8e2b305180da3.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/pages/%5Bslug%5D-f49d9f6c4e8bed79.js" defer="" crossorigin=""></script><script src="/_next/static/IF3Ce1pL9YmMukIvsy3Ax/_buildManifest.js" defer="" crossorigin=""></script><script src="/_next/static/IF3Ce1pL9YmMukIvsy3Ax/_ssgManifest.js" defer="" crossorigin=""></script><style data-href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap">@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcCO3FwrK3iLTeHuS_nVMrMxCp50SjIw2boKoduKmMEVuLyfMZs.woff) format('woff')}@font-face{font-family:'Inter';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcCO3FwrK3iLTeHuS_nVMrMxCp50SjIw2boKoduKmMEVuI6fMZs.woff) format('woff')}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcCO3FwrK3iLTeHuS_nVMrMxCp50SjIw2boKoduKmMEVuGKYMZs.woff) format('woff')}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcCO3FwrK3iLTeHuS_nVMrMxCp50SjIw2boKoduKmMEVuFuYMZs.woff) format('woff')}@font-face{font-family:'JetBrains Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v24/tDbY2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKxjPg.woff) format('woff')}@font-face{font-family:'JetBrains Mono';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v24/tDbY2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8-qxjPg.woff) format('woff')}@font-face{font-family:'JetBrains Mono';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v24/tDbY2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8FqtjPg.woff) format('woff')}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2JL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C8A,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa0ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa1pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0370-0377,U+037A-037F,U+0384-038A,U+038C,U+038E-03A1,U+03A3-03FF}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa25L7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa1ZL7W0Q5nw.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Inter';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2JL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C8A,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Inter';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa0ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Inter';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Inter';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa1pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0370-0377,U+037A-037F,U+0384-038A,U+038C,U+038E-03A1,U+03A3-03FF}@font-face{font-family:'Inter';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Inter';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa25L7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Inter';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa1ZL7W0Q5nw.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2JL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C8A,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa0ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa1pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0370-0377,U+037A-037F,U+0384-038A,U+038C,U+038E-03A1,U+03A3-03FF}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa25L7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa1ZL7W0Q5nw.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2JL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C8A,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa0ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa1pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0370-0377,U+037A-037F,U+0384-038A,U+038C,U+038E-03A1,U+03A3-03FF}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa25L7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa1ZL7W0Q5nw.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'JetBrains Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v24/tDbv2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKwBNntkaToggR7BYRbKPx3cwgknk-6nFg.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C8A,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'JetBrains Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v24/tDbv2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKwBNntkaToggR7BYRbKPxTcwgknk-6nFg.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'JetBrains Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v24/tDbv2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKwBNntkaToggR7BYRbKPxPcwgknk-6nFg.woff2) format('woff2');unicode-range:U+0370-0377,U+037A-037F,U+0384-038A,U+038C,U+038E-03A1,U+03A3-03FF}@font-face{font-family:'JetBrains Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v24/tDbv2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKwBNntkaToggR7BYRbKPx_cwgknk-6nFg.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:'JetBrains Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v24/tDbv2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKwBNntkaToggR7BYRbKPx7cwgknk-6nFg.woff2) format('woff2');unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'JetBrains Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v24/tDbv2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKwBNntkaToggR7BYRbKPxDcwgknk-4.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'JetBrains Mono';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v24/tDbv2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKwBNntkaToggR7BYRbKPx3cwgknk-6nFg.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C8A,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'JetBrains Mono';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v24/tDbv2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKwBNntkaToggR7BYRbKPxTcwgknk-6nFg.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'JetBrains Mono';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v24/tDbv2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKwBNntkaToggR7BYRbKPxPcwgknk-6nFg.woff2) format('woff2');unicode-range:U+0370-0377,U+037A-037F,U+0384-038A,U+038C,U+038E-03A1,U+03A3-03FF}@font-face{font-family:'JetBrains Mono';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v24/tDbv2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKwBNntkaToggR7BYRbKPx_cwgknk-6nFg.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:'JetBrains Mono';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v24/tDbv2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKwBNntkaToggR7BYRbKPx7cwgknk-6nFg.woff2) format('woff2');unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'JetBrains Mono';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v24/tDbv2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKwBNntkaToggR7BYRbKPxDcwgknk-4.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'JetBrains Mono';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v24/tDbv2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKwBNntkaToggR7BYRbKPx3cwgknk-6nFg.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C8A,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'JetBrains Mono';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v24/tDbv2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKwBNntkaToggR7BYRbKPxTcwgknk-6nFg.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'JetBrains Mono';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v24/tDbv2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKwBNntkaToggR7BYRbKPxPcwgknk-6nFg.woff2) format('woff2');unicode-range:U+0370-0377,U+037A-037F,U+0384-038A,U+038C,U+038E-03A1,U+03A3-03FF}@font-face{font-family:'JetBrains Mono';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v24/tDbv2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKwBNntkaToggR7BYRbKPx_cwgknk-6nFg.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:'JetBrains Mono';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v24/tDbv2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKwBNntkaToggR7BYRbKPx7cwgknk-6nFg.woff2) format('woff2');unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'JetBrains Mono';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v24/tDbv2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKwBNntkaToggR7BYRbKPxDcwgknk-4.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style></head><body class="antialiased text-gray-700 bg-white dark:bg-gray-900 dark:text-gray-300 font-sans"><div id="__next"><div class="max-w-3xl px-4 mx-auto sm:px-6 xl:max-w-6xl xl:px-0"><div class="flex flex-col justify-between h-screen"><header class="flex items-center justify-between py-10"><div><a aria-label="SmartHomeCircle" href="/"><div class="flex items-center"><div class="mr-3"><img alt="smart home circle" loading="lazy" width="50" height="50" decoding="async" data-nimg="1" style="color:transparent" src="/static/favicons/icon.png"/></div><div class="text-2xl font-semibold sm:block">Smart Home Circle</div></div></a></div><div class="mt-6"></div><div class="flex items-center text-base leading-5"><div class="hidden sm:flex items-center"><a target="_blank" rel="noopener noreferrer" href="https://www.youtube.com/@SmartHomeCircle" class="p-1 font-medium text-gray-900 sm:p-4 dark:text-gray-100">YouTube</a><a class="p-1 font-medium text-gray-900 sm:p-4 dark:text-gray-100" href="/tags">Tags</a><a class="p-1 font-medium text-gray-900 sm:p-4 dark:text-gray-100" href="/posts">Posts</a><a class="p-1 font-medium text-gray-900 sm:p-4 dark:text-gray-100" href="/about">About &amp; Contact</a><a target="_blank" rel="noopener noreferrer" href="https://www.buymeacoffee.com/amrutprabhu"><img alt="Buy Me A Coffee" loading="lazy" width="140" height="20" decoding="async" data-nimg="1" style="color:transparent" src="static/buymeacoffee.png"/></a></div><button aria-label="Toggle Dark Mode" type="button" class="w-8 h-8 p-1 ml-1 mr-1 rounded sm:ml-4"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path></svg></button><div class="sm:hidden"><button type="button" class="w-8 h-8 py-1 ml-1 mr-1 rounded" aria-label="Toggle Menu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg></button><div class="fixed w-full h-full top-24 right-0 bg-gray-200 dark:bg-gray-800 opacity-95 z-10 transform ease-in-out duration-300 translate-x-full"><button type="button" aria-label="toggle modal" class="fixed w-full h-full cursor-auto focus:outline-none"></button><nav class="fixed h-full mt-8"><div class="px-12 py-4"><a target="_blank" rel="noopener noreferrer" href="https://www.youtube.com/@SmartHomeCircle" class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100">YouTube</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/tags">Tags</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/posts">Posts</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/about">About &amp; Contact</a></div><div class="px-12 py-4"><a target="_blank" rel="noopener noreferrer" href="https://www.buymeacoffee.com/amrutprabhu"><img alt="Buy Me A Coffee" loading="lazy" width="140" height="20" decoding="async" data-nimg="1" style="color:transparent" src="static/buymeacoffee.png"/></a></div></nav></div></div></div></header><main class="mb-auto"><div class="max-w-3xl px-4 mx-auto sm:px-6 xl:max-w-6xl xl:px-0"><div class="fixed flex-col hidden gap-3 right-8 bottom-8 md:flex"><button aria-label="Scroll To Top" type="button" style="opacity:0" class="p-2 text-gray-500 transition-all bg-gray-200 rounded-full dark:text-gray-400 dark:bg-gray-700 dark:hover:bg-gray-600 hover:bg-gray-300"><svg class="w-5 h-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z" clip-rule="evenodd"></path></svg></button></div><article><header class="relative"><div class="absolute inset-0 bg-gradient-to-br from-gray-50 via-white to-primary-50 dark:from-gray-900 dark:via-gray-900 dark:to-primary-900/20 -z-10"></div><div class="relative pt-12 pb-16"><div class="flex items-center justify-center mb-6"><a class="inline-flex items-center text-sm font-medium text-primary-600 hover:text-primary-700 dark:text-primary-400 dark:hover:text-primary-300 transition-colors" href="/"><svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>Blog Article</a></div><div class="max-w-4xl mx-auto text-center space-y-6"><h1 class="text-4xl md:text-5xl lg:text-6xl font-bold text-gray-900 dark:text-gray-100 leading-tight">How I Created My Voice Assistant With On-Device Wake Word Detection On ESP32 Using Micro Wake Word</h1><div class="flex flex-wrap items-center justify-center gap-6 text-sm text-gray-600 dark:text-gray-300"><div class="flex items-center"><svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg><time dateTime="2024-05-23T00:00:00.000Z">Thursday, May 23, 2024</time></div><div class="flex items-center"><svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>63 min read</div></div></div><div class="max-w-5xl mx-auto mt-12"><div class="relative overflow-hidden rounded-2xl shadow-2xl"><div class="absolute inset-0 bg-gradient-to-t from-black/10 via-transparent to-transparent z-10"></div><img alt="How I Created My Voice Assistant With On-Device Wake Word Detection On ESP32 Using Micro Wake Word" loading="lazy" width="800" height="450" decoding="async" data-nimg="1" class="object-cover object-center w-full h-auto" style="color:transparent" src="/static/images/2024/created-my-voice-assistant/cover.webp"/></div></div></div></header><div class="max-w-6xl mx-auto px-4 py-16"><div class="lg:grid lg:grid-cols-12 lg:gap-8"><div class="lg:col-span-8"><div class="mb-12 p-6 bg-gray-50 dark:bg-gray-800/50 rounded-2xl border border-gray-200 dark:border-gray-700"><h3 class="text-sm font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wide mb-4">Written by</h3><div class="flex items-center space-x-4"><div class="flex items-center space-x-3"><img alt="Amrut Prabhu avatar" loading="lazy" width="48" height="48" decoding="async" data-nimg="1" class="w-12 h-12 rounded-full ring-2 ring-white dark:ring-gray-700" style="color:transparent" src="/static/images/avatar-small.jpg"/><div><div class="font-semibold text-gray-900 dark:text-gray-100">Amrut Prabhu</div><a target="_blank" rel="noopener noreferrer" href="https://twitter.com/smarthomecircle" class="text-sm text-primary-600 hover:text-primary-700 dark:text-primary-400 dark:hover:text-primary-300 transition-colors">@smarthomecircle</a></div></div></div></div><div class="mb-12 space-y-8"><h3 class="text-lg font-semibold text-gray-900 dark:text-gray-100">Featured Video</h3><div class="relative w-full rounded-2xl overflow-hidden shadow-lg" style="padding-bottom:56.25%"><iframe id="youtubeLink12024-05-23T00:00:00.000Z" class="absolute top-0 left-0 w-full h-full" src="https://www.youtube.com/embed/aPP2alIU7Gg" frameBorder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="" title="Featured video player"></iframe></div></div><div class="prose prose-lg dark:prose-dark max-w-none prose-headings:font-bold prose-headings:text-gray-900 dark:prose-headings:text-gray-100 prose-p:text-gray-700 dark:prose-p:text-gray-300 prose-strong:text-gray-900 dark:prose-strong:text-gray-100 prose-code:text-primary-600 dark:prose-code:text-primary-400 prose-pre:bg-gray-900 dark:prose-pre:bg-gray-800 prose-blockquote:border-primary-500 prose-blockquote:text-gray-700 dark:prose-blockquote:text-gray-300"><p>In this article, we will look at how I created my voice Assistant with On-Device Wake Word detection on an ESP32 S3 using MicroWake Word to send commands to Home Assistant.</p>
<details open=""><summary class="pt-2 pb-2 ml-6 text-xl font-bold">Table of Contents</summary><div class="ml-6"><ul><li class="false"><a href="#requirements">Requirements</a></li><li class="false"><a href="#3d-print-template-for-voice-assistant-case">3D Print Template For Voice Assistant Case</a></li><li class="false"><a href="#set-up-voice-assist-pipeline">Set up Voice Assist Pipeline</a></li><li class="false"><a href="#circuit-diagram-for-esp32-s3-with-inmp441-microphone--max98357a-audio-amplifier">Circuit Diagram for ESP32 S3 With INMP441 Microphone &amp; MAX98357A Audio Amplifier</a></li><li class="false"><a href="#flashing-code-to-esp32-s3-with-esphome">Flashing Code to ESP32 S3 with ESPHome</a></li><li class="false"><a href="#connecting-esp32-s3-as-voice-assistant-in-home-assistant">Connecting ESP32 S3 As Voice Assistant In Home Assistant</a></li></ul></div></details>
<h2 id="requirements"><a href="#requirements" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Requirements</h2>
<ol>
<li><strong>Home Assistant</strong> up and running.<br/>
<!-- -->You can check <a target="_blank" rel="noopener noreferrer" href="https://smarthomecircle.com/how-to-connect-wifi-to-home-assistant-on-startup">this</a> link to see how you can install it for the first time</li>
<li><strong>ESPHome</strong> is setup and running<br/>
<!-- -->In case you have not set it up, you can look at it <a target="_blank" rel="noopener noreferrer" href="https://smarthomecircle.com/esp32-esp8266-esphome-with-home-assistant">here</a>.</li>
<li><strong>ESP32 S3 N8R2 or N16R8 Dev Board</strong></li>
</ol>
<p><a target="_blank" rel="noopener noreferrer" href="https://s.click.aliexpress.com/e/_DFopt57"><img src="/static/images/components/esp32-s3-n8r2.webp" alt="ESP32 S3 "/></a></p>
<div class="border-l-4 border-primary-500 bg-primary-50 dark:bg-primary-900/20 pl-4 pr-3 py-1 my-3 rounded-r-lg"><div class="flex flex-wrap gap-1.5 py-1.5"><a href="https://s.click.aliexpress.com/e/_DFopt57" target="_blank" rel="noopener noreferrer" class="inline-flex items-center px-2 py-1 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors"><svg class="w-3 h-3 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path></svg>AliExpress</a><a href="https://amzn.to/3xnA8ax" target="_blank" rel="noopener noreferrer" class="inline-flex items-center px-2 py-1 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors"><svg class="w-3 h-3 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path></svg>Amazon</a></div></div>
<p>Guide for ordering ESP32 S3 N8R2 or N16R8 Board is <a target="_blank" rel="noopener noreferrer" href="https://docs.espressif.com/projects/esp-idf/en/stable/esp32s3/hw-reference/esp32s3/user-guide-devkitc-1.html#ordering-information">here</a></p>
<br/>
<ol start="4">
<li><strong>INMP441 Microphone</strong></li>
</ol>
<p><a target="_blank" rel="noopener noreferrer" href="https://s.click.aliexpress.com/e/_Dmn2PyR"><img src="/static/images/2023/esp32-voice-assistant/inmp441-microphone.webp" alt="INMP441 MICROPHONE"/></a></p>
<div class="border-l-4 border-primary-500 bg-primary-50 dark:bg-primary-900/20 pl-4 pr-3 py-1 my-3 rounded-r-lg"><div class="flex flex-wrap gap-1.5 py-1.5"><a href="https://s.click.aliexpress.com/e/_Dmn2PyR" target="_blank" rel="noopener noreferrer" class="inline-flex items-center px-2 py-1 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors"><svg class="w-3 h-3 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path></svg>AliExpress</a><a href="https://amzn.to/3GdxO7o" target="_blank" rel="noopener noreferrer" class="inline-flex items-center px-2 py-1 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors"><svg class="w-3 h-3 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path></svg>Amazon</a></div></div>
<br/>
<ol start="5">
<li><strong>MAX98357A Audio Amplifier</strong></li>
</ol>
<p><a target="_blank" rel="noopener noreferrer" href="https://s.click.aliexpress.com/e/_DdyIFTH"><img src="/static/images/2023/esp32-voice-assistant/MAX98357A.webp" alt="MAX98357A"/></a></p>
<div class="border-l-4 border-primary-500 bg-primary-50 dark:bg-primary-900/20 pl-4 pr-3 py-1 my-3 rounded-r-lg"><div class="flex flex-wrap gap-1.5 py-1.5"><a href="https://s.click.aliexpress.com/e/_DdyIFTH" target="_blank" rel="noopener noreferrer" class="inline-flex items-center px-2 py-1 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors"><svg class="w-3 h-3 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path></svg>AliExpress</a><a href="https://amzn.to/46wKTmW" target="_blank" rel="noopener noreferrer" class="inline-flex items-center px-2 py-1 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors"><svg class="w-3 h-3 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path></svg>Amazon</a></div></div>
<br/>
<ol start="6">
<li><strong>3-watt Speakers</strong> (Optional: Only required to listen to the pipeline output)</li>
</ol>
<p><a target="_blank" rel="noopener noreferrer" href="https://s.click.aliexpress.com/e/_DBDIScT"><img src="/static/images/2023/esp32-voice-assistant/3-watt-speakers.webp" alt="3 watt speaker"/></a></p>
<div class="border-l-4 border-primary-500 bg-primary-50 dark:bg-primary-900/20 pl-4 pr-3 py-1 my-3 rounded-r-lg"><div class="flex flex-wrap gap-1.5 py-1.5"><a href="https://s.click.aliexpress.com/e/_DBDIScT" target="_blank" rel="noopener noreferrer" class="inline-flex items-center px-2 py-1 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors"><svg class="w-3 h-3 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path></svg>AliExpress</a><a href="https://amzn.to/49BbAJR" target="_blank" rel="noopener noreferrer" class="inline-flex items-center px-2 py-1 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors"><svg class="w-3 h-3 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path></svg>Amazon</a></div></div>
<ol start="7">
<li><strong>COB 5mm WS2812B LED Strip</strong></li>
</ol>
<p><a target="_blank" rel="noopener noreferrer" href="https://s.click.aliexpress.com/e/_DDtD9SP"><img src="/static/images/components/Ws2812b-cob-led-strip.webp" alt="WS2812B LED Strip"/></a></p>
<div class="border-l-4 border-primary-500 bg-primary-50 dark:bg-primary-900/20 pl-4 pr-3 py-1 my-3 rounded-r-lg"><div class="flex flex-wrap gap-1.5 py-1.5"><a href="https://s.click.aliexpress.com/e/_DDtD9SP" target="_blank" rel="noopener noreferrer" class="inline-flex items-center px-2 py-1 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors"><svg class="w-3 h-3 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path></svg>AliExpress</a><a href="https://amzn.to/3yqR7t7" target="_blank" rel="noopener noreferrer" class="inline-flex items-center px-2 py-1 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors"><svg class="w-3 h-3 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path></svg>Amazon</a></div></div>
<h2 id="3d-print-template-for-voice-assistant-case"><a href="#3d-print-template-for-voice-assistant-case" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>3D Print Template For Voice Assistant Case</h2>
<p>You can find the link <a target="_blank" rel="noopener noreferrer" href="https://www.thingiverse.com/thing:6631205">here</a> to the STL file for 3D printing the case and the cover.</p>
<h2 id="set-up-voice-assist-pipeline"><a href="#set-up-voice-assist-pipeline" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Set up Voice Assist Pipeline</h2>
<p>To set up voice assistant, we would need two components to create the Voice Assist pipeline in Home Assistant.</p>
<ol>
<li><strong>Whisper</strong>: For speech-to-text</li>
<li><strong>Piper</strong>: For text-to-speech</li>
</ol>
<p>Now, following the below video, you have set up these components in Home Assistant using Addons.</p>
<div class="w-full md:w-1/2 mx-auto my-6 "><div class="relative overflow-hidden rounded-lg shadow-lg bg-black" style="padding-bottom:56.25%;height:0"><iframe class="absolute top-0 left-0 w-full h-full" src="https://www.youtube.com/embed/P4V2JqCmk7M" title="Setting up Voice Assistant in Home Assistant" frameBorder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="" loading="lazy"></iframe></div></div>
<p>You will get to see how to set up the following components that are required</p>
<ol>
<li><strong>Whisper</strong> Addon</li>
<li><strong>Piper</strong> Addon</li>
<li>And finally the entire <strong>Voice Assist</strong> pipeline.</li>
</ol>
<p>You don&#x27;t need to set up the Wake Word addon, as we will use the on-device Wake Word detection with the Micro Wake Word framework</p>
<p>So make sure to watch it and set up the <strong>Voice Assist</strong> pipeline</p>
<p>Now we will look at how we can prepare our ESP32 S3 with a microphone and 3-watt speakers.</p>
<h2 id="circuit-diagram-for-esp32-s3-with-inmp441-microphone--max98357a-audio-amplifier"><a href="#circuit-diagram-for-esp32-s3-with-inmp441-microphone--max98357a-audio-amplifier" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Circuit Diagram for ESP32 S3 With INMP441 Microphone &amp; MAX98357A Audio Amplifier</h2>
<div><img alt="esp32-wiring-diagram.webp" loading="lazy" width="1375" height="1426" decoding="async" data-nimg="1" style="color:transparent" src="/static/images/2024/created-my-voice-assistant/circuit-diagram.webp"/></div>
<p><strong>Important:</strong> You need to connect the 5v pads as shown in the diagram to enable 5v output on the 5v pin.</p>
<p>Here is the pin mapping table</p>
<table><thead><tr><th>ESP32 S3 N8R2 or N16R8</th><th>INMP441 Microphone</th><th>Speaker</th><th>LED Strip WS2812B</th><th>Mute Switch</th></tr></thead><tbody><tr><td>GND</td><td></td><td></td><td></td><td>switch pin 1</td></tr><tr><td>GPIO 10</td><td></td><td></td><td></td><td>switch pin 2</td></tr><tr><td>GND</td><td></td><td>Gnd</td><td></td><td></td></tr><tr><td>GPIO 6</td><td></td><td>LRC</td><td></td><td></td></tr><tr><td>GPIO 7</td><td></td><td>BLCK</td><td></td><td></td></tr><tr><td>GPIO 8</td><td></td><td>DIN</td><td></td><td></td></tr><tr><td>3v3</td><td></td><td>Vin</td><td></td><td></td></tr><tr><td>GPIO 4</td><td>SD</td><td></td><td></td><td></td></tr><tr><td>GPIO 3</td><td>WS</td><td></td><td></td><td></td></tr><tr><td>GPIO 2</td><td>SCK</td><td></td><td></td><td></td></tr><tr><td>3v3</td><td>VDD</td><td></td><td></td><td></td></tr><tr><td>GND</td><td>GND &amp; L/R</td><td></td><td></td><td></td></tr><tr><td>GND</td><td></td><td></td><td>GND</td><td></td></tr><tr><td>GPIO 9</td><td></td><td></td><td>Din</td><td></td></tr><tr><td>Vin (5v)</td><td></td><td></td><td>Vin</td><td></td></tr></tbody></table>
<p>Once you have connected the microphone and the audio amplifier, let’s look at the code we must flash to the ESP32 S3 using ESPHome.</p>
<h2 id="flashing-code-to-esp32-s3-with-esphome"><a href="#flashing-code-to-esp32-s3-with-esphome" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Flashing Code to ESP32 S3 with ESPHome</h2>
<blockquote>
<p><strong>Note</strong>: I faced problems while flashing the ESP32 S3 from an M series Macbook, so I switched to a Windows system.</p>
</blockquote>
<p>Now, you can follow these steps to flash the code required to make the ESP32 S3 work with the microphone and speakers.</p>
<p><strong>Step 1</strong>: Create a new device in the ESPHome dashboard by clicking on “<strong>New Device</strong>” in the bottom right-hand corner.</p>
<p><strong>Step 2:</strong> Give it a name e.g. “<strong>Voice Assistant</strong>” and click “<strong>Next</strong>”.</p>
<p><strong>Step 3</strong>: Now select ESP32 S3 from the options</p>
<div><img alt="1-select-esp32-device.webp" loading="lazy" width="424" height="493" decoding="async" data-nimg="1" style="color:transparent" src="/static/images/2024/on-device-wake-word/esphome-select.webp"/></div>
<p><strong>Step 4</strong>: Now, click on “<strong>Skip</strong>” and open the device card again by clicking on the “<strong>Edit</strong>” option.</p>
<div><img alt="2-edit-device.webp" loading="lazy" width="437" height="173" decoding="async" data-nimg="1" style="color:transparent" src="/static/images/2023/esp32-voice-assistant/2-edit-device.webp"/></div>
<p><strong>Step 5</strong>: Place the following YAML code below.</p>
<p>** <strong>Updated for Home Assistant 2025.07</strong> **</p>
<div class="relative"><pre><code class="language-yaml code-highlight"><span class="code-line"><span class="token key atrule">substitutions</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token comment"># Phases of the Voice Assistant</span>
</span><span class="code-line">  <span class="token comment"># The voice assistant is ready to be triggered by a wake word</span>
</span><span class="code-line">  <span class="token key atrule">voice_assist_idle_phase_id</span><span class="token punctuation">:</span> <span class="token string">&#x27;1&#x27;</span>
</span><span class="code-line">  <span class="token comment"># The voice assistant is waiting for a voice command (after being triggered by the wake word)</span>
</span><span class="code-line">  <span class="token key atrule">voice_assist_waiting_for_command_phase_id</span><span class="token punctuation">:</span> <span class="token string">&#x27;2&#x27;</span>
</span><span class="code-line">  <span class="token comment"># The voice assistant is listening for a voice command</span>
</span><span class="code-line">  <span class="token key atrule">voice_assist_listening_for_command_phase_id</span><span class="token punctuation">:</span> <span class="token string">&#x27;3&#x27;</span>
</span><span class="code-line">  <span class="token comment"># The voice assistant is currently processing the command</span>
</span><span class="code-line">  <span class="token key atrule">voice_assist_thinking_phase_id</span><span class="token punctuation">:</span> <span class="token string">&#x27;4&#x27;</span>
</span><span class="code-line">  <span class="token comment"># The voice assistant is replying to the command</span>
</span><span class="code-line">  <span class="token key atrule">voice_assist_replying_phase_id</span><span class="token punctuation">:</span> <span class="token string">&#x27;5&#x27;</span>
</span><span class="code-line">  <span class="token comment"># The voice assistant is not ready</span>
</span><span class="code-line">  <span class="token key atrule">voice_assist_not_ready_phase_id</span><span class="token punctuation">:</span> <span class="token string">&#x27;10&#x27;</span>
</span><span class="code-line">  <span class="token comment"># The voice assistant encountered an error</span>
</span><span class="code-line">  <span class="token key atrule">voice_assist_error_phase_id</span><span class="token punctuation">:</span> <span class="token string">&#x27;11&#x27;</span>
</span><span class="code-line">  <span class="token comment"># Change this to true in case you ahve a hidden SSID at home.</span>
</span><span class="code-line">  <span class="token key atrule">hidden_ssid</span><span class="token punctuation">:</span> <span class="token string">&quot;false&quot;</span>
</span><span class="code-line">  <span class="token key atrule">no_of_leds</span><span class="token punctuation">:</span> <span class="token string">&#x27;29&#x27;</span>
</span><span class="code-line">  <span class="token comment"># Substitutions for audio files</span>
</span><span class="code-line">  <span class="token key atrule">jack_connected_sound_file</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//github.com/esphome/home<span class="token punctuation">-</span>assistant<span class="token punctuation">-</span>voice<span class="token punctuation">-</span>pe/raw/dev/sounds/jack_connected.flac
</span><span class="code-line">  <span class="token key atrule">jack_disconnected_sound_file</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//github.com/esphome/home<span class="token punctuation">-</span>assistant<span class="token punctuation">-</span>voice<span class="token punctuation">-</span>pe/raw/dev/sounds/jack_disconnected.flac
</span><span class="code-line">  <span class="token key atrule">mute_switch_on_sound_file</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//github.com/esphome/home<span class="token punctuation">-</span>assistant<span class="token punctuation">-</span>voice<span class="token punctuation">-</span>pe/raw/dev/sounds/mute_switch_on.flac
</span><span class="code-line">  <span class="token key atrule">mute_switch_off_sound_file</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//github.com/esphome/home<span class="token punctuation">-</span>assistant<span class="token punctuation">-</span>voice<span class="token punctuation">-</span>pe/raw/dev/sounds/mute_switch_off.flac
</span><span class="code-line">  <span class="token key atrule">timer_finished_sound_file</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//github.com/esphome/home<span class="token punctuation">-</span>assistant<span class="token punctuation">-</span>voice<span class="token punctuation">-</span>pe/raw/dev/sounds/timer_finished.flac
</span><span class="code-line">  <span class="token key atrule">wake_word_triggered_sound_file</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//github.com/esphome/home<span class="token punctuation">-</span>assistant<span class="token punctuation">-</span>voice<span class="token punctuation">-</span>pe/raw/dev/sounds/wake_word_triggered.flac
</span><span class="code-line">  <span class="token key atrule">center_button_press_sound_file</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//github.com/esphome/home<span class="token punctuation">-</span>assistant<span class="token punctuation">-</span>voice<span class="token punctuation">-</span>pe/raw/dev/sounds/center_button_press.flac
</span><span class="code-line">  <span class="token key atrule">center_button_double_press_sound_file</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//github.com/esphome/home<span class="token punctuation">-</span>assistant<span class="token punctuation">-</span>voice<span class="token punctuation">-</span>pe/raw/dev/sounds/center_button_double_press.flac
</span><span class="code-line">  <span class="token key atrule">center_button_triple_press_sound_file</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//github.com/esphome/home<span class="token punctuation">-</span>assistant<span class="token punctuation">-</span>voice<span class="token punctuation">-</span>pe/raw/dev/sounds/center_button_triple_press.flac
</span><span class="code-line">  <span class="token key atrule">center_button_long_press_sound_file</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//github.com/esphome/home<span class="token punctuation">-</span>assistant<span class="token punctuation">-</span>voice<span class="token punctuation">-</span>pe/raw/dev/sounds/center_button_long_press.flac
</span><span class="code-line">
</span><span class="code-line"><span class="token key atrule">esphome</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token key atrule">name</span><span class="token punctuation">:</span> esp32<span class="token punctuation">-</span>s3<span class="token punctuation">-</span>ha<span class="token punctuation">-</span>pe<span class="token punctuation">-</span>update
</span><span class="code-line">  <span class="token key atrule">friendly_name</span><span class="token punctuation">:</span> ESP32 S3 Home Assistant PE Update
</span><span class="code-line">  <span class="token key atrule">name_add_mac_suffix</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
</span><span class="code-line">  <span class="token key atrule">min_version</span><span class="token punctuation">:</span> 2025.9.3
</span><span class="code-line">  <span class="token key atrule">on_boot</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token key atrule">priority</span><span class="token punctuation">:</span> <span class="token number">375</span>
</span><span class="code-line">    <span class="token key atrule">then</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token comment"># Run the script to refresh the LED status</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">script.execute</span><span class="token punctuation">:</span> control_leds
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">delay</span><span class="token punctuation">:</span> 1s
</span><span class="code-line">      <span class="token comment"># - switch.turn_on: internal_speaker_amp</span>
</span><span class="code-line">      <span class="token comment"># If after 10 minutes, the device is still initializing (It did not yet connect to Home Assistant), turn off the init_in_progress variable and run the script to refresh the LED status</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">delay</span><span class="token punctuation">:</span> 10min
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">if</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">condition</span><span class="token punctuation">:</span>
</span><span class="code-line">            <span class="token key atrule">lambda</span><span class="token punctuation">:</span> return id(init_in_progress);
</span><span class="code-line">          <span class="token key atrule">then</span><span class="token punctuation">:</span>
</span><span class="code-line">            <span class="token punctuation">-</span> <span class="token key atrule">lambda</span><span class="token punctuation">:</span> id(init_in_progress) = false;
</span><span class="code-line">            <span class="token punctuation">-</span> <span class="token key atrule">script.execute</span><span class="token punctuation">:</span> control_leds
</span><span class="code-line">
</span><span class="code-line"><span class="token key atrule">esp32</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token key atrule">board</span><span class="token punctuation">:</span> esp32<span class="token punctuation">-</span>s3<span class="token punctuation">-</span>devkitc<span class="token punctuation">-</span><span class="token number">1</span>
</span><span class="code-line">  <span class="token key atrule">cpu_frequency</span><span class="token punctuation">:</span> 240MHz
</span><span class="code-line">  <span class="token key atrule">variant</span><span class="token punctuation">:</span> esp32s3
</span><span class="code-line">  <span class="token key atrule">flash_size</span><span class="token punctuation">:</span> 8MB
</span><span class="code-line">  <span class="token key atrule">framework</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token key atrule">type</span><span class="token punctuation">:</span> esp<span class="token punctuation">-</span>idf
</span><span class="code-line">    <span class="token key atrule">version</span><span class="token punctuation">:</span> recommended
</span><span class="code-line">    <span class="token key atrule">sdkconfig_options</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token key atrule">CONFIG_ESP32S3_DATA_CACHE_64KB</span><span class="token punctuation">:</span> <span class="token string">&quot;y&quot;</span>
</span><span class="code-line">      <span class="token key atrule">CONFIG_ESP32S3_DATA_CACHE_LINE_64B</span><span class="token punctuation">:</span> <span class="token string">&quot;y&quot;</span>
</span><span class="code-line">      <span class="token key atrule">CONFIG_ESP32S3_INSTRUCTION_CACHE_32KB</span><span class="token punctuation">:</span> <span class="token string">&quot;y&quot;</span>
</span><span class="code-line">
</span><span class="code-line">      <span class="token comment"># Moves instructions and read only data from flash into PSRAM on boot.</span>
</span><span class="code-line">      <span class="token comment"># Both enabled allows instructions to execute while a flash operation is in progress without needing to be placed in IRAM.</span>
</span><span class="code-line">      <span class="token comment"># Considerably speeds up mWW at the cost of using more PSRAM.</span>
</span><span class="code-line">      <span class="token key atrule">CONFIG_SPIRAM_RODATA</span><span class="token punctuation">:</span> <span class="token string">&quot;y&quot;</span>
</span><span class="code-line">      <span class="token key atrule">CONFIG_SPIRAM_FETCH_INSTRUCTIONS</span><span class="token punctuation">:</span> <span class="token string">&quot;y&quot;</span>
</span><span class="code-line">
</span><span class="code-line">      <span class="token key atrule">CONFIG_BT_ALLOCATION_FROM_SPIRAM_FIRST</span><span class="token punctuation">:</span> <span class="token string">&quot;y&quot;</span>
</span><span class="code-line">      <span class="token key atrule">CONFIG_BT_BLE_DYNAMIC_ENV_MEMORY</span><span class="token punctuation">:</span> <span class="token string">&quot;y&quot;</span>
</span><span class="code-line">
</span><span class="code-line">      <span class="token key atrule">CONFIG_MBEDTLS_EXTERNAL_MEM_ALLOC</span><span class="token punctuation">:</span> <span class="token string">&quot;y&quot;</span>
</span><span class="code-line">      <span class="token key atrule">CONFIG_MBEDTLS_SSL_PROTO_TLS1_3</span><span class="token punctuation">:</span> <span class="token string">&quot;y&quot;</span>  <span class="token comment"># TLS1.3 support isn&#x27;t enabled by default in IDF 5.1.5</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token key atrule">wifi</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token key atrule">id</span><span class="token punctuation">:</span> wifi_id
</span><span class="code-line">  <span class="token key atrule">ssid</span><span class="token punctuation">:</span> <span class="token tag">!secret</span> wifi_ssid
</span><span class="code-line">  <span class="token key atrule">password</span><span class="token punctuation">:</span> <span class="token tag">!secret</span> wifi_password
</span><span class="code-line">  <span class="token key atrule">manual_ip</span><span class="token punctuation">:</span> 
</span><span class="code-line">    <span class="token key atrule">static_ip</span><span class="token punctuation">:</span> 192.168.0.114
</span><span class="code-line">    <span class="token key atrule">gateway</span><span class="token punctuation">:</span> 192.168.0.1
</span><span class="code-line">    <span class="token key atrule">subnet</span><span class="token punctuation">:</span> 255.255.255.0
</span><span class="code-line">  <span class="token key atrule">on_connect</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token punctuation">-</span> <span class="token key atrule">lambda</span><span class="token punctuation">:</span> id(improv_ble_in_progress) = false;
</span><span class="code-line">    <span class="token punctuation">-</span> <span class="token key atrule">script.execute</span><span class="token punctuation">:</span> control_leds
</span><span class="code-line">  <span class="token key atrule">on_disconnect</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token punctuation">-</span> <span class="token key atrule">script.execute</span><span class="token punctuation">:</span> control_leds
</span><span class="code-line">  <span class="token comment"># Enable fallback hotspot (captive portal) in case wifi connection fails</span>
</span><span class="code-line">  <span class="token key atrule">ap</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token key atrule">ssid</span><span class="token punctuation">:</span> <span class="token string">&quot;Esp32-S3-Wake-Word&quot;</span>
</span><span class="code-line">    <span class="token key atrule">password</span><span class="token punctuation">:</span> <span class="token string">&quot;LJfUrdJk3svP&quot;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token key atrule">network</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token key atrule">enable_ipv6</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token key atrule">logger</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token key atrule">level</span><span class="token punctuation">:</span> DEBUG
</span><span class="code-line">  <span class="token key atrule">logs</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token key atrule">sensor</span><span class="token punctuation">:</span> WARN  <span class="token comment"># avoids logging debug sensor updates</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token key atrule">api</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token key atrule">id</span><span class="token punctuation">:</span> api_id
</span><span class="code-line">  <span class="token key atrule">encryption</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token key atrule">key</span><span class="token punctuation">:</span> <span class="token string">&quot;TFpb+pBAvQIS1MVwaA7EoJ2DkpWE+79UvVro7yMyGdU=&quot;</span>
</span><span class="code-line">  <span class="token key atrule">on_client_connected</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token punctuation">-</span> <span class="token key atrule">script.execute</span><span class="token punctuation">:</span> control_leds
</span><span class="code-line">  <span class="token key atrule">on_client_disconnected</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token punctuation">-</span> <span class="token key atrule">script.execute</span><span class="token punctuation">:</span> control_leds
</span><span class="code-line">  <span class="token comment"># encryption:   # Uses key set by Home Assistant</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token key atrule">ota</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token punctuation">-</span> <span class="token key atrule">platform</span><span class="token punctuation">:</span> esphome
</span><span class="code-line">    <span class="token key atrule">password</span><span class="token punctuation">:</span> <span class="token string">&quot;1245211a05eef56614a2ef5a3f3e971c&quot;</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="token key atrule">psram</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token key atrule">mode</span><span class="token punctuation">:</span> octal
</span><span class="code-line">  <span class="token key atrule">speed</span><span class="token punctuation">:</span> 80MHz
</span><span class="code-line">
</span><span class="code-line"><span class="token key atrule">globals</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token comment"># Global index for our LEDs. So that switching between different animation does not lead to unwanted effects.</span>
</span><span class="code-line">  <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> global_led_animation_index
</span><span class="code-line">    <span class="token key atrule">type</span><span class="token punctuation">:</span> int
</span><span class="code-line">    <span class="token key atrule">restore_value</span><span class="token punctuation">:</span> no
</span><span class="code-line">    <span class="token key atrule">initial_value</span><span class="token punctuation">:</span> <span class="token string">&#x27;0&#x27;</span>
</span><span class="code-line">  <span class="token comment"># Global initialization variable. Initialized to true and set to false once everything is connected. Only used to have a smooth &quot;plugging&quot; experience</span>
</span><span class="code-line">  <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> init_in_progress
</span><span class="code-line">    <span class="token key atrule">type</span><span class="token punctuation">:</span> bool
</span><span class="code-line">    <span class="token key atrule">restore_value</span><span class="token punctuation">:</span> no
</span><span class="code-line">    <span class="token key atrule">initial_value</span><span class="token punctuation">:</span> <span class="token string">&#x27;true&#x27;</span>
</span><span class="code-line">  <span class="token comment"># Global variable storing the state of ImprovBLE. Used to draw different LED animations</span>
</span><span class="code-line">  <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> improv_ble_in_progress
</span><span class="code-line">    <span class="token key atrule">type</span><span class="token punctuation">:</span> bool
</span><span class="code-line">    <span class="token key atrule">restore_value</span><span class="token punctuation">:</span> no
</span><span class="code-line">    <span class="token key atrule">initial_value</span><span class="token punctuation">:</span> <span class="token string">&#x27;false&#x27;</span>
</span><span class="code-line">  <span class="token comment"># Global variable tracking the phase of the voice assistant (defined above). Initialized to not_ready</span>
</span><span class="code-line">  <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> voice_assistant_phase
</span><span class="code-line">    <span class="token key atrule">type</span><span class="token punctuation">:</span> int
</span><span class="code-line">    <span class="token key atrule">restore_value</span><span class="token punctuation">:</span> no
</span><span class="code-line">    <span class="token key atrule">initial_value</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span>voice_assist_not_ready_phase_id<span class="token punctuation">}</span>
</span><span class="code-line">  <span class="token comment"># Global variable tracking if the dial was recently touched.</span>
</span><span class="code-line">  <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> dial_touched
</span><span class="code-line">    <span class="token key atrule">type</span><span class="token punctuation">:</span> bool
</span><span class="code-line">    <span class="token key atrule">restore_value</span><span class="token punctuation">:</span> no
</span><span class="code-line">    <span class="token key atrule">initial_value</span><span class="token punctuation">:</span> <span class="token string">&#x27;false&#x27;</span>
</span><span class="code-line">  <span class="token comment"># Global variable tracking if the LED color was recently changed.</span>
</span><span class="code-line">  <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> color_changed
</span><span class="code-line">    <span class="token key atrule">type</span><span class="token punctuation">:</span> bool
</span><span class="code-line">    <span class="token key atrule">restore_value</span><span class="token punctuation">:</span> no
</span><span class="code-line">    <span class="token key atrule">initial_value</span><span class="token punctuation">:</span> <span class="token string">&#x27;false&#x27;</span>
</span><span class="code-line">  <span class="token comment"># Global variable tracking if the jack has been plugged touched.</span>
</span><span class="code-line">  <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> jack_plugged_recently
</span><span class="code-line">    <span class="token key atrule">type</span><span class="token punctuation">:</span> bool
</span><span class="code-line">    <span class="token key atrule">restore_value</span><span class="token punctuation">:</span> no
</span><span class="code-line">    <span class="token key atrule">initial_value</span><span class="token punctuation">:</span> <span class="token string">&#x27;false&#x27;</span>
</span><span class="code-line">  <span class="token comment"># Global variable tracking if the jack has been unplugged touched.</span>
</span><span class="code-line">  <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> jack_unplugged_recently
</span><span class="code-line">    <span class="token key atrule">type</span><span class="token punctuation">:</span> bool
</span><span class="code-line">    <span class="token key atrule">restore_value</span><span class="token punctuation">:</span> no
</span><span class="code-line">    <span class="token key atrule">initial_value</span><span class="token punctuation">:</span> <span class="token string">&#x27;false&#x27;</span>
</span><span class="code-line">  <span class="token comment"># Global variable storing the first active timer</span>
</span><span class="code-line">  <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> first_active_timer
</span><span class="code-line">    <span class="token key atrule">type</span><span class="token punctuation">:</span> voice_assistant<span class="token punctuation">:</span><span class="token punctuation">:</span>Timer
</span><span class="code-line">    <span class="token key atrule">restore_value</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
</span><span class="code-line">  <span class="token comment"># Global variable storing if a timer is active</span>
</span><span class="code-line">  <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> is_timer_active
</span><span class="code-line">    <span class="token key atrule">type</span><span class="token punctuation">:</span> bool
</span><span class="code-line">    <span class="token key atrule">restore_value</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
</span><span class="code-line">  <span class="token comment"># Global variable storing if a factory reset was requested. If it is set to true, the device will factory reset once the center button is released</span>
</span><span class="code-line">  <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> factory_reset_requested
</span><span class="code-line">    <span class="token key atrule">type</span><span class="token punctuation">:</span> bool
</span><span class="code-line">    <span class="token key atrule">restore_value</span><span class="token punctuation">:</span> no
</span><span class="code-line">    <span class="token key atrule">initial_value</span><span class="token punctuation">:</span> <span class="token string">&#x27;false&#x27;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token key atrule">switch</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token comment"># This is the master mute switch. It is exposed to Home Assistant. The user can only turn it on and off if the hardware switch is off. (The hardware switch overrides the software one)</span>
</span><span class="code-line">  <span class="token punctuation">-</span> <span class="token key atrule">platform</span><span class="token punctuation">:</span> template
</span><span class="code-line">    <span class="token key atrule">id</span><span class="token punctuation">:</span> master_mute_switch
</span><span class="code-line">    <span class="token key atrule">restore_mode</span><span class="token punctuation">:</span> RESTORE_DEFAULT_OFF
</span><span class="code-line">    <span class="token key atrule">icon</span><span class="token punctuation">:</span> <span class="token string">&quot;mdi:microphone-off&quot;</span>
</span><span class="code-line">    <span class="token key atrule">name</span><span class="token punctuation">:</span> Mute
</span><span class="code-line">    <span class="token key atrule">entity_category</span><span class="token punctuation">:</span> config
</span><span class="code-line">    <span class="token key atrule">optimistic</span><span class="token punctuation">:</span> <span class="token boolean important">True</span>
</span><span class="code-line">    <span class="token key atrule">lambda</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token punctuation">-</span>
</span><span class="code-line">      // Muted either if the hardware mute switch is on or the microphone&#x27;s software mute switch is enabled
</span><span class="code-line">      if (id(i2s_mics).get_mute_state()) <span class="token punctuation">{</span>
</span><span class="code-line">        return true;
</span><span class="code-line">      <span class="token punctuation">}</span> else <span class="token punctuation">{</span>
</span><span class="code-line">        return false;
</span><span class="code-line">      <span class="token punctuation">}</span>
</span><span class="code-line">    <span class="token key atrule">turn_on_action</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token comment"># - if:</span>
</span><span class="code-line">      <span class="token comment">#     condition:</span>
</span><span class="code-line">      <span class="token comment">#       binary_sensor.is_off: hardware_mute_switch</span>
</span><span class="code-line">      <span class="token comment">#     then:</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">microphone.mute</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token key atrule">turn_off_action</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token comment"># - if:</span>
</span><span class="code-line">      <span class="token comment">#     condition:</span>
</span><span class="code-line">      <span class="token comment">#       binary_sensor.is_off: hardware_mute_switch</span>
</span><span class="code-line">      <span class="token comment">#     then:</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">microphone.unmute</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token key atrule">on_turn_on</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">script.execute</span><span class="token punctuation">:</span> control_leds
</span><span class="code-line">    <span class="token key atrule">on_turn_off</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">script.execute</span><span class="token punctuation">:</span> control_leds
</span><span class="code-line">  <span class="token comment"># Wake Word Sound Switch.</span>
</span><span class="code-line">  <span class="token punctuation">-</span> <span class="token key atrule">platform</span><span class="token punctuation">:</span> template
</span><span class="code-line">    <span class="token key atrule">id</span><span class="token punctuation">:</span> wake_sound
</span><span class="code-line">    <span class="token key atrule">name</span><span class="token punctuation">:</span> Wake sound
</span><span class="code-line">    <span class="token key atrule">icon</span><span class="token punctuation">:</span> <span class="token string">&quot;mdi:bullhorn&quot;</span>
</span><span class="code-line">    <span class="token key atrule">entity_category</span><span class="token punctuation">:</span> config
</span><span class="code-line">    <span class="token key atrule">optimistic</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
</span><span class="code-line">    <span class="token key atrule">restore_mode</span><span class="token punctuation">:</span> RESTORE_DEFAULT_ON
</span><span class="code-line">  <span class="token comment"># Internal switch to track when a timer is ringing on the device.</span>
</span><span class="code-line">  <span class="token punctuation">-</span> <span class="token key atrule">platform</span><span class="token punctuation">:</span> template
</span><span class="code-line">    <span class="token key atrule">id</span><span class="token punctuation">:</span> timer_ringing
</span><span class="code-line">    <span class="token key atrule">optimistic</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
</span><span class="code-line">    <span class="token key atrule">internal</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
</span><span class="code-line">    <span class="token key atrule">restore_mode</span><span class="token punctuation">:</span> ALWAYS_OFF
</span><span class="code-line">    <span class="token key atrule">on_turn_off</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token comment"># Disable stop wake word</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">micro_wake_word.disable_model</span><span class="token punctuation">:</span> stop
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">script.execute</span><span class="token punctuation">:</span> disable_repeat
</span><span class="code-line">      <span class="token comment"># Stop any current annoucement (ie: stop the timer ring mid playback)</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">if</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">condition</span><span class="token punctuation">:</span>
</span><span class="code-line">            <span class="token key atrule">media_player.is_announcing</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">then</span><span class="token punctuation">:</span>
</span><span class="code-line">            <span class="token key atrule">media_player.stop</span><span class="token punctuation">:</span>
</span><span class="code-line">              <span class="token key atrule">announcement</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
</span><span class="code-line">      <span class="token comment"># Set back ducking ratio to zero</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">mixer_speaker.apply_ducking</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">id</span><span class="token punctuation">:</span> media_mixing_input
</span><span class="code-line">          <span class="token key atrule">decibel_reduction</span><span class="token punctuation">:</span> <span class="token number">0</span>
</span><span class="code-line">          <span class="token key atrule">duration</span><span class="token punctuation">:</span> 1.0s
</span><span class="code-line">      <span class="token comment"># Refresh the LED ring</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">script.execute</span><span class="token punctuation">:</span> control_leds
</span><span class="code-line">    <span class="token key atrule">on_turn_on</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token comment"># Duck audio</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">mixer_speaker.apply_ducking</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">id</span><span class="token punctuation">:</span> media_mixing_input
</span><span class="code-line">          <span class="token key atrule">decibel_reduction</span><span class="token punctuation">:</span> <span class="token number">20</span>
</span><span class="code-line">          <span class="token key atrule">duration</span><span class="token punctuation">:</span> 0.0s
</span><span class="code-line">      <span class="token comment"># Enable stop wake word</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">micro_wake_word.enable_model</span><span class="token punctuation">:</span> stop
</span><span class="code-line">      <span class="token comment"># Ring timer</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">script.execute</span><span class="token punctuation">:</span> ring_timer
</span><span class="code-line">      <span class="token comment"># Refresh LED</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">script.execute</span><span class="token punctuation">:</span> control_leds
</span><span class="code-line">      <span class="token comment"># If 15 minutes have passed and the timer is still ringing, stop it.</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">delay</span><span class="token punctuation">:</span> 15min
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">switch.turn_off</span><span class="token punctuation">:</span> timer_ringing
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="token key atrule">binary_sensor</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token comment"># Center Button. Used for many things (See on_multi_click)</span>
</span><span class="code-line">  <span class="token punctuation">-</span> <span class="token key atrule">platform</span><span class="token punctuation">:</span> gpio
</span><span class="code-line">    <span class="token key atrule">id</span><span class="token punctuation">:</span> center_button <span class="token comment">#mute</span>
</span><span class="code-line">    <span class="token key atrule">pin</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token key atrule">number</span><span class="token punctuation">:</span> GPIO10
</span><span class="code-line">      <span class="token key atrule">inverted</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
</span><span class="code-line">      <span class="token key atrule">mode</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token key atrule">input</span><span class="token punctuation">:</span> <span class="token boolean important">True</span>
</span><span class="code-line">        <span class="token key atrule">pullup</span><span class="token punctuation">:</span> <span class="token boolean important">True</span>
</span><span class="code-line">    <span class="token key atrule">on_press</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">script.execute</span><span class="token punctuation">:</span> control_leds
</span><span class="code-line">    <span class="token key atrule">on_release</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">script.execute</span><span class="token punctuation">:</span> control_leds
</span><span class="code-line">      <span class="token comment"># If a factory reset is requested, factory reset on release</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">if</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">condition</span><span class="token punctuation">:</span>
</span><span class="code-line">            <span class="token key atrule">lambda</span><span class="token punctuation">:</span> return id(factory_reset_requested);
</span><span class="code-line">          <span class="token key atrule">then</span><span class="token punctuation">:</span>
</span><span class="code-line">            <span class="token punctuation">-</span> <span class="token key atrule">button.press</span><span class="token punctuation">:</span> factory_reset_button
</span><span class="code-line">    <span class="token key atrule">on_multi_click</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token comment"># Simple Click:</span>
</span><span class="code-line">      <span class="token comment">#   - Abort &quot;things&quot; in order</span>
</span><span class="code-line">      <span class="token comment">#     - Timer</span>
</span><span class="code-line">      <span class="token comment">#     - Announcements</span>
</span><span class="code-line">      <span class="token comment">#     - Voice Assistant Pipeline run</span>
</span><span class="code-line">      <span class="token comment">#     - Music</span>
</span><span class="code-line">      <span class="token comment">#   - Starts the voice assistant if it is not yet running and if the device is not muted.</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">timing</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token punctuation">-</span> ON for at most 1s
</span><span class="code-line">          <span class="token punctuation">-</span> OFF for at least 0.25s
</span><span class="code-line">        <span class="token key atrule">then</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token punctuation">-</span> <span class="token key atrule">if</span><span class="token punctuation">:</span>
</span><span class="code-line">              <span class="token key atrule">condition</span><span class="token punctuation">:</span>
</span><span class="code-line">                <span class="token punctuation">-</span> <span class="token key atrule">switch.is_off</span><span class="token punctuation">:</span> master_mute_switch
</span><span class="code-line">              <span class="token key atrule">then</span><span class="token punctuation">:</span>
</span><span class="code-line">                <span class="token punctuation">-</span> <span class="token key atrule">script.execute</span><span class="token punctuation">:</span>
</span><span class="code-line">                    <span class="token key atrule">id</span><span class="token punctuation">:</span> play_sound
</span><span class="code-line">                    <span class="token key atrule">priority</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
</span><span class="code-line">                    <span class="token key atrule">sound_file</span><span class="token punctuation">:</span> <span class="token tag">!lambda</span> return id(mute_switch_on_sound);
</span><span class="code-line">                <span class="token punctuation">-</span> <span class="token key atrule">switch.turn_on</span><span class="token punctuation">:</span> master_mute_switch
</span><span class="code-line">              <span class="token key atrule">else</span><span class="token punctuation">:</span>
</span><span class="code-line">                <span class="token punctuation">-</span> <span class="token key atrule">script.execute</span><span class="token punctuation">:</span>
</span><span class="code-line">                    <span class="token key atrule">id</span><span class="token punctuation">:</span> play_sound
</span><span class="code-line">                    <span class="token key atrule">priority</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
</span><span class="code-line">                    <span class="token key atrule">sound_file</span><span class="token punctuation">:</span> <span class="token tag">!lambda</span> return id(mute_switch_off_sound);
</span><span class="code-line">                <span class="token punctuation">-</span> <span class="token key atrule">microphone.unmute</span><span class="token punctuation">:</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line">      <span class="token comment"># Double Click</span>
</span><span class="code-line">      <span class="token comment">#  . Exposed as an event entity. To be used in automations inside Home Assistant</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">timing</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token punctuation">-</span> ON for at most 1s
</span><span class="code-line">          <span class="token punctuation">-</span> OFF for at most 0.25s
</span><span class="code-line">          <span class="token punctuation">-</span> ON for at most 1s
</span><span class="code-line">          <span class="token punctuation">-</span> OFF for at least 0.25s
</span><span class="code-line">        <span class="token key atrule">then</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token punctuation">-</span> <span class="token key atrule">if</span><span class="token punctuation">:</span>
</span><span class="code-line">              <span class="token key atrule">condition</span><span class="token punctuation">:</span>
</span><span class="code-line">                <span class="token key atrule">lambda</span><span class="token punctuation">:</span> return <span class="token tag">!id(init_in_progress)</span> <span class="token important">&amp;&amp;</span> <span class="token tag">!id(color_changed);</span>
</span><span class="code-line">              <span class="token key atrule">then</span><span class="token punctuation">:</span>
</span><span class="code-line">                <span class="token punctuation">-</span> <span class="token key atrule">script.execute</span><span class="token punctuation">:</span>
</span><span class="code-line">                    <span class="token key atrule">id</span><span class="token punctuation">:</span> play_sound
</span><span class="code-line">                    <span class="token key atrule">priority</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
</span><span class="code-line">                    <span class="token key atrule">sound_file</span><span class="token punctuation">:</span> <span class="token tag">!lambda</span> return id(center_button_double_press_sound);
</span><span class="code-line">                <span class="token punctuation">-</span> <span class="token key atrule">event.trigger</span><span class="token punctuation">:</span>
</span><span class="code-line">                    <span class="token key atrule">id</span><span class="token punctuation">:</span> button_press_event
</span><span class="code-line">                    <span class="token key atrule">event_type</span><span class="token punctuation">:</span> <span class="token string">&quot;double_press&quot;</span>
</span><span class="code-line">      <span class="token comment"># Triple Click</span>
</span><span class="code-line">      <span class="token comment">#  . Exposed as an event entity. To be used in automations inside Home Assistant</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">timing</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token punctuation">-</span> ON for at most 1s
</span><span class="code-line">          <span class="token punctuation">-</span> OFF for at most 0.25s
</span><span class="code-line">          <span class="token punctuation">-</span> ON for at most 1s
</span><span class="code-line">          <span class="token punctuation">-</span> OFF for at most 0.25s
</span><span class="code-line">          <span class="token punctuation">-</span> ON for at most 1s
</span><span class="code-line">          <span class="token punctuation">-</span> OFF for at least 0.25s
</span><span class="code-line">        <span class="token key atrule">then</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token punctuation">-</span> <span class="token key atrule">if</span><span class="token punctuation">:</span>
</span><span class="code-line">              <span class="token key atrule">condition</span><span class="token punctuation">:</span>
</span><span class="code-line">                <span class="token key atrule">lambda</span><span class="token punctuation">:</span> return <span class="token tag">!id(init_in_progress)</span> <span class="token important">&amp;&amp;</span> <span class="token tag">!id(color_changed);</span>
</span><span class="code-line">              <span class="token key atrule">then</span><span class="token punctuation">:</span>
</span><span class="code-line">                <span class="token punctuation">-</span> <span class="token key atrule">script.execute</span><span class="token punctuation">:</span>
</span><span class="code-line">                    <span class="token key atrule">id</span><span class="token punctuation">:</span> play_sound
</span><span class="code-line">                    <span class="token key atrule">priority</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
</span><span class="code-line">                    <span class="token key atrule">sound_file</span><span class="token punctuation">:</span> <span class="token tag">!lambda</span> return id(center_button_triple_press_sound);
</span><span class="code-line">                <span class="token punctuation">-</span> <span class="token key atrule">event.trigger</span><span class="token punctuation">:</span>
</span><span class="code-line">                    <span class="token key atrule">id</span><span class="token punctuation">:</span> button_press_event
</span><span class="code-line">                    <span class="token key atrule">event_type</span><span class="token punctuation">:</span> <span class="token string">&quot;triple_press&quot;</span>
</span><span class="code-line">      <span class="token comment"># Long Press</span>
</span><span class="code-line">      <span class="token comment">#  . Exposed as an event entity. To be used in automations inside Home Assistant</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">timing</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token punctuation">-</span> ON for at least 1s
</span><span class="code-line">        <span class="token key atrule">then</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token punctuation">-</span> <span class="token key atrule">if</span><span class="token punctuation">:</span>
</span><span class="code-line">              <span class="token key atrule">condition</span><span class="token punctuation">:</span>
</span><span class="code-line">                <span class="token key atrule">lambda</span><span class="token punctuation">:</span> return <span class="token tag">!id(init_in_progress)</span> <span class="token important">&amp;&amp;</span> <span class="token tag">!id(color_changed);</span>
</span><span class="code-line">              <span class="token key atrule">then</span><span class="token punctuation">:</span>
</span><span class="code-line">                <span class="token punctuation">-</span> <span class="token key atrule">script.execute</span><span class="token punctuation">:</span>
</span><span class="code-line">                    <span class="token key atrule">id</span><span class="token punctuation">:</span> play_sound
</span><span class="code-line">                    <span class="token key atrule">priority</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
</span><span class="code-line">                    <span class="token key atrule">sound_file</span><span class="token punctuation">:</span> <span class="token tag">!lambda</span> return id(center_button_long_press_sound);
</span><span class="code-line">                <span class="token punctuation">-</span> <span class="token key atrule">light.turn_off</span><span class="token punctuation">:</span> voice_assistant_leds
</span><span class="code-line">                <span class="token punctuation">-</span> <span class="token key atrule">event.trigger</span><span class="token punctuation">:</span>
</span><span class="code-line">                    <span class="token key atrule">id</span><span class="token punctuation">:</span> button_press_event
</span><span class="code-line">                    <span class="token key atrule">event_type</span><span class="token punctuation">:</span> <span class="token string">&quot;long_press&quot;</span>
</span><span class="code-line">      <span class="token comment"># Very important do not remove. Trust me :D</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">timing</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token comment"># H ....</span>
</span><span class="code-line">          <span class="token punctuation">-</span> ON for at most 0.2s
</span><span class="code-line">          <span class="token punctuation">-</span> OFF for 0s to 2s
</span><span class="code-line">          <span class="token punctuation">-</span> ON for at most 0.2s
</span><span class="code-line">          <span class="token punctuation">-</span> OFF for 0s to 2s
</span><span class="code-line">          <span class="token punctuation">-</span> ON for at most 0.2s
</span><span class="code-line">          <span class="token punctuation">-</span> OFF for 0s to 2s
</span><span class="code-line">          <span class="token punctuation">-</span> ON for at most 0.2s
</span><span class="code-line">          <span class="token punctuation">-</span> OFF for 0.5s to 2s
</span><span class="code-line">          <span class="token comment"># A ._</span>
</span><span class="code-line">          <span class="token punctuation">-</span> ON for at most 0.2s
</span><span class="code-line">          <span class="token punctuation">-</span> OFF for 0s to 2s
</span><span class="code-line">          <span class="token punctuation">-</span> ON for 0.2s to 2s
</span><span class="code-line">        <span class="token key atrule">then</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token punctuation">-</span> <span class="token key atrule">if</span><span class="token punctuation">:</span>
</span><span class="code-line">              <span class="token key atrule">condition</span><span class="token punctuation">:</span>
</span><span class="code-line">                <span class="token key atrule">lambda</span><span class="token punctuation">:</span> return <span class="token tag">!id(init_in_progress);</span>
</span><span class="code-line">              <span class="token key atrule">then</span><span class="token punctuation">:</span>
</span><span class="code-line">                <span class="token punctuation">-</span> <span class="token key atrule">light.turn_on</span><span class="token punctuation">:</span>
</span><span class="code-line">                    <span class="token key atrule">brightness</span><span class="token punctuation">:</span> 100%
</span><span class="code-line">                    <span class="token key atrule">id</span><span class="token punctuation">:</span> voice_assistant_leds
</span><span class="code-line">                    <span class="token key atrule">effect</span><span class="token punctuation">:</span> <span class="token string">&quot;Tick&quot;</span>
</span><span class="code-line">                <span class="token punctuation">-</span> <span class="token key atrule">script.execute</span><span class="token punctuation">:</span>
</span><span class="code-line">                    <span class="token key atrule">id</span><span class="token punctuation">:</span> play_sound
</span><span class="code-line">                    <span class="token key atrule">priority</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
</span><span class="code-line">                    <span class="token key atrule">sound_file</span><span class="token punctuation">:</span> <span class="token tag">!lambda</span> return id(easter_egg_tick_sound);
</span><span class="code-line">                <span class="token punctuation">-</span> <span class="token key atrule">delay</span><span class="token punctuation">:</span> 4s
</span><span class="code-line">                <span class="token punctuation">-</span> <span class="token key atrule">light.turn_off</span><span class="token punctuation">:</span> voice_assistant_leds
</span><span class="code-line">                <span class="token punctuation">-</span> <span class="token key atrule">script.execute</span><span class="token punctuation">:</span>
</span><span class="code-line">                    <span class="token key atrule">id</span><span class="token punctuation">:</span> play_sound
</span><span class="code-line">                    <span class="token key atrule">priority</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
</span><span class="code-line">                    <span class="token key atrule">sound_file</span><span class="token punctuation">:</span> <span class="token tag">!lambda</span> return id(easter_egg_tada_sound);
</span><span class="code-line">                <span class="token punctuation">-</span> <span class="token key atrule">light.turn_on</span><span class="token punctuation">:</span>
</span><span class="code-line">                    <span class="token key atrule">brightness</span><span class="token punctuation">:</span> 100%
</span><span class="code-line">                    <span class="token key atrule">id</span><span class="token punctuation">:</span> voice_assistant_leds
</span><span class="code-line">                    <span class="token key atrule">effect</span><span class="token punctuation">:</span> <span class="token string">&quot;Rainbow&quot;</span>
</span><span class="code-line">                <span class="token punctuation">-</span> <span class="token key atrule">event.trigger</span><span class="token punctuation">:</span>
</span><span class="code-line">                    <span class="token key atrule">id</span><span class="token punctuation">:</span> button_press_event
</span><span class="code-line">                    <span class="token key atrule">event_type</span><span class="token punctuation">:</span> <span class="token string">&quot;easter_egg_press&quot;</span>
</span><span class="code-line">      <span class="token comment"># Factory Reset Warning</span>
</span><span class="code-line">      <span class="token comment">#  . Audible and Visible warning.</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">timing</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token punctuation">-</span> ON for at least 10s
</span><span class="code-line">        <span class="token key atrule">then</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token punctuation">-</span> <span class="token key atrule">if</span><span class="token punctuation">:</span>
</span><span class="code-line">              <span class="token key atrule">condition</span><span class="token punctuation">:</span>
</span><span class="code-line">                <span class="token key atrule">lambda</span><span class="token punctuation">:</span> return <span class="token tag">!id(dial_touched);</span>
</span><span class="code-line">              <span class="token key atrule">then</span><span class="token punctuation">:</span>
</span><span class="code-line">                <span class="token punctuation">-</span> <span class="token key atrule">light.turn_on</span><span class="token punctuation">:</span>
</span><span class="code-line">                    <span class="token key atrule">brightness</span><span class="token punctuation">:</span> 100%
</span><span class="code-line">                    <span class="token key atrule">id</span><span class="token punctuation">:</span> voice_assistant_leds
</span><span class="code-line">                    <span class="token key atrule">effect</span><span class="token punctuation">:</span> <span class="token string">&quot;Factory Reset Coming Up&quot;</span>
</span><span class="code-line">                <span class="token punctuation">-</span> <span class="token key atrule">script.execute</span><span class="token punctuation">:</span>
</span><span class="code-line">                    <span class="token key atrule">id</span><span class="token punctuation">:</span> play_sound
</span><span class="code-line">                    <span class="token key atrule">priority</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
</span><span class="code-line">                    <span class="token key atrule">sound_file</span><span class="token punctuation">:</span> <span class="token tag">!lambda</span> return id(factory_reset_initiated_sound);
</span><span class="code-line">                <span class="token punctuation">-</span> <span class="token key atrule">wait_until</span><span class="token punctuation">:</span>
</span><span class="code-line">                    <span class="token key atrule">binary_sensor.is_off</span><span class="token punctuation">:</span> center_button
</span><span class="code-line">                <span class="token punctuation">-</span> <span class="token key atrule">if</span><span class="token punctuation">:</span>
</span><span class="code-line">                    <span class="token key atrule">condition</span><span class="token punctuation">:</span>
</span><span class="code-line">                      <span class="token key atrule">lambda</span><span class="token punctuation">:</span> return <span class="token tag">!id(factory_reset_requested);</span>
</span><span class="code-line">                    <span class="token key atrule">then</span><span class="token punctuation">:</span>
</span><span class="code-line">                      <span class="token punctuation">-</span> <span class="token key atrule">light.turn_off</span><span class="token punctuation">:</span> voice_assistant_leds
</span><span class="code-line">                      <span class="token punctuation">-</span> <span class="token key atrule">script.execute</span><span class="token punctuation">:</span>
</span><span class="code-line">                          <span class="token key atrule">id</span><span class="token punctuation">:</span> play_sound
</span><span class="code-line">                          <span class="token key atrule">priority</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
</span><span class="code-line">                          <span class="token key atrule">sound_file</span><span class="token punctuation">:</span> <span class="token tag">!lambda</span> return id(factory_reset_cancelled_sound);
</span><span class="code-line">      <span class="token comment"># Factory Reset Confirmed.</span>
</span><span class="code-line">      <span class="token comment">#  . Audible warning to prompt user to release the button</span>
</span><span class="code-line">      <span class="token comment">#  . Set factory_reset_requested to true</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">timing</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token punctuation">-</span> ON for at least 22s
</span><span class="code-line">        <span class="token key atrule">then</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token punctuation">-</span> <span class="token key atrule">if</span><span class="token punctuation">:</span>
</span><span class="code-line">              <span class="token key atrule">condition</span><span class="token punctuation">:</span>
</span><span class="code-line">                <span class="token key atrule">lambda</span><span class="token punctuation">:</span> return <span class="token tag">!id(dial_touched);</span>
</span><span class="code-line">              <span class="token key atrule">then</span><span class="token punctuation">:</span>
</span><span class="code-line">                <span class="token punctuation">-</span> <span class="token key atrule">script.execute</span><span class="token punctuation">:</span>
</span><span class="code-line">                    <span class="token key atrule">id</span><span class="token punctuation">:</span> play_sound
</span><span class="code-line">                    <span class="token key atrule">priority</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
</span><span class="code-line">                    <span class="token key atrule">sound_file</span><span class="token punctuation">:</span> <span class="token tag">!lambda</span> return id(factory_reset_confirmed_sound);
</span><span class="code-line">                <span class="token punctuation">-</span> <span class="token key atrule">light.turn_on</span><span class="token punctuation">:</span>
</span><span class="code-line">                    <span class="token key atrule">brightness</span><span class="token punctuation">:</span> 100%
</span><span class="code-line">                    <span class="token key atrule">red</span><span class="token punctuation">:</span> 100%
</span><span class="code-line">                    <span class="token key atrule">green</span><span class="token punctuation">:</span> 0%
</span><span class="code-line">                    <span class="token key atrule">blue</span><span class="token punctuation">:</span> 0%
</span><span class="code-line">                    <span class="token key atrule">id</span><span class="token punctuation">:</span> voice_assistant_leds
</span><span class="code-line">                    <span class="token key atrule">effect</span><span class="token punctuation">:</span> <span class="token string">&quot;none&quot;</span>
</span><span class="code-line">                <span class="token punctuation">-</span> <span class="token key atrule">lambda</span><span class="token punctuation">:</span> id(factory_reset_requested) = true;
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="token key atrule">light</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token comment"># Hardware LED ring. Not used because remapping needed</span>
</span><span class="code-line">  <span class="token punctuation">-</span> <span class="token key atrule">platform</span><span class="token punctuation">:</span> esp32_rmt_led_strip
</span><span class="code-line">    <span class="token key atrule">id</span><span class="token punctuation">:</span> leds_internal
</span><span class="code-line">    <span class="token key atrule">rgb_order</span><span class="token punctuation">:</span> GRB
</span><span class="code-line">    <span class="token key atrule">pin</span><span class="token punctuation">:</span> GPIO09
</span><span class="code-line">    <span class="token key atrule">num_leds</span><span class="token punctuation">:</span> <span class="token number">29</span>
</span><span class="code-line">    <span class="token key atrule">rmt_symbols</span><span class="token punctuation">:</span> <span class="token number">96</span>
</span><span class="code-line">    <span class="token key atrule">chipset</span><span class="token punctuation">:</span> ws2812
</span><span class="code-line">    <span class="token comment"># power_supply: led_power</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token comment"># Voice Assistant LED ring. Remapping of the internal LED.</span>
</span><span class="code-line">  <span class="token comment"># This light is not exposed. The device controls it</span>
</span><span class="code-line">  <span class="token punctuation">-</span> <span class="token key atrule">platform</span><span class="token punctuation">:</span> partition
</span><span class="code-line">    <span class="token key atrule">id</span><span class="token punctuation">:</span> voice_assistant_leds
</span><span class="code-line">    <span class="token key atrule">internal</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
</span><span class="code-line">    <span class="token key atrule">default_transition_length</span><span class="token punctuation">:</span> 0ms
</span><span class="code-line">    <span class="token key atrule">segments</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> leds_internal
</span><span class="code-line">        <span class="token key atrule">from</span><span class="token punctuation">:</span> <span class="token number">15</span>
</span><span class="code-line">        <span class="token key atrule">to</span><span class="token punctuation">:</span> <span class="token number">28</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> leds_internal
</span><span class="code-line">        <span class="token key atrule">from</span><span class="token punctuation">:</span> <span class="token number">0</span>
</span><span class="code-line">        <span class="token key atrule">to</span><span class="token punctuation">:</span> <span class="token number">14</span>
</span><span class="code-line">    <span class="token key atrule">effects</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">addressable_lambda</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">&quot;Waiting for Command&quot;</span>
</span><span class="code-line">          <span class="token key atrule">update_interval</span><span class="token punctuation">:</span> 100ms
</span><span class="code-line">          <span class="token key atrule">lambda</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token punctuation">-</span>
</span><span class="code-line">            auto light_color = id(led_ring).current_values;
</span><span class="code-line">            Color color(light_color.get_red() * 255<span class="token punctuation">,</span> light_color.get_green() * 255<span class="token punctuation">,</span>
</span><span class="code-line">                  light_color.get_blue() * 255);
</span><span class="code-line">            for (uint8_t i = 0; i &lt; $<span class="token punctuation">{</span>no_of_leds<span class="token punctuation">}</span>; i++) <span class="token punctuation">{</span>
</span><span class="code-line">              if (i == id(global_led_animation_index) % $<span class="token punctuation">{</span>no_of_leds<span class="token punctuation">}</span>) <span class="token punctuation">{</span>
</span><span class="code-line">                it<span class="token punctuation">[</span>i<span class="token punctuation">]</span> = color;
</span><span class="code-line">              <span class="token punctuation">}</span> else if (i == (id(global_led_animation_index) + 11) % $<span class="token punctuation">{</span>no_of_leds<span class="token punctuation">}</span>) <span class="token punctuation">{</span>
</span><span class="code-line">                it<span class="token punctuation">[</span>i<span class="token punctuation">]</span> = color * 192;
</span><span class="code-line">              <span class="token punctuation">}</span> else if (i == (id(global_led_animation_index) + 10) % $<span class="token punctuation">{</span>no_of_leds<span class="token punctuation">}</span>) <span class="token punctuation">{</span>
</span><span class="code-line">                it<span class="token punctuation">[</span>i<span class="token punctuation">]</span> = color * 128;
</span><span class="code-line">              <span class="token punctuation">}</span> else if (i == (id(global_led_animation_index) + 6) % $<span class="token punctuation">{</span>no_of_leds<span class="token punctuation">}</span>) <span class="token punctuation">{</span>
</span><span class="code-line">                it<span class="token punctuation">[</span>i<span class="token punctuation">]</span> = color;
</span><span class="code-line">              <span class="token punctuation">}</span> else if (i == (id(global_led_animation_index) + 5) % $<span class="token punctuation">{</span>no_of_leds<span class="token punctuation">}</span>) <span class="token punctuation">{</span>
</span><span class="code-line">                it<span class="token punctuation">[</span>i<span class="token punctuation">]</span> = color * 192;
</span><span class="code-line">              <span class="token punctuation">}</span> else if (i == (id(global_led_animation_index) + 4) % $<span class="token punctuation">{</span>no_of_leds<span class="token punctuation">}</span>) <span class="token punctuation">{</span>
</span><span class="code-line">                it<span class="token punctuation">[</span>i<span class="token punctuation">]</span> = color * 128;
</span><span class="code-line">              <span class="token punctuation">}</span> else <span class="token punctuation">{</span>
</span><span class="code-line">                it<span class="token punctuation">[</span>i<span class="token punctuation">]</span> = Color<span class="token punctuation">:</span><span class="token punctuation">:</span>BLACK;
</span><span class="code-line">              <span class="token punctuation">}</span>
</span><span class="code-line">            <span class="token punctuation">}</span>
</span><span class="code-line">            id(global_led_animation_index) = (id(global_led_animation_index) + 1) % $<span class="token punctuation">{</span>no_of_leds<span class="token punctuation">}</span>;
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">addressable_lambda</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">&quot;Listening For Command&quot;</span>
</span><span class="code-line">          <span class="token key atrule">update_interval</span><span class="token punctuation">:</span> 50ms
</span><span class="code-line">          <span class="token key atrule">lambda</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token punctuation">-</span>
</span><span class="code-line">            auto light_color = id(led_ring).current_values;
</span><span class="code-line">            Color color(light_color.get_red() * 255<span class="token punctuation">,</span> light_color.get_green() * 255<span class="token punctuation">,</span>
</span><span class="code-line">                  light_color.get_blue() * 255);
</span><span class="code-line">            for (uint8_t i = 0; i &lt; $<span class="token punctuation">{</span>no_of_leds<span class="token punctuation">}</span>; i++) <span class="token punctuation">{</span>
</span><span class="code-line">              if (i == id(global_led_animation_index) % $<span class="token punctuation">{</span>no_of_leds<span class="token punctuation">}</span>) <span class="token punctuation">{</span>
</span><span class="code-line">                it<span class="token punctuation">[</span>i<span class="token punctuation">]</span> = color;
</span><span class="code-line">              <span class="token punctuation">}</span> else if (i == (id(global_led_animation_index) + 11) % $<span class="token punctuation">{</span>no_of_leds<span class="token punctuation">}</span>) <span class="token punctuation">{</span>
</span><span class="code-line">                it<span class="token punctuation">[</span>i<span class="token punctuation">]</span> = color * 192;
</span><span class="code-line">              <span class="token punctuation">}</span> else if (i == (id(global_led_animation_index) + 10) % $<span class="token punctuation">{</span>no_of_leds<span class="token punctuation">}</span>) <span class="token punctuation">{</span>
</span><span class="code-line">                it<span class="token punctuation">[</span>i<span class="token punctuation">]</span> = color * 128;
</span><span class="code-line">              <span class="token punctuation">}</span> else if (i == (id(global_led_animation_index) + 6) % $<span class="token punctuation">{</span>no_of_leds<span class="token punctuation">}</span>) <span class="token punctuation">{</span>
</span><span class="code-line">                it<span class="token punctuation">[</span>i<span class="token punctuation">]</span> = color;
</span><span class="code-line">              <span class="token punctuation">}</span> else if (i == (id(global_led_animation_index) + 5) % $<span class="token punctuation">{</span>no_of_leds<span class="token punctuation">}</span>) <span class="token punctuation">{</span>
</span><span class="code-line">                it<span class="token punctuation">[</span>i<span class="token punctuation">]</span> = color * 192;
</span><span class="code-line">              <span class="token punctuation">}</span> else if (i == (id(global_led_animation_index) + 4) % $<span class="token punctuation">{</span>no_of_leds<span class="token punctuation">}</span>) <span class="token punctuation">{</span>
</span><span class="code-line">                it<span class="token punctuation">[</span>i<span class="token punctuation">]</span> = color * 128;
</span><span class="code-line">              <span class="token punctuation">}</span> else <span class="token punctuation">{</span>
</span><span class="code-line">                it<span class="token punctuation">[</span>i<span class="token punctuation">]</span> = Color<span class="token punctuation">:</span><span class="token punctuation">:</span>BLACK;
</span><span class="code-line">              <span class="token punctuation">}</span>
</span><span class="code-line">            <span class="token punctuation">}</span>
</span><span class="code-line">            id(global_led_animation_index) = (id(global_led_animation_index) + 1) % $<span class="token punctuation">{</span>no_of_leds<span class="token punctuation">}</span>;
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">addressable_lambda</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">&quot;Thinking&quot;</span>
</span><span class="code-line">          <span class="token key atrule">update_interval</span><span class="token punctuation">:</span> 10ms
</span><span class="code-line">          <span class="token key atrule">lambda</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token punctuation">-</span>
</span><span class="code-line">            static uint8_t brightness_step = 0;
</span><span class="code-line">            static bool brightness_decreasing = true;
</span><span class="code-line">            static uint8_t brightness_step_number = 10;
</span><span class="code-line">            if (initial_run) <span class="token punctuation">{</span>
</span><span class="code-line">              brightness_step = 0;
</span><span class="code-line">              brightness_decreasing = true;
</span><span class="code-line">            <span class="token punctuation">}</span>
</span><span class="code-line">            auto light_color = id(led_ring).current_values;
</span><span class="code-line">            Color color(light_color.get_red() * 255<span class="token punctuation">,</span> light_color.get_green() * 255<span class="token punctuation">,</span>
</span><span class="code-line">                  light_color.get_blue() * 255);
</span><span class="code-line">            for (uint8_t i = 0; i &lt; $<span class="token punctuation">{</span>no_of_leds<span class="token punctuation">}</span>; i++) <span class="token punctuation">{</span>
</span><span class="code-line">              if (i == id(global_led_animation_index) % $<span class="token punctuation">{</span>no_of_leds<span class="token punctuation">}</span>) <span class="token punctuation">{</span>
</span><span class="code-line">                it<span class="token punctuation">[</span>i<span class="token punctuation">]</span> = color * uint8_t(255/brightness_step_number<span class="token important">*(brightness_step_number-brightness_step));</span>
</span><span class="code-line">              <span class="token punctuation">}</span> else if (i == (id(global_led_animation_index) + 5) % $<span class="token punctuation">{</span>no_of_leds<span class="token punctuation">}</span>) <span class="token punctuation">{</span>
</span><span class="code-line">                it<span class="token punctuation">[</span>i<span class="token punctuation">]</span> = color * uint8_t(255/brightness_step_number<span class="token important">*(brightness_step_number-brightness_step));</span>
</span><span class="code-line">              <span class="token punctuation">}</span> else if (i == (id(global_led_animation_index) + 10) % $<span class="token punctuation">{</span>no_of_leds<span class="token punctuation">}</span>) <span class="token punctuation">{</span>
</span><span class="code-line">                it<span class="token punctuation">[</span>i<span class="token punctuation">]</span> = color * uint8_t(255/brightness_step_number<span class="token important">*(brightness_step_number-brightness_step));</span>
</span><span class="code-line">              <span class="token punctuation">}</span> else if (i == (id(global_led_animation_index) + 15) % $<span class="token punctuation">{</span>no_of_leds<span class="token punctuation">}</span>) <span class="token punctuation">{</span>
</span><span class="code-line">                it<span class="token punctuation">[</span>i<span class="token punctuation">]</span> = color * uint8_t(255/brightness_step_number<span class="token important">*(brightness_step_number-brightness_step));</span>
</span><span class="code-line">              <span class="token punctuation">}</span> else if (i == (id(global_led_animation_index) + 20) % $<span class="token punctuation">{</span>no_of_leds<span class="token punctuation">}</span>) <span class="token punctuation">{</span>
</span><span class="code-line">                it<span class="token punctuation">[</span>i<span class="token punctuation">]</span> = color * uint8_t(255/brightness_step_number<span class="token important">*(brightness_step_number-brightness_step));</span>
</span><span class="code-line">              <span class="token punctuation">}</span> else if (i == (id(global_led_animation_index) + 25) % $<span class="token punctuation">{</span>no_of_leds<span class="token punctuation">}</span>) <span class="token punctuation">{</span>
</span><span class="code-line">                it<span class="token punctuation">[</span>i<span class="token punctuation">]</span> = color * uint8_t(255/brightness_step_number<span class="token important">*(brightness_step_number-brightness_step));</span>
</span><span class="code-line">
</span><span class="code-line">              <span class="token punctuation">}</span> else <span class="token punctuation">{</span>
</span><span class="code-line">                it<span class="token punctuation">[</span>i<span class="token punctuation">]</span> = Color<span class="token punctuation">:</span><span class="token punctuation">:</span>BLACK;
</span><span class="code-line">              <span class="token punctuation">}</span>
</span><span class="code-line">            <span class="token punctuation">}</span>
</span><span class="code-line">            if (brightness_decreasing) <span class="token punctuation">{</span>
</span><span class="code-line">              brightness_step++;
</span><span class="code-line">            <span class="token punctuation">}</span> else <span class="token punctuation">{</span>
</span><span class="code-line">              brightness_step<span class="token punctuation">-</span><span class="token punctuation">-</span>;
</span><span class="code-line">            <span class="token punctuation">}</span>
</span><span class="code-line">            if (brightness_step == 0 <span class="token punctuation">|</span><span class="token punctuation">|</span> brightness_step == brightness_step_number) <span class="token punctuation">{</span>
</span><span class="code-line">              brightness_decreasing = <span class="token tag">!brightness_decreasing;</span>
</span><span class="code-line">            <span class="token punctuation">}</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">addressable_lambda</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">&quot;Replying&quot;</span>
</span><span class="code-line">          <span class="token key atrule">update_interval</span><span class="token punctuation">:</span> 50ms
</span><span class="code-line">          <span class="token key atrule">lambda</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token punctuation">-</span>
</span><span class="code-line">            id(global_led_animation_index) = ($<span class="token punctuation">{</span>no_of_leds<span class="token punctuation">}</span> + id(global_led_animation_index) <span class="token punctuation">-</span> 1) % $<span class="token punctuation">{</span>no_of_leds<span class="token punctuation">}</span>;
</span><span class="code-line">            auto light_color = id(led_ring).current_values;
</span><span class="code-line">            Color color(light_color.get_red() * 255<span class="token punctuation">,</span> light_color.get_green() * 255<span class="token punctuation">,</span>
</span><span class="code-line">                  light_color.get_blue() * 255);
</span><span class="code-line">            for (uint8_t i = 0; i &lt; $<span class="token punctuation">{</span>no_of_leds<span class="token punctuation">}</span>; i++) <span class="token punctuation">{</span>
</span><span class="code-line">              if (i == (id(global_led_animation_index)) % $<span class="token punctuation">{</span>no_of_leds<span class="token punctuation">}</span>) <span class="token punctuation">{</span>
</span><span class="code-line">                it<span class="token punctuation">[</span>i<span class="token punctuation">]</span> = color;
</span><span class="code-line">              <span class="token punctuation">}</span> else if (i == ( id(global_led_animation_index) + 1) % $<span class="token punctuation">{</span>no_of_leds<span class="token punctuation">}</span>) <span class="token punctuation">{</span>
</span><span class="code-line">                it<span class="token punctuation">[</span>i<span class="token punctuation">]</span> = color * 192;
</span><span class="code-line">              <span class="token punctuation">}</span> else if (i == ( id(global_led_animation_index) + 2) % $<span class="token punctuation">{</span>no_of_leds<span class="token punctuation">}</span>) <span class="token punctuation">{</span>
</span><span class="code-line">                it<span class="token punctuation">[</span>i<span class="token punctuation">]</span> = color * 128;
</span><span class="code-line">              <span class="token punctuation">}</span> else if (i == ( id(global_led_animation_index) + 6) % $<span class="token punctuation">{</span>no_of_leds<span class="token punctuation">}</span>) <span class="token punctuation">{</span>
</span><span class="code-line">                it<span class="token punctuation">[</span>i<span class="token punctuation">]</span> = color;
</span><span class="code-line">              <span class="token punctuation">}</span> else if (i == ( id(global_led_animation_index) + 7) % $<span class="token punctuation">{</span>no_of_leds<span class="token punctuation">}</span>) <span class="token punctuation">{</span>
</span><span class="code-line">                it<span class="token punctuation">[</span>i<span class="token punctuation">]</span> = color * 192;
</span><span class="code-line">              <span class="token punctuation">}</span> else if (i == ( id(global_led_animation_index) + 8) % $<span class="token punctuation">{</span>no_of_leds<span class="token punctuation">}</span>) <span class="token punctuation">{</span>
</span><span class="code-line">                it<span class="token punctuation">[</span>i<span class="token punctuation">]</span> = color * 128;
</span><span class="code-line">              <span class="token punctuation">}</span> else <span class="token punctuation">{</span>
</span><span class="code-line">                it<span class="token punctuation">[</span>i<span class="token punctuation">]</span> = Color<span class="token punctuation">:</span><span class="token punctuation">:</span>BLACK;
</span><span class="code-line">              <span class="token punctuation">}</span>
</span><span class="code-line">            <span class="token punctuation">}</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">addressable_lambda</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">&quot;Muted or Silent&quot;</span>
</span><span class="code-line">          <span class="token key atrule">update_interval</span><span class="token punctuation">:</span> 16ms
</span><span class="code-line">          <span class="token key atrule">lambda</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token punctuation">-</span>
</span><span class="code-line">            static int8_t index = 0;
</span><span class="code-line">            Color muted_color(255<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> 0);
</span><span class="code-line">            auto light_color = id(led_ring).current_values;
</span><span class="code-line">            Color color(light_color.get_red() * 255<span class="token punctuation">,</span> light_color.get_green() * 255<span class="token punctuation">,</span>
</span><span class="code-line">                  light_color.get_blue() * 255);
</span><span class="code-line">            for (uint8_t i = 0; i &lt; $<span class="token punctuation">{</span>no_of_leds<span class="token punctuation">}</span>; i++) <span class="token punctuation">{</span>
</span><span class="code-line">              if ( light_color.get_state() ) <span class="token punctuation">{</span>
</span><span class="code-line">                it<span class="token punctuation">[</span>i<span class="token punctuation">]</span> = color;
</span><span class="code-line">              <span class="token punctuation">}</span> else <span class="token punctuation">{</span>
</span><span class="code-line">                it<span class="token punctuation">[</span>i<span class="token punctuation">]</span> = Color<span class="token punctuation">:</span><span class="token punctuation">:</span>BLACK;
</span><span class="code-line">              <span class="token punctuation">}</span>
</span><span class="code-line">            <span class="token punctuation">}</span>
</span><span class="code-line">            if ( id(master_mute_switch).state ) <span class="token punctuation">{</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line">            <span class="token punctuation">}</span>
</span><span class="code-line">            if ( id(external_media_player).volume == 0.0f <span class="token punctuation">|</span><span class="token punctuation">|</span> id(external_media_player).is_muted() <span class="token punctuation">|</span><span class="token punctuation">|</span> id(master_mute_switch).state ) <span class="token punctuation">{</span>
</span><span class="code-line">              it<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> = Color<span class="token punctuation">:</span><span class="token punctuation">:</span>BLACK;
</span><span class="code-line">              it<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> = muted_color;
</span><span class="code-line">              it<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> = Color<span class="token punctuation">:</span><span class="token punctuation">:</span>BLACK;
</span><span class="code-line">              it<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> = muted_color;
</span><span class="code-line">              it<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> = Color<span class="token punctuation">:</span><span class="token punctuation">:</span>BLACK;
</span><span class="code-line">              it<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span> = muted_color;
</span><span class="code-line">              it<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span> = Color<span class="token punctuation">:</span><span class="token punctuation">:</span>BLACK;
</span><span class="code-line">              it<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span> = muted_color;
</span><span class="code-line">              it<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span> = Color<span class="token punctuation">:</span><span class="token punctuation">:</span>BLACK;
</span><span class="code-line">              it<span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">]</span> = muted_color;
</span><span class="code-line">            <span class="token punctuation">}</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">addressable_lambda</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">&quot;Voice kit startup failed&quot;</span>
</span><span class="code-line">          <span class="token comment"># update_interval: 16ms</span>
</span><span class="code-line">          <span class="token key atrule">lambda</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token punctuation">-</span>
</span><span class="code-line">            static int8_t index = 0;
</span><span class="code-line">            Color fail_color(255<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> 0);
</span><span class="code-line">            for (uint8_t i = 0; i &lt; $<span class="token punctuation">{</span>no_of_leds<span class="token punctuation">}</span>; i++) <span class="token punctuation">{</span>
</span><span class="code-line">              if (i % 3) <span class="token punctuation">{</span>
</span><span class="code-line">                it<span class="token punctuation">[</span>i<span class="token punctuation">]</span> = Color<span class="token punctuation">:</span><span class="token punctuation">:</span>BLACK;
</span><span class="code-line">              <span class="token punctuation">}</span> else <span class="token punctuation">{</span>
</span><span class="code-line">                it<span class="token punctuation">[</span>i<span class="token punctuation">]</span> = fail_color;
</span><span class="code-line">              <span class="token punctuation">}</span>
</span><span class="code-line">            <span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">addressable_lambda</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">&quot;Center Button Touched&quot;</span>
</span><span class="code-line">          <span class="token key atrule">update_interval</span><span class="token punctuation">:</span> 16ms
</span><span class="code-line">          <span class="token key atrule">lambda</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token punctuation">-</span>
</span><span class="code-line">            if (initial_run) <span class="token punctuation">{</span>
</span><span class="code-line">              // set voice_assistant_leds light to colors based on led_ring
</span><span class="code-line">              auto led_ring_cv = id(led_ring).current_values;
</span><span class="code-line">              auto va_leds_call = id(voice_assistant_leds).make_call();
</span><span class="code-line">              va_leds_call.from_light_color_values(led_ring_cv);
</span><span class="code-line">              va_leds_call.set_brightness( min ( max( id(led_ring).current_values.get_brightness() <span class="token punctuation">,</span> 0.2f ) + 0.1f <span class="token punctuation">,</span> 1.0f ) );
</span><span class="code-line">              va_leds_call.set_state(true);
</span><span class="code-line">              va_leds_call.perform();
</span><span class="code-line">            <span class="token punctuation">}</span>
</span><span class="code-line">            auto light_color = id(voice_assistant_leds).current_values;
</span><span class="code-line">            Color color(light_color.get_red() * 255<span class="token punctuation">,</span> light_color.get_green() * 255<span class="token punctuation">,</span>
</span><span class="code-line">                  light_color.get_blue() * 255);
</span><span class="code-line">            for (uint8_t i = 0; i &lt; $<span class="token punctuation">{</span>no_of_leds<span class="token punctuation">}</span>; i++) <span class="token punctuation">{</span>
</span><span class="code-line">              it<span class="token punctuation">[</span>i<span class="token punctuation">]</span> = color;
</span><span class="code-line">            <span class="token punctuation">}</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">addressable_twinkle</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">&quot;Twinkle&quot;</span>
</span><span class="code-line">          <span class="token key atrule">twinkle_probability</span><span class="token punctuation">:</span> 50%
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">addressable_lambda</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">&quot;Error&quot;</span>
</span><span class="code-line">          <span class="token key atrule">update_interval</span><span class="token punctuation">:</span> 10ms
</span><span class="code-line">          <span class="token key atrule">lambda</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token punctuation">-</span>
</span><span class="code-line">            static uint8_t brightness_step = 0;
</span><span class="code-line">            static bool brightness_decreasing = true;
</span><span class="code-line">            static uint8_t brightness_step_number = 10;
</span><span class="code-line">            if (initial_run) <span class="token punctuation">{</span>
</span><span class="code-line">              brightness_step = 0;
</span><span class="code-line">              brightness_decreasing = true;
</span><span class="code-line">            <span class="token punctuation">}</span>
</span><span class="code-line">            Color error_color(255<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> 0);
</span><span class="code-line">            for (uint8_t i = 0; i &lt; $<span class="token punctuation">{</span>no_of_leds<span class="token punctuation">}</span>; i++) <span class="token punctuation">{</span>
</span><span class="code-line">              it<span class="token punctuation">[</span>i<span class="token punctuation">]</span> = error_color * uint8_t(255/brightness_step_number<span class="token important">*(brightness_step_number-brightness_step));</span>
</span><span class="code-line">            <span class="token punctuation">}</span>
</span><span class="code-line">            if (brightness_decreasing) <span class="token punctuation">{</span>
</span><span class="code-line">              brightness_step++;
</span><span class="code-line">            <span class="token punctuation">}</span> else <span class="token punctuation">{</span>
</span><span class="code-line">              brightness_step<span class="token punctuation">-</span><span class="token punctuation">-</span>;
</span><span class="code-line">            <span class="token punctuation">}</span>
</span><span class="code-line">            if (brightness_step == 0 <span class="token punctuation">|</span><span class="token punctuation">|</span> brightness_step == brightness_step_number) <span class="token punctuation">{</span>
</span><span class="code-line">              brightness_decreasing = <span class="token tag">!brightness_decreasing;</span>
</span><span class="code-line">            <span class="token punctuation">}</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">addressable_lambda</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">&quot;Timer Ring&quot;</span>
</span><span class="code-line">          <span class="token key atrule">update_interval</span><span class="token punctuation">:</span> 10ms
</span><span class="code-line">          <span class="token key atrule">lambda</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token punctuation">-</span>
</span><span class="code-line">            static uint8_t brightness_step = 0;
</span><span class="code-line">            static bool brightness_decreasing = true;
</span><span class="code-line">            static uint8_t brightness_step_number = 10;
</span><span class="code-line">            if (initial_run) <span class="token punctuation">{</span>
</span><span class="code-line">              brightness_step = 0;
</span><span class="code-line">              brightness_decreasing = true;
</span><span class="code-line">            <span class="token punctuation">}</span>
</span><span class="code-line">            auto light_color = id(led_ring).current_values;
</span><span class="code-line">            Color color(light_color.get_red() * 255<span class="token punctuation">,</span> light_color.get_green() * 255<span class="token punctuation">,</span>
</span><span class="code-line">                  light_color.get_blue() * 255);
</span><span class="code-line">            Color muted_color(255<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> 0);
</span><span class="code-line">            for (uint8_t i = 0; i &lt; $<span class="token punctuation">{</span>no_of_leds<span class="token punctuation">}</span>; i++) <span class="token punctuation">{</span>
</span><span class="code-line">              it<span class="token punctuation">[</span>i<span class="token punctuation">]</span> = color * uint8_t(255/brightness_step_number<span class="token important">*(brightness_step_number-brightness_step));</span>
</span><span class="code-line">            <span class="token punctuation">}</span>
</span><span class="code-line">            if ( id(master_mute_switch).state ) <span class="token punctuation">{</span>
</span><span class="code-line">              it<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> = muted_color;
</span><span class="code-line">              it<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> = muted_color;
</span><span class="code-line">            <span class="token punctuation">}</span>
</span><span class="code-line">            if (brightness_decreasing) <span class="token punctuation">{</span>
</span><span class="code-line">              brightness_step++;
</span><span class="code-line">            <span class="token punctuation">}</span> else <span class="token punctuation">{</span>
</span><span class="code-line">              brightness_step<span class="token punctuation">-</span><span class="token punctuation">-</span>;
</span><span class="code-line">            <span class="token punctuation">}</span>
</span><span class="code-line">            if (brightness_step == 0 <span class="token punctuation">|</span><span class="token punctuation">|</span> brightness_step == brightness_step_number) <span class="token punctuation">{</span>
</span><span class="code-line">              brightness_decreasing = <span class="token tag">!brightness_decreasing;</span>
</span><span class="code-line">            <span class="token punctuation">}</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">addressable_lambda</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">&quot;Timer Tick&quot;</span>
</span><span class="code-line">          <span class="token key atrule">update_interval</span><span class="token punctuation">:</span> 100ms
</span><span class="code-line">          <span class="token key atrule">lambda</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token punctuation">-</span>
</span><span class="code-line">            auto light_color = id(led_ring).current_values;
</span><span class="code-line">            Color color(light_color.get_red() * 255<span class="token punctuation">,</span> light_color.get_green() * 255<span class="token punctuation">,</span>
</span><span class="code-line">                  light_color.get_blue() * 255);
</span><span class="code-line">            Color muted_color(255<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> 0);
</span><span class="code-line">            auto timer_ratio = 12.0f * id(first_active_timer).seconds_left / max(id(first_active_timer).total_seconds <span class="token punctuation">,</span> static_cast&lt;uint32_t<span class="token punctuation">&gt;</span>(1));
</span><span class="code-line">            uint8_t last_led_on = static_cast&lt;uint8_t<span class="token punctuation">&gt;</span>(ceil(timer_ratio)) <span class="token punctuation">-</span> 1;
</span><span class="code-line">            for (uint8_t i = 0; i &lt; $<span class="token punctuation">{</span>no_of_leds<span class="token punctuation">}</span>; i++) <span class="token punctuation">{</span>
</span><span class="code-line">              float brightness_dip = ( i == id(global_led_animation_index) % $<span class="token punctuation">{</span>no_of_leds<span class="token punctuation">}</span> <span class="token important">&amp;&amp;</span> i <span class="token tag">!=</span> last_led_on ) <span class="token punctuation">?</span> <span class="token key atrule">0.9f</span> <span class="token punctuation">:</span> 1.0f ;
</span><span class="code-line">              if (i &lt;= timer_ratio) <span class="token punctuation">{</span>
</span><span class="code-line">                it<span class="token punctuation">[</span>i<span class="token punctuation">]</span> = color * min(255.0f * brightness_dip * (timer_ratio <span class="token punctuation">-</span> i) <span class="token punctuation">,</span> 255.0f * brightness_dip) ;
</span><span class="code-line">              <span class="token punctuation">}</span> else <span class="token punctuation">{</span>
</span><span class="code-line">                it<span class="token punctuation">[</span>i<span class="token punctuation">]</span> = Color<span class="token punctuation">:</span><span class="token punctuation">:</span>BLACK;
</span><span class="code-line">              <span class="token punctuation">}</span>
</span><span class="code-line">            <span class="token punctuation">}</span>
</span><span class="code-line">            if (id(master_mute_switch).state) <span class="token punctuation">{</span>
</span><span class="code-line">              it<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> = Color<span class="token punctuation">:</span><span class="token punctuation">:</span>BLACK;
</span><span class="code-line">              it<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> = muted_color;
</span><span class="code-line">              it<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> = Color<span class="token punctuation">:</span><span class="token punctuation">:</span>BLACK;
</span><span class="code-line">              it<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> = Color<span class="token punctuation">:</span><span class="token punctuation">:</span>BLACK;
</span><span class="code-line">              it<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> = muted_color;
</span><span class="code-line">              it<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> = Color<span class="token punctuation">:</span><span class="token punctuation">:</span>BLACK;
</span><span class="code-line">            <span class="token punctuation">}</span>
</span><span class="code-line">            id(global_led_animation_index) = ($<span class="token punctuation">{</span>no_of_leds<span class="token punctuation">}</span> + id(global_led_animation_index) <span class="token punctuation">-</span> 1) % $<span class="token punctuation">{</span>no_of_leds<span class="token punctuation">}</span>;
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">addressable_rainbow</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">&quot;Rainbow&quot;</span>
</span><span class="code-line">          <span class="token key atrule">width</span><span class="token punctuation">:</span> <span class="token number">29</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">addressable_lambda</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">&quot;Tick&quot;</span>
</span><span class="code-line">          <span class="token key atrule">update_interval</span><span class="token punctuation">:</span> 333ms
</span><span class="code-line">          <span class="token key atrule">lambda</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token punctuation">-</span>
</span><span class="code-line">            static uint8_t index = 0;
</span><span class="code-line">            Color color(255<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> 0);
</span><span class="code-line">            if (initial_run) <span class="token punctuation">{</span>
</span><span class="code-line">              index = 0;
</span><span class="code-line">            <span class="token punctuation">}</span>
</span><span class="code-line">            for (uint8_t i = 0; i &lt; $<span class="token punctuation">{</span>no_of_leds<span class="token punctuation">}</span>; i++) <span class="token punctuation">{</span>
</span><span class="code-line">              if (i &lt;= index ) <span class="token punctuation">{</span>
</span><span class="code-line">                it<span class="token punctuation">[</span>i<span class="token punctuation">]</span> = Color<span class="token punctuation">:</span><span class="token punctuation">:</span>BLACK;
</span><span class="code-line">              <span class="token punctuation">}</span> else <span class="token punctuation">{</span>
</span><span class="code-line">                it<span class="token punctuation">[</span>i<span class="token punctuation">]</span> = color;
</span><span class="code-line">              <span class="token punctuation">}</span>
</span><span class="code-line">            <span class="token punctuation">}</span>
</span><span class="code-line">            index = (index + 1) % $<span class="token punctuation">{</span>no_of_leds<span class="token punctuation">}</span>;
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">addressable_lambda</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">&quot;Factory Reset Coming Up&quot;</span>
</span><span class="code-line">          <span class="token key atrule">update_interval</span><span class="token punctuation">:</span> 1s
</span><span class="code-line">          <span class="token key atrule">lambda</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token punctuation">-</span>
</span><span class="code-line">            static uint8_t index = 0;
</span><span class="code-line">            Color color(255<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> 0);
</span><span class="code-line">            if (initial_run) <span class="token punctuation">{</span>
</span><span class="code-line">              index = 0;
</span><span class="code-line">            <span class="token punctuation">}</span>
</span><span class="code-line">            for (uint8_t i = 0; i &lt; $<span class="token punctuation">{</span>no_of_leds<span class="token punctuation">}</span>; i++) <span class="token punctuation">{</span>
</span><span class="code-line">              if (i &lt;= index ) <span class="token punctuation">{</span>
</span><span class="code-line">                it<span class="token punctuation">[</span>i<span class="token punctuation">]</span> = color;
</span><span class="code-line">              <span class="token punctuation">}</span> else <span class="token punctuation">{</span>
</span><span class="code-line">                it<span class="token punctuation">[</span>i<span class="token punctuation">]</span> = Color<span class="token punctuation">:</span><span class="token punctuation">:</span>BLACK;
</span><span class="code-line">              <span class="token punctuation">}</span>
</span><span class="code-line">            <span class="token punctuation">}</span>
</span><span class="code-line">            index = (index + 1) % $<span class="token punctuation">{</span>no_of_leds<span class="token punctuation">}</span>;
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line">  <span class="token comment"># User facing LED ring. Remapping of the internal LEDs.</span>
</span><span class="code-line">  <span class="token comment"># Exposed to be used by the user.</span>
</span><span class="code-line">  <span class="token punctuation">-</span> <span class="token key atrule">platform</span><span class="token punctuation">:</span> partition
</span><span class="code-line">    <span class="token key atrule">id</span><span class="token punctuation">:</span> led_ring
</span><span class="code-line">    <span class="token key atrule">name</span><span class="token punctuation">:</span> LED Ring
</span><span class="code-line">    <span class="token key atrule">entity_category</span><span class="token punctuation">:</span> config
</span><span class="code-line">    <span class="token key atrule">icon</span><span class="token punctuation">:</span> <span class="token string">&quot;mdi:circle-outline&quot;</span>
</span><span class="code-line">    <span class="token key atrule">default_transition_length</span><span class="token punctuation">:</span> 0ms
</span><span class="code-line">    <span class="token key atrule">restore_mode</span><span class="token punctuation">:</span> RESTORE_DEFAULT_OFF
</span><span class="code-line">    <span class="token key atrule">initial_state</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token key atrule">color_mode</span><span class="token punctuation">:</span> rgb
</span><span class="code-line">      <span class="token key atrule">brightness</span><span class="token punctuation">:</span> 66%
</span><span class="code-line">      <span class="token key atrule">red</span><span class="token punctuation">:</span> 9.4%
</span><span class="code-line">      <span class="token key atrule">green</span><span class="token punctuation">:</span> 73.3%
</span><span class="code-line">      <span class="token key atrule">blue</span><span class="token punctuation">:</span> 94.9%
</span><span class="code-line">    <span class="token key atrule">segments</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> leds_internal
</span><span class="code-line">        <span class="token key atrule">from</span><span class="token punctuation">:</span> <span class="token number">7</span>
</span><span class="code-line">        <span class="token key atrule">to</span><span class="token punctuation">:</span> <span class="token number">11</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> leds_internal
</span><span class="code-line">        <span class="token key atrule">from</span><span class="token punctuation">:</span> <span class="token number">0</span>
</span><span class="code-line">        <span class="token key atrule">to</span><span class="token punctuation">:</span> <span class="token number">6</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment"># power_supply:</span>
</span><span class="code-line"><span class="token comment">#   - id: led_power</span>
</span><span class="code-line"><span class="token comment">#     pin: GPIO45</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="token key atrule">event</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token comment"># Event entity exposed to the user to automate on complex center button presses.</span>
</span><span class="code-line">  <span class="token comment"># The simple press is not exposed as it is used to control the device itself.</span>
</span><span class="code-line">  <span class="token punctuation">-</span> <span class="token key atrule">platform</span><span class="token punctuation">:</span> template
</span><span class="code-line">    <span class="token key atrule">id</span><span class="token punctuation">:</span> button_press_event
</span><span class="code-line">    <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">&quot;Button press&quot;</span>
</span><span class="code-line">    <span class="token key atrule">icon</span><span class="token punctuation">:</span> mdi<span class="token punctuation">:</span>button<span class="token punctuation">-</span>pointer
</span><span class="code-line">    <span class="token key atrule">device_class</span><span class="token punctuation">:</span> button
</span><span class="code-line">    <span class="token key atrule">event_types</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token punctuation">-</span> double_press
</span><span class="code-line">      <span class="token punctuation">-</span> triple_press
</span><span class="code-line">      <span class="token punctuation">-</span> long_press
</span><span class="code-line">      <span class="token punctuation">-</span> easter_egg_press
</span><span class="code-line">
</span><span class="code-line"><span class="token key atrule">script</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token comment"># Master script controlling the LEDs, based on different conditions : initialization in progress, wifi and api connected and voice assistant phase.</span>
</span><span class="code-line">  <span class="token comment"># For the sake of simplicity and re-usability, the script calls child scripts defined below.</span>
</span><span class="code-line">  <span class="token comment"># This script will be called every time one of these conditions is changing.</span>
</span><span class="code-line">  <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> control_leds
</span><span class="code-line">    <span class="token key atrule">then</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">lambda</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token scalar string">
</span></span><span class="code-line"><span class="token scalar string">          id(check_if_timers_active).execute();
</span></span><span class="code-line"><span class="token scalar string">          if (id(is_timer_active)){
</span></span><span class="code-line"><span class="token scalar string">            id(fetch_first_active_timer).execute();
</span></span><span class="code-line"><span class="token scalar string">          }
</span></span><span class="code-line"><span class="token scalar string">          if (id(improv_ble_in_progress)) {
</span></span><span class="code-line"><span class="token scalar string">            id(control_leds_improv_ble_state).execute();
</span></span><span class="code-line"><span class="token scalar string">          } else if (id(init_in_progress)) {
</span></span><span class="code-line"><span class="token scalar string">            id(control_leds_init_state).execute();
</span></span><span class="code-line"><span class="token scalar string">          } else if (!id(wifi_id).is_connected() || !id(api_id).is_connected()){
</span></span><span class="code-line"><span class="token scalar string">            id(control_leds_no_ha_connection_state).execute();
</span></span><span class="code-line"><span class="token scalar string">          //} else if (id(center_button).state) {
</span></span><span class="code-line"><span class="token scalar string">          //  id(control_leds_center_button_touched).execute();
</span></span><span class="code-line"><span class="token scalar string">          } else if (id(jack_plugged_recently)) {
</span></span><span class="code-line"><span class="token scalar string">            id(control_leds_jack_plugged_recently).execute();
</span></span><span class="code-line"><span class="token scalar string">          } else if (id(jack_unplugged_recently)) {
</span></span><span class="code-line"><span class="token scalar string">            id(control_leds_jack_unplugged_recently).execute();
</span></span><span class="code-line"><span class="token scalar string">          } else if (id(dial_touched)) {
</span></span><span class="code-line"><span class="token scalar string">            id(control_leds_dial_touched).execute();
</span></span><span class="code-line"><span class="token scalar string">          } else if (id(timer_ringing).state) {
</span></span><span class="code-line"><span class="token scalar string">            id(control_leds_timer_ringing).execute();
</span></span><span class="code-line"><span class="token scalar string">          } else if (id(voice_assistant_phase) == ${voice_assist_waiting_for_command_phase_id}) {
</span></span><span class="code-line"><span class="token scalar string">            id(control_leds_voice_assistant_waiting_for_command_phase).execute();
</span></span><span class="code-line"><span class="token scalar string">          } else if (id(voice_assistant_phase) == ${voice_assist_listening_for_command_phase_id}) {
</span></span><span class="code-line"><span class="token scalar string">            id(control_leds_voice_assistant_listening_for_command_phase).execute();
</span></span><span class="code-line"><span class="token scalar string">          } else if (id(voice_assistant_phase) == ${voice_assist_thinking_phase_id}) {
</span></span><span class="code-line"><span class="token scalar string">            id(control_leds_voice_assistant_thinking_phase).execute();
</span></span><span class="code-line"><span class="token scalar string">          } else if (id(voice_assistant_phase) == ${voice_assist_replying_phase_id}) {
</span></span><span class="code-line"><span class="token scalar string">            id(control_leds_voice_assistant_replying_phase).execute();
</span></span><span class="code-line"><span class="token scalar string">          } else if (id(voice_assistant_phase) == ${voice_assist_error_phase_id}) {
</span></span><span class="code-line"><span class="token scalar string">            id(control_leds_voice_assistant_error_phase).execute();
</span></span><span class="code-line"><span class="token scalar string">          } else if (id(voice_assistant_phase) == ${voice_assist_not_ready_phase_id}) {
</span></span><span class="code-line"><span class="token scalar string">            id(control_leds_voice_assistant_not_ready_phase).execute();
</span></span><span class="code-line"><span class="token scalar string">          } else if (id(is_timer_active)) {
</span></span><span class="code-line"><span class="token scalar string">            id(control_leds_timer_ticking).execute();
</span></span><span class="code-line"><span class="token scalar string">          } else if (id(master_mute_switch).state) {
</span></span><span class="code-line"><span class="token scalar string">            id(control_leds_muted_or_silent).execute();
</span></span><span class="code-line"><span class="token scalar string">          } else if (id(external_media_player).volume == 0.0f || id(external_media_player).is_muted()) {
</span></span><span class="code-line"><span class="token scalar string">            id(control_leds_muted_or_silent).execute();
</span></span><span class="code-line"><span class="token scalar string">          } else if (id(voice_assistant_phase) == ${voice_assist_idle_phase_id}) {
</span></span><span class="code-line"><span class="token scalar string">            id(control_leds_voice_assistant_idle_phase).execute();
</span></span><span class="code-line"><span class="token scalar string">          }</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token comment"># Script executed if voice_kit startup failed</span>
</span><span class="code-line">  <span class="token comment"># Static red &quot;X&quot;</span>
</span><span class="code-line">  <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> control_leds_voice_kit_startup_failed
</span><span class="code-line">    <span class="token key atrule">then</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">light.turn_on</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">brightness</span><span class="token punctuation">:</span> 40%
</span><span class="code-line">          <span class="token key atrule">red</span><span class="token punctuation">:</span> 0%
</span><span class="code-line">          <span class="token key atrule">green</span><span class="token punctuation">:</span> 0%
</span><span class="code-line">          <span class="token key atrule">blue</span><span class="token punctuation">:</span> 0%
</span><span class="code-line">          <span class="token key atrule">id</span><span class="token punctuation">:</span> voice_assistant_leds
</span><span class="code-line">          <span class="token key atrule">effect</span><span class="token punctuation">:</span> <span class="token string">&quot;Voice kit startup failed&quot;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token comment"># Script executed during Improv BLE</span>
</span><span class="code-line">  <span class="token comment"># Warm White Twinkle</span>
</span><span class="code-line">  <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> control_leds_improv_ble_state
</span><span class="code-line">    <span class="token key atrule">then</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">light.turn_on</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">brightness</span><span class="token punctuation">:</span> 66%
</span><span class="code-line">          <span class="token key atrule">red</span><span class="token punctuation">:</span> 100%
</span><span class="code-line">          <span class="token key atrule">green</span><span class="token punctuation">:</span> 89%
</span><span class="code-line">          <span class="token key atrule">blue</span><span class="token punctuation">:</span> 71%
</span><span class="code-line">          <span class="token key atrule">id</span><span class="token punctuation">:</span> voice_assistant_leds
</span><span class="code-line">          <span class="token key atrule">effect</span><span class="token punctuation">:</span> <span class="token string">&quot;Twinkle&quot;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token comment"># Script executed during initialization</span>
</span><span class="code-line">  <span class="token comment"># Blue Twinkle if Wifi is connected, Else solid warm white</span>
</span><span class="code-line">  <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> control_leds_init_state
</span><span class="code-line">    <span class="token key atrule">then</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">if</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">condition</span><span class="token punctuation">:</span>
</span><span class="code-line">            <span class="token key atrule">wifi.connected</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">then</span><span class="token punctuation">:</span>
</span><span class="code-line">            <span class="token punctuation">-</span> <span class="token key atrule">light.turn_on</span><span class="token punctuation">:</span>
</span><span class="code-line">                <span class="token key atrule">brightness</span><span class="token punctuation">:</span> 66%
</span><span class="code-line">                <span class="token key atrule">red</span><span class="token punctuation">:</span> 9.4%
</span><span class="code-line">                <span class="token key atrule">green</span><span class="token punctuation">:</span> 73.3%
</span><span class="code-line">                <span class="token key atrule">blue</span><span class="token punctuation">:</span> 94.9%
</span><span class="code-line">                <span class="token key atrule">id</span><span class="token punctuation">:</span> voice_assistant_leds
</span><span class="code-line">                <span class="token key atrule">effect</span><span class="token punctuation">:</span> <span class="token string">&quot;Twinkle&quot;</span>
</span><span class="code-line">          <span class="token key atrule">else</span><span class="token punctuation">:</span>
</span><span class="code-line">            <span class="token punctuation">-</span> <span class="token key atrule">light.turn_on</span><span class="token punctuation">:</span>
</span><span class="code-line">                <span class="token key atrule">brightness</span><span class="token punctuation">:</span> 66%
</span><span class="code-line">                <span class="token key atrule">red</span><span class="token punctuation">:</span> 100%
</span><span class="code-line">                <span class="token key atrule">green</span><span class="token punctuation">:</span> 89%
</span><span class="code-line">                <span class="token key atrule">blue</span><span class="token punctuation">:</span> 71%
</span><span class="code-line">                <span class="token key atrule">id</span><span class="token punctuation">:</span> voice_assistant_leds
</span><span class="code-line">                <span class="token key atrule">effect</span><span class="token punctuation">:</span> <span class="token string">&quot;none&quot;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token comment"># Script executed when the device has no connection to Home Assistant</span>
</span><span class="code-line">  <span class="token comment"># Red Twinkle (This will be visible during HA updates for example)</span>
</span><span class="code-line">  <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> control_leds_no_ha_connection_state
</span><span class="code-line">    <span class="token key atrule">then</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">light.turn_on</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">brightness</span><span class="token punctuation">:</span> 66%
</span><span class="code-line">          <span class="token key atrule">red</span><span class="token punctuation">:</span> <span class="token number">1</span>
</span><span class="code-line">          <span class="token key atrule">green</span><span class="token punctuation">:</span> <span class="token number">0</span>
</span><span class="code-line">          <span class="token key atrule">blue</span><span class="token punctuation">:</span> <span class="token number">0</span>
</span><span class="code-line">          <span class="token key atrule">id</span><span class="token punctuation">:</span> voice_assistant_leds
</span><span class="code-line">          <span class="token key atrule">effect</span><span class="token punctuation">:</span> <span class="token string">&quot;Twinkle&quot;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token comment"># Script executed when the voice assistant is idle (waiting for a wake word)</span>
</span><span class="code-line">  <span class="token comment"># Nothing (Either LED ring off or LED ring on if the user decided to turn the user facing LED ring on)</span>
</span><span class="code-line">  <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> control_leds_voice_assistant_idle_phase
</span><span class="code-line">    <span class="token key atrule">then</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">light.turn_off</span><span class="token punctuation">:</span> voice_assistant_leds
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">if</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">condition</span><span class="token punctuation">:</span>
</span><span class="code-line">            <span class="token key atrule">light.is_on</span><span class="token punctuation">:</span> led_ring
</span><span class="code-line">          <span class="token key atrule">then</span><span class="token punctuation">:</span>
</span><span class="code-line">            <span class="token key atrule">light.turn_on</span><span class="token punctuation">:</span> led_ring
</span><span class="code-line">
</span><span class="code-line">  <span class="token comment"># Script executed when the voice assistant is waiting for a command (After the wake word)</span>
</span><span class="code-line">  <span class="token comment"># Slow clockwise spin of the LED ring.</span>
</span><span class="code-line">  <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> control_leds_voice_assistant_waiting_for_command_phase
</span><span class="code-line">    <span class="token key atrule">then</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">light.turn_on</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">brightness</span><span class="token punctuation">:</span> <span class="token tag">!lambda</span> return max( id(led_ring).current_values.get_brightness() <span class="token punctuation">,</span> 0.2f );
</span><span class="code-line">          <span class="token key atrule">id</span><span class="token punctuation">:</span> voice_assistant_leds
</span><span class="code-line">          <span class="token key atrule">effect</span><span class="token punctuation">:</span> <span class="token string">&quot;Waiting for Command&quot;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token comment"># Script executed when the voice assistant is listening to a command</span>
</span><span class="code-line">  <span class="token comment"># Fast clockwise spin of the LED ring.</span>
</span><span class="code-line">  <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> control_leds_voice_assistant_listening_for_command_phase
</span><span class="code-line">    <span class="token key atrule">then</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">light.turn_on</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">brightness</span><span class="token punctuation">:</span> <span class="token tag">!lambda</span> return max( id(led_ring).current_values.get_brightness() <span class="token punctuation">,</span> 0.2f );
</span><span class="code-line">          <span class="token key atrule">id</span><span class="token punctuation">:</span> voice_assistant_leds
</span><span class="code-line">          <span class="token key atrule">effect</span><span class="token punctuation">:</span> <span class="token string">&quot;Listening For Command&quot;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token comment"># Script executed when the voice assistant is thinking to a command</span>
</span><span class="code-line">  <span class="token comment"># The spin stops and the 2 LEDs that are currently on and blinking indicating the commend is being processed.</span>
</span><span class="code-line">  <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> control_leds_voice_assistant_thinking_phase
</span><span class="code-line">    <span class="token key atrule">then</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">light.turn_on</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">brightness</span><span class="token punctuation">:</span> <span class="token tag">!lambda</span> return max( id(led_ring).current_values.get_brightness() <span class="token punctuation">,</span> 0.2f );
</span><span class="code-line">          <span class="token key atrule">id</span><span class="token punctuation">:</span> voice_assistant_leds
</span><span class="code-line">          <span class="token key atrule">effect</span><span class="token punctuation">:</span> <span class="token string">&quot;Thinking&quot;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token comment"># Script executed when the voice assistant is thinking to a command</span>
</span><span class="code-line">  <span class="token comment"># Fast anticlockwise spin of the LED ring.</span>
</span><span class="code-line">  <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> control_leds_voice_assistant_replying_phase
</span><span class="code-line">    <span class="token key atrule">then</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">light.turn_on</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">brightness</span><span class="token punctuation">:</span> <span class="token tag">!lambda</span> return max( id(led_ring).current_values.get_brightness() <span class="token punctuation">,</span> 0.2f );
</span><span class="code-line">          <span class="token key atrule">id</span><span class="token punctuation">:</span> voice_assistant_leds
</span><span class="code-line">          <span class="token key atrule">effect</span><span class="token punctuation">:</span> <span class="token string">&quot;Replying&quot;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token comment"># Script executed when the voice assistant is in error</span>
</span><span class="code-line">  <span class="token comment"># Fast Red Pulse</span>
</span><span class="code-line">  <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> control_leds_voice_assistant_error_phase
</span><span class="code-line">    <span class="token key atrule">then</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">light.turn_on</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">brightness</span><span class="token punctuation">:</span> <span class="token tag">!lambda</span> return min ( max( id(led_ring).current_values.get_brightness() <span class="token punctuation">,</span> 0.2f ) + 0.1f <span class="token punctuation">,</span> 1.0f );
</span><span class="code-line">          <span class="token key atrule">red</span><span class="token punctuation">:</span> <span class="token number">1</span>
</span><span class="code-line">          <span class="token key atrule">green</span><span class="token punctuation">:</span> <span class="token number">0</span>
</span><span class="code-line">          <span class="token key atrule">blue</span><span class="token punctuation">:</span> <span class="token number">0</span>
</span><span class="code-line">          <span class="token key atrule">id</span><span class="token punctuation">:</span> voice_assistant_leds
</span><span class="code-line">          <span class="token key atrule">effect</span><span class="token punctuation">:</span> <span class="token string">&quot;Error&quot;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token comment"># Script executed when the voice assistant is muted or silent</span>
</span><span class="code-line">  <span class="token comment"># The LED next to the 2 microphones turn red / one red LED next to the speaker grill</span>
</span><span class="code-line">  <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> control_leds_muted_or_silent
</span><span class="code-line">    <span class="token key atrule">then</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">light.turn_on</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">brightness</span><span class="token punctuation">:</span> <span class="token tag">!lambda</span> return max( id(led_ring).current_values.get_brightness() <span class="token punctuation">,</span> 0.2f );
</span><span class="code-line">          <span class="token key atrule">id</span><span class="token punctuation">:</span> voice_assistant_leds
</span><span class="code-line">          <span class="token key atrule">effect</span><span class="token punctuation">:</span> <span class="token string">&quot;Muted or Silent&quot;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token comment"># Script executed when the voice assistant is not ready</span>
</span><span class="code-line">  <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> control_leds_voice_assistant_not_ready_phase
</span><span class="code-line">    <span class="token key atrule">then</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">light.turn_on</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">brightness</span><span class="token punctuation">:</span> 66%
</span><span class="code-line">          <span class="token key atrule">red</span><span class="token punctuation">:</span> <span class="token number">1</span>
</span><span class="code-line">          <span class="token key atrule">green</span><span class="token punctuation">:</span> <span class="token number">0</span>
</span><span class="code-line">          <span class="token key atrule">blue</span><span class="token punctuation">:</span> <span class="token number">0</span>
</span><span class="code-line">          <span class="token key atrule">id</span><span class="token punctuation">:</span> voice_assistant_leds
</span><span class="code-line">          <span class="token key atrule">effect</span><span class="token punctuation">:</span> <span class="token string">&quot;Twinkle&quot;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token comment"># Script executed when the dial is touched</span>
</span><span class="code-line">  <span class="token comment"># A number of LEDs turn on indicating a visual representation of the volume of the media player entity.</span>
</span><span class="code-line">  <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> control_leds_dial_touched
</span><span class="code-line">    <span class="token key atrule">then</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">light.turn_on</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">brightness</span><span class="token punctuation">:</span> <span class="token tag">!lambda</span> return max( id(led_ring).current_values.get_brightness() <span class="token punctuation">,</span> 0.2f );
</span><span class="code-line">          <span class="token key atrule">id</span><span class="token punctuation">:</span> voice_assistant_leds
</span><span class="code-line">          <span class="token key atrule">effect</span><span class="token punctuation">:</span> <span class="token string">&quot;Volume Display&quot;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token comment"># Script executed when the jack has just been unplugged</span>
</span><span class="code-line">  <span class="token comment"># A ripple effect</span>
</span><span class="code-line">  <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> control_leds_jack_unplugged_recently
</span><span class="code-line">    <span class="token key atrule">then</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">light.turn_on</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">brightness</span><span class="token punctuation">:</span> <span class="token tag">!lambda</span> return max( id(led_ring).current_values.get_brightness() <span class="token punctuation">,</span> 0.2f );
</span><span class="code-line">          <span class="token key atrule">id</span><span class="token punctuation">:</span> voice_assistant_leds
</span><span class="code-line">          <span class="token key atrule">effect</span><span class="token punctuation">:</span> <span class="token string">&quot;Jack Unplugged&quot;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token comment"># Script executed when the jack has just been plugged</span>
</span><span class="code-line">  <span class="token comment"># A ripple effect</span>
</span><span class="code-line">  <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> control_leds_jack_plugged_recently
</span><span class="code-line">    <span class="token key atrule">then</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">light.turn_on</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">brightness</span><span class="token punctuation">:</span> <span class="token tag">!lambda</span> return max( id(led_ring).current_values.get_brightness() <span class="token punctuation">,</span> 0.2f );
</span><span class="code-line">          <span class="token key atrule">id</span><span class="token punctuation">:</span> voice_assistant_leds
</span><span class="code-line">          <span class="token key atrule">effect</span><span class="token punctuation">:</span> <span class="token string">&quot;Jack Plugged&quot;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token comment"># Script executed when the center button is touched</span>
</span><span class="code-line">  <span class="token comment"># The complete LED ring turns on</span>
</span><span class="code-line">  <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> control_leds_center_button_touched
</span><span class="code-line">    <span class="token key atrule">then</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">light.turn_on</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">brightness</span><span class="token punctuation">:</span> <span class="token tag">!lambda</span> return min ( max( id(led_ring).current_values.get_brightness() <span class="token punctuation">,</span> 0.2f ) + 0.1f <span class="token punctuation">,</span> 1.0f );
</span><span class="code-line">          <span class="token key atrule">id</span><span class="token punctuation">:</span> voice_assistant_leds
</span><span class="code-line">          <span class="token key atrule">effect</span><span class="token punctuation">:</span> <span class="token string">&quot;Center Button Touched&quot;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token comment"># Script executed when the timer is ringing, to control the LEDs</span>
</span><span class="code-line">  <span class="token comment"># The LED ring blinks.</span>
</span><span class="code-line">  <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> control_leds_timer_ringing
</span><span class="code-line">    <span class="token key atrule">then</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">light.turn_on</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">brightness</span><span class="token punctuation">:</span> <span class="token tag">!lambda</span> return min ( max( id(led_ring).current_values.get_brightness() <span class="token punctuation">,</span> 0.2f ) + 0.1f <span class="token punctuation">,</span> 1.0f );
</span><span class="code-line">          <span class="token key atrule">id</span><span class="token punctuation">:</span> voice_assistant_leds
</span><span class="code-line">          <span class="token key atrule">effect</span><span class="token punctuation">:</span> <span class="token string">&quot;Timer Ring&quot;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token comment"># Script executed when the timer is ticking, to control the LEDs</span>
</span><span class="code-line">  <span class="token comment"># The LEDs shows the remaining time as a fraction of the full ring.</span>
</span><span class="code-line">  <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> control_leds_timer_ticking
</span><span class="code-line">    <span class="token key atrule">then</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">light.turn_on</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">brightness</span><span class="token punctuation">:</span> <span class="token tag">!lambda</span> return max( id(led_ring).current_values.get_brightness() <span class="token punctuation">,</span> 0.2f );
</span><span class="code-line">          <span class="token key atrule">id</span><span class="token punctuation">:</span> voice_assistant_leds
</span><span class="code-line">          <span class="token key atrule">effect</span><span class="token punctuation">:</span> <span class="token string">&quot;Timer tick&quot;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token comment"># Script executed when the volume is increased/decreased from the dial</span>
</span><span class="code-line">  <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> control_volume
</span><span class="code-line">    <span class="token key atrule">mode</span><span class="token punctuation">:</span> restart
</span><span class="code-line">    <span class="token key atrule">parameters</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token key atrule">increase_volume</span><span class="token punctuation">:</span> bool  <span class="token comment"># True: Increase volume / False: Decrease volume.</span>
</span><span class="code-line">    <span class="token key atrule">then</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">delay</span><span class="token punctuation">:</span> 16ms
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">if</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">condition</span><span class="token punctuation">:</span>
</span><span class="code-line">            <span class="token key atrule">lambda</span><span class="token punctuation">:</span> return increase_volume;
</span><span class="code-line">          <span class="token key atrule">then</span><span class="token punctuation">:</span>
</span><span class="code-line">            <span class="token punctuation">-</span> <span class="token key atrule">media_player.volume_up</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">else</span><span class="token punctuation">:</span>
</span><span class="code-line">            <span class="token punctuation">-</span> <span class="token key atrule">media_player.volume_down</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">script.execute</span><span class="token punctuation">:</span> control_leds
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">delay</span><span class="token punctuation">:</span> 1s
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">lambda</span><span class="token punctuation">:</span> id(dial_touched) = false;
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">script.execute</span><span class="token punctuation">:</span> control_leds
</span><span class="code-line">
</span><span class="code-line">  <span class="token comment"># Script executed when the hue is increased/decreased from the dial</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token comment"># Script executed when the timer is ringing, to playback sounds.</span>
</span><span class="code-line">  <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> ring_timer
</span><span class="code-line">    <span class="token key atrule">then</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">script.execute</span><span class="token punctuation">:</span> enable_repeat_one
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">script.execute</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">id</span><span class="token punctuation">:</span> play_sound
</span><span class="code-line">          <span class="token key atrule">priority</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
</span><span class="code-line">          <span class="token key atrule">sound_file</span><span class="token punctuation">:</span> <span class="token tag">!lambda</span> return id(timer_finished_sound);
</span><span class="code-line">
</span><span class="code-line">  <span class="token comment"># Script executed when the timer is ringing, to repeat the timer finished sound.</span>
</span><span class="code-line">  <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> enable_repeat_one
</span><span class="code-line">    <span class="token key atrule">then</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token comment"># Turn on the repeat mode and pause for 500 ms between playlist items/repeats</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">lambda</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token punctuation">-</span>
</span><span class="code-line">            id(external_media_player)
</span><span class="code-line">              <span class="token punctuation">-</span><span class="token punctuation">&gt;</span>make_call()
</span><span class="code-line">              .set_command(media_player<span class="token punctuation">:</span><span class="token punctuation">:</span>MediaPlayerCommand<span class="token punctuation">:</span><span class="token punctuation">:</span>MEDIA_PLAYER_COMMAND_REPEAT_ONE)
</span><span class="code-line">              .set_announcement(true)
</span><span class="code-line">              .perform();
</span><span class="code-line">            id(external_media_player)<span class="token punctuation">-</span><span class="token punctuation">&gt;</span>set_playlist_delay_ms(speaker<span class="token punctuation">:</span><span class="token punctuation">:</span>AudioPipelineType<span class="token punctuation">:</span><span class="token punctuation">:</span>ANNOUNCEMENT<span class="token punctuation">,</span> 500);
</span><span class="code-line">
</span><span class="code-line">  <span class="token comment"># Script execute when the timer is done ringing, to disable repeat mode.</span>
</span><span class="code-line">  <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> disable_repeat
</span><span class="code-line">    <span class="token key atrule">then</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token comment"># Turn off the repeat mode and pause for 0 ms between playlist items/repeats</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">lambda</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token punctuation">-</span>
</span><span class="code-line">            id(external_media_player)
</span><span class="code-line">              <span class="token punctuation">-</span><span class="token punctuation">&gt;</span>make_call()
</span><span class="code-line">              .set_command(media_player<span class="token punctuation">:</span><span class="token punctuation">:</span>MediaPlayerCommand<span class="token punctuation">:</span><span class="token punctuation">:</span>MEDIA_PLAYER_COMMAND_REPEAT_OFF)
</span><span class="code-line">              .set_announcement(true)
</span><span class="code-line">              .perform();
</span><span class="code-line">            id(external_media_player)<span class="token punctuation">-</span><span class="token punctuation">&gt;</span>set_playlist_delay_ms(speaker<span class="token punctuation">:</span><span class="token punctuation">:</span>AudioPipelineType<span class="token punctuation">:</span><span class="token punctuation">:</span>ANNOUNCEMENT<span class="token punctuation">,</span> 0);
</span><span class="code-line">
</span><span class="code-line">  <span class="token comment"># Script executed when we want to play sounds on the device.</span>
</span><span class="code-line">  <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> play_sound
</span><span class="code-line">    <span class="token key atrule">parameters</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token key atrule">priority</span><span class="token punctuation">:</span> bool
</span><span class="code-line">      <span class="token key atrule">sound_file</span><span class="token punctuation">:</span> <span class="token string">&quot;audio::AudioFile*&quot;</span>
</span><span class="code-line">    <span class="token key atrule">then</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">lambda</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token punctuation">-</span>
</span><span class="code-line">          if (priority) <span class="token punctuation">{</span>
</span><span class="code-line">            id(external_media_player)
</span><span class="code-line">              <span class="token punctuation">-</span><span class="token punctuation">&gt;</span>make_call()
</span><span class="code-line">              .set_command(media_player<span class="token punctuation">:</span><span class="token punctuation">:</span>MediaPlayerCommand<span class="token punctuation">:</span><span class="token punctuation">:</span>MEDIA_PLAYER_COMMAND_STOP)
</span><span class="code-line">              .set_announcement(true)
</span><span class="code-line">              .perform();
</span><span class="code-line">          <span class="token punctuation">}</span>
</span><span class="code-line">          if ( (id(external_media_player).state <span class="token tag">!=</span> media_player<span class="token punctuation">:</span><span class="token punctuation">:</span>MediaPlayerState<span class="token punctuation">:</span><span class="token punctuation">:</span>MEDIA_PLAYER_STATE_ANNOUNCING ) <span class="token punctuation">|</span><span class="token punctuation">|</span> priority) <span class="token punctuation">{</span>
</span><span class="code-line">            id(external_media_player)
</span><span class="code-line">              <span class="token punctuation">-</span><span class="token punctuation">&gt;</span>play_file(sound_file<span class="token punctuation">,</span> <span class="token boolean important">true</span><span class="token punctuation">,</span> false);
</span><span class="code-line">          <span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token comment"># Script used to fetch the first active timer (Stored in global first_active_timer)</span>
</span><span class="code-line">  <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> fetch_first_active_timer
</span><span class="code-line">    <span class="token key atrule">then</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">lambda</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token scalar string">
</span></span><span class="code-line"><span class="token scalar string">          const auto timers = id(va).get_timers();
</span></span><span class="code-line"><span class="token scalar string">          auto output_timer = timers.begin()-&gt;second;
</span></span><span class="code-line"><span class="token scalar string">          for (auto &amp;iterable_timer : timers) {
</span></span><span class="code-line"><span class="token scalar string">            if (iterable_timer.second.is_active &amp;&amp; iterable_timer.second.seconds_left &lt;= output_timer.seconds_left) {
</span></span><span class="code-line"><span class="token scalar string">              output_timer = iterable_timer.second;
</span></span><span class="code-line"><span class="token scalar string">            }
</span></span><span class="code-line"><span class="token scalar string">          }
</span></span><span class="code-line"><span class="token scalar string">          id(first_active_timer) = output_timer;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token comment"># Script used to check if a timer is active (Stored in global is_timer_active)</span>
</span><span class="code-line">  <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> check_if_timers_active
</span><span class="code-line">    <span class="token key atrule">then</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">lambda</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token scalar string">
</span></span><span class="code-line"><span class="token scalar string">          const auto timers = id(va).get_timers();
</span></span><span class="code-line"><span class="token scalar string">          bool output = false;
</span></span><span class="code-line"><span class="token scalar string">          if (timers.size() &gt; 0) {
</span></span><span class="code-line"><span class="token scalar string">            for (auto &amp;iterable_timer : timers) {
</span></span><span class="code-line"><span class="token scalar string">              if(iterable_timer.second.is_active) {
</span></span><span class="code-line"><span class="token scalar string">                output = true;
</span></span><span class="code-line"><span class="token scalar string">              }
</span></span><span class="code-line"><span class="token scalar string">            }
</span></span><span class="code-line"><span class="token scalar string">          }
</span></span><span class="code-line"><span class="token scalar string">          id(is_timer_active) = output;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token comment"># Script used activate the stop word if the TTS step is long.</span>
</span><span class="code-line">  <span class="token comment"># Why is this wrapped on a script?</span>
</span><span class="code-line">  <span class="token comment">#   Becasue we want to stop the sequence if the TTS step is faster than that.</span>
</span><span class="code-line">  <span class="token comment">#   This allows us to prevent having the deactivation of the stop word before its own activation.</span>
</span><span class="code-line">  <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> activate_stop_word_once
</span><span class="code-line">    <span class="token key atrule">then</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">delay</span><span class="token punctuation">:</span> 1s
</span><span class="code-line">      <span class="token comment"># Enable stop wake word</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">if</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">condition</span><span class="token punctuation">:</span>
</span><span class="code-line">            <span class="token key atrule">switch.is_off</span><span class="token punctuation">:</span> timer_ringing
</span><span class="code-line">          <span class="token key atrule">then</span><span class="token punctuation">:</span>
</span><span class="code-line">            <span class="token punctuation">-</span> <span class="token key atrule">micro_wake_word.enable_model</span><span class="token punctuation">:</span> stop
</span><span class="code-line">            <span class="token punctuation">-</span> <span class="token key atrule">wait_until</span><span class="token punctuation">:</span>
</span><span class="code-line">                <span class="token key atrule">not</span><span class="token punctuation">:</span>
</span><span class="code-line">                  <span class="token key atrule">media_player.is_announcing</span><span class="token punctuation">:</span>
</span><span class="code-line">            <span class="token punctuation">-</span> <span class="token key atrule">if</span><span class="token punctuation">:</span>
</span><span class="code-line">                <span class="token key atrule">condition</span><span class="token punctuation">:</span>
</span><span class="code-line">                  <span class="token key atrule">switch.is_off</span><span class="token punctuation">:</span> timer_ringing
</span><span class="code-line">                <span class="token key atrule">then</span><span class="token punctuation">:</span>
</span><span class="code-line">                  <span class="token punctuation">-</span> <span class="token key atrule">micro_wake_word.disable_model</span><span class="token punctuation">:</span> stop
</span><span class="code-line">
</span><span class="code-line"><span class="token key atrule">i2s_audio</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> i2s_output
</span><span class="code-line">    <span class="token comment"># i2s_output data pin is gpio10</span>
</span><span class="code-line">    <span class="token key atrule">i2s_lrclk_pin</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token key atrule">number</span><span class="token punctuation">:</span> GPIO6
</span><span class="code-line">    <span class="token key atrule">i2s_bclk_pin</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token key atrule">number</span><span class="token punctuation">:</span> GPIO7
</span><span class="code-line">
</span><span class="code-line">  <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> i2s_input
</span><span class="code-line">    <span class="token comment"># data line is GPIO15</span>
</span><span class="code-line">    <span class="token key atrule">i2s_lrclk_pin</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token key atrule">number</span><span class="token punctuation">:</span> GPIO3
</span><span class="code-line">    <span class="token key atrule">i2s_bclk_pin</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token key atrule">number</span><span class="token punctuation">:</span> GPIO2
</span><span class="code-line">
</span><span class="code-line"><span class="token key atrule">microphone</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token punctuation">-</span> <span class="token key atrule">platform</span><span class="token punctuation">:</span> i2s_audio
</span><span class="code-line">    <span class="token key atrule">id</span><span class="token punctuation">:</span> i2s_mics
</span><span class="code-line">    <span class="token key atrule">i2s_din_pin</span><span class="token punctuation">:</span> GPIO4
</span><span class="code-line">    <span class="token key atrule">adc_type</span><span class="token punctuation">:</span> external
</span><span class="code-line">    <span class="token key atrule">pdm</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
</span><span class="code-line">    <span class="token comment"># sample_rate: 16000</span>
</span><span class="code-line">    <span class="token key atrule">bits_per_sample</span><span class="token punctuation">:</span> 32bit
</span><span class="code-line">    <span class="token comment"># i2s_mode: secondary</span>
</span><span class="code-line">    <span class="token key atrule">i2s_audio_id</span><span class="token punctuation">:</span> i2s_input
</span><span class="code-line">    <span class="token key atrule">channel</span><span class="token punctuation">:</span> left
</span><span class="code-line">
</span><span class="code-line"><span class="token key atrule">speaker</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token comment"># Hardware speaker output</span>
</span><span class="code-line">  <span class="token punctuation">-</span> <span class="token key atrule">platform</span><span class="token punctuation">:</span> i2s_audio
</span><span class="code-line">    <span class="token key atrule">id</span><span class="token punctuation">:</span> i2s_audio_speaker
</span><span class="code-line">    <span class="token key atrule">sample_rate</span><span class="token punctuation">:</span> <span class="token number">48000</span>
</span><span class="code-line">    <span class="token comment"># i2s_mode: secondary</span>
</span><span class="code-line">    <span class="token key atrule">i2s_dout_pin</span><span class="token punctuation">:</span> GPIO8
</span><span class="code-line">    <span class="token key atrule">bits_per_sample</span><span class="token punctuation">:</span> 32bit
</span><span class="code-line">    <span class="token key atrule">i2s_audio_id</span><span class="token punctuation">:</span> i2s_output
</span><span class="code-line">    <span class="token key atrule">dac_type</span><span class="token punctuation">:</span> external
</span><span class="code-line">    <span class="token key atrule">channel</span><span class="token punctuation">:</span> stereo
</span><span class="code-line">    <span class="token key atrule">timeout</span><span class="token punctuation">:</span> never
</span><span class="code-line">    <span class="token key atrule">buffer_duration</span><span class="token punctuation">:</span> 100ms
</span><span class="code-line">    <span class="token comment"># audio_dac: aic3204_dac</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token comment"># Virtual speakers to combine the announcement and media streams together into one output</span>
</span><span class="code-line">  <span class="token punctuation">-</span> <span class="token key atrule">platform</span><span class="token punctuation">:</span> mixer
</span><span class="code-line">    <span class="token key atrule">id</span><span class="token punctuation">:</span> mixing_speaker
</span><span class="code-line">    <span class="token key atrule">output_speaker</span><span class="token punctuation">:</span> i2s_audio_speaker
</span><span class="code-line">    <span class="token key atrule">num_channels</span><span class="token punctuation">:</span> <span class="token number">2</span>
</span><span class="code-line">    <span class="token key atrule">source_speakers</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> announcement_mixing_input
</span><span class="code-line">        <span class="token key atrule">timeout</span><span class="token punctuation">:</span> never
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> media_mixing_input
</span><span class="code-line">        <span class="token key atrule">timeout</span><span class="token punctuation">:</span> never
</span><span class="code-line">
</span><span class="code-line">  <span class="token comment"># Vritual speakers to resample each pipelines&#x27; audio, if necessary, as the mixer speaker requires the same sample rate</span>
</span><span class="code-line">  <span class="token punctuation">-</span> <span class="token key atrule">platform</span><span class="token punctuation">:</span> resampler
</span><span class="code-line">    <span class="token key atrule">id</span><span class="token punctuation">:</span> announcement_resampling_speaker
</span><span class="code-line">    <span class="token key atrule">output_speaker</span><span class="token punctuation">:</span> announcement_mixing_input
</span><span class="code-line">    <span class="token key atrule">sample_rate</span><span class="token punctuation">:</span> <span class="token number">48000</span>
</span><span class="code-line">    <span class="token key atrule">bits_per_sample</span><span class="token punctuation">:</span> <span class="token number">16</span>
</span><span class="code-line">  <span class="token punctuation">-</span> <span class="token key atrule">platform</span><span class="token punctuation">:</span> resampler
</span><span class="code-line">    <span class="token key atrule">id</span><span class="token punctuation">:</span> media_resampling_speaker
</span><span class="code-line">    <span class="token key atrule">output_speaker</span><span class="token punctuation">:</span> media_mixing_input
</span><span class="code-line">    <span class="token key atrule">sample_rate</span><span class="token punctuation">:</span> <span class="token number">48000</span>
</span><span class="code-line">    <span class="token key atrule">bits_per_sample</span><span class="token punctuation">:</span> <span class="token number">16</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token key atrule">media_player</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token punctuation">-</span> <span class="token key atrule">platform</span><span class="token punctuation">:</span> speaker
</span><span class="code-line">    <span class="token key atrule">id</span><span class="token punctuation">:</span> external_media_player
</span><span class="code-line">    <span class="token key atrule">name</span><span class="token punctuation">:</span> Media Player
</span><span class="code-line">    <span class="token key atrule">internal</span><span class="token punctuation">:</span> <span class="token boolean important">False</span>
</span><span class="code-line">    <span class="token key atrule">volume_increment</span><span class="token punctuation">:</span> <span class="token number">0.05</span>
</span><span class="code-line">    <span class="token key atrule">volume_min</span><span class="token punctuation">:</span> <span class="token number">0.4</span>
</span><span class="code-line">    <span class="token key atrule">volume_max</span><span class="token punctuation">:</span> <span class="token number">0.85</span>
</span><span class="code-line">    <span class="token key atrule">announcement_pipeline</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token key atrule">speaker</span><span class="token punctuation">:</span> announcement_resampling_speaker
</span><span class="code-line">      <span class="token key atrule">format</span><span class="token punctuation">:</span> FLAC     <span class="token comment"># FLAC is the least processor intensive codec</span>
</span><span class="code-line">      <span class="token key atrule">num_channels</span><span class="token punctuation">:</span> <span class="token number">1</span>  <span class="token comment"># Stereo audio is unnecessary for announcements</span>
</span><span class="code-line">      <span class="token key atrule">sample_rate</span><span class="token punctuation">:</span> <span class="token number">48000</span>
</span><span class="code-line">    <span class="token key atrule">media_pipeline</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token key atrule">speaker</span><span class="token punctuation">:</span> media_resampling_speaker
</span><span class="code-line">      <span class="token key atrule">format</span><span class="token punctuation">:</span> FLAC     <span class="token comment"># FLAC is the least processor intensive codec</span>
</span><span class="code-line">      <span class="token key atrule">num_channels</span><span class="token punctuation">:</span> <span class="token number">2</span>
</span><span class="code-line">      <span class="token key atrule">sample_rate</span><span class="token punctuation">:</span> <span class="token number">48000</span>
</span><span class="code-line">    <span class="token key atrule">on_mute</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">script.execute</span><span class="token punctuation">:</span> control_leds
</span><span class="code-line">    <span class="token key atrule">on_unmute</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">script.execute</span><span class="token punctuation">:</span> control_leds
</span><span class="code-line">    <span class="token key atrule">on_volume</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">script.execute</span><span class="token punctuation">:</span> control_leds
</span><span class="code-line">    <span class="token key atrule">on_announcement</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">mixer_speaker.apply_ducking</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">id</span><span class="token punctuation">:</span> media_mixing_input
</span><span class="code-line">          <span class="token key atrule">decibel_reduction</span><span class="token punctuation">:</span> <span class="token number">20</span>
</span><span class="code-line">          <span class="token key atrule">duration</span><span class="token punctuation">:</span> 0.0s
</span><span class="code-line">    <span class="token key atrule">on_state</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token key atrule">if</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token key atrule">condition</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">and</span><span class="token punctuation">:</span>
</span><span class="code-line">            <span class="token punctuation">-</span> <span class="token key atrule">switch.is_off</span><span class="token punctuation">:</span> timer_ringing
</span><span class="code-line">            <span class="token punctuation">-</span> <span class="token key atrule">not</span><span class="token punctuation">:</span>
</span><span class="code-line">                <span class="token key atrule">voice_assistant.is_running</span><span class="token punctuation">:</span>
</span><span class="code-line">            <span class="token punctuation">-</span> <span class="token key atrule">not</span><span class="token punctuation">:</span>
</span><span class="code-line">                <span class="token key atrule">media_player.is_announcing</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token key atrule">then</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token punctuation">-</span> <span class="token key atrule">mixer_speaker.apply_ducking</span><span class="token punctuation">:</span>
</span><span class="code-line">              <span class="token key atrule">id</span><span class="token punctuation">:</span> media_mixing_input
</span><span class="code-line">              <span class="token key atrule">decibel_reduction</span><span class="token punctuation">:</span> <span class="token number">0</span>
</span><span class="code-line">              <span class="token key atrule">duration</span><span class="token punctuation">:</span> 1.0s
</span><span class="code-line">    <span class="token key atrule">files</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> center_button_press_sound
</span><span class="code-line">        <span class="token key atrule">file</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span>center_button_press_sound_file<span class="token punctuation">}</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> center_button_double_press_sound
</span><span class="code-line">        <span class="token key atrule">file</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span>center_button_double_press_sound_file<span class="token punctuation">}</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> center_button_triple_press_sound
</span><span class="code-line">        <span class="token key atrule">file</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span>center_button_triple_press_sound_file<span class="token punctuation">}</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> center_button_long_press_sound
</span><span class="code-line">        <span class="token key atrule">file</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span>center_button_long_press_sound_file<span class="token punctuation">}</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> factory_reset_initiated_sound
</span><span class="code-line">        <span class="token key atrule">file</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//github.com/esphome/home<span class="token punctuation">-</span>assistant<span class="token punctuation">-</span>voice<span class="token punctuation">-</span>pe/raw/dev/sounds/factory_reset_initiated.mp3
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> factory_reset_cancelled_sound
</span><span class="code-line">        <span class="token key atrule">file</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//github.com/esphome/home<span class="token punctuation">-</span>assistant<span class="token punctuation">-</span>voice<span class="token punctuation">-</span>pe/raw/dev/sounds/factory_reset_cancelled.mp3
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> factory_reset_confirmed_sound
</span><span class="code-line">        <span class="token key atrule">file</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//github.com/esphome/home<span class="token punctuation">-</span>assistant<span class="token punctuation">-</span>voice<span class="token punctuation">-</span>pe/raw/dev/sounds/factory_reset_confirmed.mp3
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> jack_connected_sound
</span><span class="code-line">        <span class="token key atrule">file</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span>jack_connected_sound_file<span class="token punctuation">}</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> jack_disconnected_sound
</span><span class="code-line">        <span class="token key atrule">file</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span>jack_disconnected_sound_file<span class="token punctuation">}</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> mute_switch_on_sound
</span><span class="code-line">        <span class="token key atrule">file</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span>mute_switch_on_sound_file<span class="token punctuation">}</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> mute_switch_off_sound
</span><span class="code-line">        <span class="token key atrule">file</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span>mute_switch_off_sound_file<span class="token punctuation">}</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> timer_finished_sound
</span><span class="code-line">        <span class="token key atrule">file</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span>timer_finished_sound_file<span class="token punctuation">}</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> wake_word_triggered_sound
</span><span class="code-line">        <span class="token key atrule">file</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span>wake_word_triggered_sound_file<span class="token punctuation">}</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> easter_egg_tick_sound
</span><span class="code-line">        <span class="token key atrule">file</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//github.com/esphome/home<span class="token punctuation">-</span>assistant<span class="token punctuation">-</span>voice<span class="token punctuation">-</span>pe/raw/dev/sounds/easter_egg_tick.mp3
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> easter_egg_tada_sound
</span><span class="code-line">        <span class="token key atrule">file</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//github.com/esphome/home<span class="token punctuation">-</span>assistant<span class="token punctuation">-</span>voice<span class="token punctuation">-</span>pe/raw/dev/sounds/easter_egg_tada.mp3
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> error_cloud_expired
</span><span class="code-line">        <span class="token key atrule">file</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//github.com/esphome/home<span class="token punctuation">-</span>assistant<span class="token punctuation">-</span>voice<span class="token punctuation">-</span>pe/raw/dev/sounds/error_cloud_expired.mp3
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="token key atrule">external_components</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token punctuation">-</span> <span class="token key atrule">source</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token key atrule">type</span><span class="token punctuation">:</span> git
</span><span class="code-line">      <span class="token key atrule">url</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//github.com/esphome/home<span class="token punctuation">-</span>assistant<span class="token punctuation">-</span>voice<span class="token punctuation">-</span>pe
</span><span class="code-line">      <span class="token key atrule">ref</span><span class="token punctuation">:</span> dev
</span><span class="code-line">    <span class="token key atrule">components</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token punctuation">-</span> voice_kit
</span><span class="code-line">    <span class="token key atrule">refresh</span><span class="token punctuation">:</span> 0s
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="token key atrule">micro_wake_word</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token key atrule">id</span><span class="token punctuation">:</span> mww
</span><span class="code-line">  <span class="token key atrule">microphone</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token key atrule">microphone</span><span class="token punctuation">:</span> i2s_mics
</span><span class="code-line">    <span class="token key atrule">channels</span><span class="token punctuation">:</span> <span class="token number">0</span>
</span><span class="code-line">    <span class="token key atrule">gain_factor</span><span class="token punctuation">:</span> <span class="token number">4</span>
</span><span class="code-line">  <span class="token key atrule">stop_after_detection</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
</span><span class="code-line">  <span class="token key atrule">models</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token punctuation">-</span> <span class="token key atrule">model</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//github.com/kahrendt/microWakeWord/releases/download/okay_nabu_20241226.3/okay_nabu.json
</span><span class="code-line">      <span class="token key atrule">id</span><span class="token punctuation">:</span> okay_nabu
</span><span class="code-line">    <span class="token punctuation">-</span> <span class="token key atrule">model</span><span class="token punctuation">:</span> hey_jarvis
</span><span class="code-line">      <span class="token key atrule">id</span><span class="token punctuation">:</span> hey_jarvis
</span><span class="code-line">    <span class="token punctuation">-</span> <span class="token key atrule">model</span><span class="token punctuation">:</span> hey_mycroft
</span><span class="code-line">      <span class="token key atrule">id</span><span class="token punctuation">:</span> hey_mycroft
</span><span class="code-line">    <span class="token punctuation">-</span> <span class="token key atrule">model</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//github.com/kahrendt/microWakeWord/releases/download/stop/stop.json
</span><span class="code-line">      <span class="token key atrule">id</span><span class="token punctuation">:</span> stop
</span><span class="code-line">      <span class="token key atrule">internal</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
</span><span class="code-line">  <span class="token key atrule">vad</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token key atrule">on_wake_word_detected</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token comment"># If the wake word is detected when the device is muted (Possible with the software mute switch): Do nothing</span>
</span><span class="code-line">    <span class="token punctuation">-</span> <span class="token key atrule">if</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token key atrule">condition</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">switch.is_off</span><span class="token punctuation">:</span> master_mute_switch
</span><span class="code-line">        <span class="token key atrule">then</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token comment"># If a timer is ringing: Stop it, do not start the voice assistant (We can stop timer from voice!)</span>
</span><span class="code-line">          <span class="token punctuation">-</span> <span class="token key atrule">if</span><span class="token punctuation">:</span>
</span><span class="code-line">              <span class="token key atrule">condition</span><span class="token punctuation">:</span>
</span><span class="code-line">                <span class="token key atrule">switch.is_on</span><span class="token punctuation">:</span> timer_ringing
</span><span class="code-line">              <span class="token key atrule">then</span><span class="token punctuation">:</span>
</span><span class="code-line">                <span class="token punctuation">-</span> <span class="token key atrule">switch.turn_off</span><span class="token punctuation">:</span> timer_ringing
</span><span class="code-line">              <span class="token comment"># Stop voice assistant if running</span>
</span><span class="code-line">              <span class="token key atrule">else</span><span class="token punctuation">:</span>
</span><span class="code-line">                <span class="token punctuation">-</span> <span class="token key atrule">if</span><span class="token punctuation">:</span>
</span><span class="code-line">                    <span class="token key atrule">condition</span><span class="token punctuation">:</span>
</span><span class="code-line">                      <span class="token key atrule">voice_assistant.is_running</span><span class="token punctuation">:</span>
</span><span class="code-line">                    <span class="token key atrule">then</span><span class="token punctuation">:</span>
</span><span class="code-line">                      <span class="token key atrule">voice_assistant.stop</span><span class="token punctuation">:</span>
</span><span class="code-line">                    <span class="token comment"># Stop any other media player announcement</span>
</span><span class="code-line">                    <span class="token key atrule">else</span><span class="token punctuation">:</span>
</span><span class="code-line">                      <span class="token punctuation">-</span> <span class="token key atrule">if</span><span class="token punctuation">:</span>
</span><span class="code-line">                          <span class="token key atrule">condition</span><span class="token punctuation">:</span>
</span><span class="code-line">                            <span class="token key atrule">media_player.is_announcing</span><span class="token punctuation">:</span>
</span><span class="code-line">                          <span class="token key atrule">then</span><span class="token punctuation">:</span>
</span><span class="code-line">                            <span class="token punctuation">-</span> <span class="token key atrule">media_player.stop</span><span class="token punctuation">:</span>
</span><span class="code-line">                                <span class="token key atrule">announcement</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
</span><span class="code-line">                          <span class="token comment"># Start the voice assistant and play the wake sound, if enabled</span>
</span><span class="code-line">                          <span class="token key atrule">else</span><span class="token punctuation">:</span>
</span><span class="code-line">                            <span class="token punctuation">-</span> <span class="token key atrule">if</span><span class="token punctuation">:</span>
</span><span class="code-line">                                <span class="token key atrule">condition</span><span class="token punctuation">:</span>
</span><span class="code-line">                                  <span class="token key atrule">switch.is_on</span><span class="token punctuation">:</span> wake_sound
</span><span class="code-line">                                <span class="token key atrule">then</span><span class="token punctuation">:</span>
</span><span class="code-line">                                  <span class="token punctuation">-</span> <span class="token key atrule">script.execute</span><span class="token punctuation">:</span>
</span><span class="code-line">                                      <span class="token key atrule">id</span><span class="token punctuation">:</span> play_sound
</span><span class="code-line">                                      <span class="token key atrule">priority</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
</span><span class="code-line">                                      <span class="token key atrule">sound_file</span><span class="token punctuation">:</span> <span class="token tag">!lambda</span> return id(wake_word_triggered_sound);
</span><span class="code-line">                                  <span class="token punctuation">-</span> <span class="token key atrule">delay</span><span class="token punctuation">:</span> 300ms
</span><span class="code-line">                            <span class="token punctuation">-</span> <span class="token key atrule">voice_assistant.start</span><span class="token punctuation">:</span>
</span><span class="code-line">                                <span class="token key atrule">wake_word</span><span class="token punctuation">:</span> <span class="token tag">!lambda</span> return wake_word;
</span><span class="code-line">
</span><span class="code-line"><span class="token key atrule">select</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token punctuation">-</span> <span class="token key atrule">platform</span><span class="token punctuation">:</span> template
</span><span class="code-line">    <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">&quot;Wake word sensitivity&quot;</span>
</span><span class="code-line">    <span class="token key atrule">optimistic</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
</span><span class="code-line">    <span class="token key atrule">initial_option</span><span class="token punctuation">:</span> Slightly sensitive
</span><span class="code-line">    <span class="token key atrule">restore_value</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
</span><span class="code-line">    <span class="token key atrule">entity_category</span><span class="token punctuation">:</span> config
</span><span class="code-line">    <span class="token key atrule">options</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token punctuation">-</span> Slightly sensitive
</span><span class="code-line">      <span class="token punctuation">-</span> Moderately sensitive
</span><span class="code-line">      <span class="token punctuation">-</span> Very sensitive
</span><span class="code-line">    <span class="token key atrule">on_value</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token comment"># Sets specific wake word probabilities computed for each particular model</span>
</span><span class="code-line">      <span class="token comment"># Note probability cutoffs are set as a quantized uint8 value, each comment has the corresponding floating point cutoff</span>
</span><span class="code-line">      <span class="token comment"># False Accepts per Hour values are tested against all units and channels from the Dinner Party Corpus.</span>
</span><span class="code-line">      <span class="token comment"># These cutoffs apply only to the specific models included in the firmware: okay_nabu@20241226.3, hey_jarvis@v2, hey_mycroft@v2</span>
</span><span class="code-line">      <span class="token key atrule">lambda</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token punctuation">-</span>
</span><span class="code-line">        if (x == &quot;Slightly sensitive&quot;) <span class="token punctuation">{</span>
</span><span class="code-line">          id(okay_nabu).set_probability_cutoff(217);    // 0.85 <span class="token punctuation">-</span><span class="token punctuation">&gt;</span> 0.000 FAPH on DipCo (Manifest&#x27;s default)
</span><span class="code-line">          id(hey_jarvis).set_probability_cutoff(247);   // 0.97 <span class="token punctuation">-</span><span class="token punctuation">&gt;</span> 0.563 FAPH on DipCo (Manifest&#x27;s default)
</span><span class="code-line">          id(hey_mycroft).set_probability_cutoff(253);  // 0.99 <span class="token punctuation">-</span><span class="token punctuation">&gt;</span> 0.567 FAPH on DipCo
</span><span class="code-line">        <span class="token punctuation">}</span> else if (x == &quot;Moderately sensitive&quot;) <span class="token punctuation">{</span>
</span><span class="code-line">          id(okay_nabu).set_probability_cutoff(176);    // 0.69 <span class="token punctuation">-</span><span class="token punctuation">&gt;</span> 0.376 FAPH on DipCo
</span><span class="code-line">          id(hey_jarvis).set_probability_cutoff(235);   // 0.92 <span class="token punctuation">-</span><span class="token punctuation">&gt;</span> 0.939 FAPH on DipCo
</span><span class="code-line">          id(hey_mycroft).set_probability_cutoff(242);  // 0.95 <span class="token punctuation">-</span><span class="token punctuation">&gt;</span> 1.502 FAPH on DipCo (Manifest&#x27;s default)
</span><span class="code-line">        <span class="token punctuation">}</span> else if (x == &quot;Very sensitive&quot;) <span class="token punctuation">{</span>
</span><span class="code-line">          id(okay_nabu).set_probability_cutoff(143);    // 0.56 <span class="token punctuation">-</span><span class="token punctuation">&gt;</span> 0.751 FAPH on DipCo
</span><span class="code-line">          id(hey_jarvis).set_probability_cutoff(212);   // 0.83 <span class="token punctuation">-</span><span class="token punctuation">&gt;</span> 1.502 FAPH on DipCo
</span><span class="code-line">          id(hey_mycroft).set_probability_cutoff(237);  // 0.93 <span class="token punctuation">-</span><span class="token punctuation">&gt;</span> 1.878 FAPH on DipCo
</span><span class="code-line">        <span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token key atrule">voice_assistant</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token key atrule">id</span><span class="token punctuation">:</span> va
</span><span class="code-line">  <span class="token key atrule">microphone</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token key atrule">microphone</span><span class="token punctuation">:</span> i2s_mics
</span><span class="code-line">    <span class="token key atrule">channels</span><span class="token punctuation">:</span> <span class="token number">0</span>
</span><span class="code-line">  <span class="token key atrule">media_player</span><span class="token punctuation">:</span> external_media_player
</span><span class="code-line">  <span class="token key atrule">micro_wake_word</span><span class="token punctuation">:</span> mww
</span><span class="code-line">  <span class="token key atrule">use_wake_word</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
</span><span class="code-line">  <span class="token key atrule">noise_suppression_level</span><span class="token punctuation">:</span> <span class="token number">0</span>
</span><span class="code-line">  <span class="token key atrule">auto_gain</span><span class="token punctuation">:</span> 0 dbfs
</span><span class="code-line">  <span class="token key atrule">volume_multiplier</span><span class="token punctuation">:</span> <span class="token number">1</span>
</span><span class="code-line">  <span class="token key atrule">on_client_connected</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token punctuation">-</span> <span class="token key atrule">lambda</span><span class="token punctuation">:</span> id(init_in_progress) = false;
</span><span class="code-line">    <span class="token punctuation">-</span> <span class="token key atrule">micro_wake_word.start</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token punctuation">-</span> <span class="token key atrule">lambda</span><span class="token punctuation">:</span> id(voice_assistant_phase) = $<span class="token punctuation">{</span>voice_assist_idle_phase_id<span class="token punctuation">}</span>;
</span><span class="code-line">    <span class="token punctuation">-</span> <span class="token key atrule">script.execute</span><span class="token punctuation">:</span> control_leds
</span><span class="code-line">  <span class="token key atrule">on_client_disconnected</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token punctuation">-</span> <span class="token key atrule">voice_assistant.stop</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token punctuation">-</span> <span class="token key atrule">lambda</span><span class="token punctuation">:</span> id(voice_assistant_phase) = $<span class="token punctuation">{</span>voice_assist_not_ready_phase_id<span class="token punctuation">}</span>;
</span><span class="code-line">    <span class="token punctuation">-</span> <span class="token key atrule">script.execute</span><span class="token punctuation">:</span> control_leds
</span><span class="code-line">  <span class="token key atrule">on_error</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token comment"># Only set the error phase if the error code is different than duplicate_wake_up_detected or stt-no-text-recognized</span>
</span><span class="code-line">    <span class="token comment"># These two are ignored for a better user experience</span>
</span><span class="code-line">    <span class="token punctuation">-</span> <span class="token key atrule">if</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token key atrule">condition</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">and</span><span class="token punctuation">:</span>
</span><span class="code-line">            <span class="token punctuation">-</span> <span class="token key atrule">lambda</span><span class="token punctuation">:</span> return <span class="token tag">!id(init_in_progress);</span>
</span><span class="code-line">            <span class="token punctuation">-</span> <span class="token key atrule">lambda</span><span class="token punctuation">:</span> return code <span class="token tag">!=</span> &quot;duplicate_wake_up_detected&quot;;
</span><span class="code-line">            <span class="token punctuation">-</span> <span class="token key atrule">lambda</span><span class="token punctuation">:</span> return code <span class="token tag">!=</span> &quot;stt<span class="token punctuation">-</span>no<span class="token punctuation">-</span>text<span class="token punctuation">-</span>recognized&quot;;
</span><span class="code-line">        <span class="token key atrule">then</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token punctuation">-</span> <span class="token key atrule">lambda</span><span class="token punctuation">:</span> id(voice_assistant_phase) = $<span class="token punctuation">{</span>voice_assist_error_phase_id<span class="token punctuation">}</span>;
</span><span class="code-line">          <span class="token punctuation">-</span> <span class="token key atrule">script.execute</span><span class="token punctuation">:</span> control_leds
</span><span class="code-line">    <span class="token comment"># If the error code is cloud-auth-failed, serve a local audio file guiding the user.</span>
</span><span class="code-line">    <span class="token punctuation">-</span> <span class="token key atrule">if</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token key atrule">condition</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token punctuation">-</span> <span class="token key atrule">lambda</span><span class="token punctuation">:</span> return code == &quot;cloud<span class="token punctuation">-</span>auth<span class="token punctuation">-</span>failed&quot;;
</span><span class="code-line">        <span class="token key atrule">then</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token punctuation">-</span> <span class="token key atrule">script.execute</span><span class="token punctuation">:</span>
</span><span class="code-line">              <span class="token key atrule">id</span><span class="token punctuation">:</span> play_sound
</span><span class="code-line">              <span class="token key atrule">priority</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
</span><span class="code-line">              <span class="token key atrule">sound_file</span><span class="token punctuation">:</span> <span class="token tag">!lambda</span> return id(error_cloud_expired);
</span><span class="code-line">  <span class="token comment"># When the voice assistant starts: Play a wake up sound, duck audio.</span>
</span><span class="code-line">  <span class="token key atrule">on_start</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token punctuation">-</span> <span class="token key atrule">mixer_speaker.apply_ducking</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token key atrule">id</span><span class="token punctuation">:</span> media_mixing_input
</span><span class="code-line">        <span class="token key atrule">decibel_reduction</span><span class="token punctuation">:</span> <span class="token number">20</span>  <span class="token comment"># Number of dB quieter; higher implies more quiet, 0 implies full volume</span>
</span><span class="code-line">        <span class="token key atrule">duration</span><span class="token punctuation">:</span> 0.0s         <span class="token comment"># The duration of the transition (default is no transition)</span>
</span><span class="code-line">  <span class="token key atrule">on_listening</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token punctuation">-</span> <span class="token key atrule">lambda</span><span class="token punctuation">:</span> id(voice_assistant_phase) = $<span class="token punctuation">{</span>voice_assist_waiting_for_command_phase_id<span class="token punctuation">}</span>;
</span><span class="code-line">    <span class="token punctuation">-</span> <span class="token key atrule">script.execute</span><span class="token punctuation">:</span> control_leds
</span><span class="code-line">  <span class="token key atrule">on_stt_vad_start</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token punctuation">-</span> <span class="token key atrule">lambda</span><span class="token punctuation">:</span> id(voice_assistant_phase) = $<span class="token punctuation">{</span>voice_assist_listening_for_command_phase_id<span class="token punctuation">}</span>;
</span><span class="code-line">    <span class="token punctuation">-</span> <span class="token key atrule">script.execute</span><span class="token punctuation">:</span> control_leds
</span><span class="code-line">  <span class="token key atrule">on_stt_vad_end</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token punctuation">-</span> <span class="token key atrule">lambda</span><span class="token punctuation">:</span> id(voice_assistant_phase) = $<span class="token punctuation">{</span>voice_assist_thinking_phase_id<span class="token punctuation">}</span>;
</span><span class="code-line">    <span class="token punctuation">-</span> <span class="token key atrule">script.execute</span><span class="token punctuation">:</span> control_leds
</span><span class="code-line">  <span class="token key atrule">on_intent_progress</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token punctuation">-</span> <span class="token key atrule">if</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token key atrule">condition</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token comment"># A nonempty x variable means a streaming TTS url was sent to the media player</span>
</span><span class="code-line">          <span class="token key atrule">lambda</span><span class="token punctuation">:</span> <span class="token string">&#x27;return !x.empty();&#x27;</span>
</span><span class="code-line">        <span class="token key atrule">then</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token punctuation">-</span> <span class="token key atrule">lambda</span><span class="token punctuation">:</span> id(voice_assistant_phase) = $<span class="token punctuation">{</span>voice_assist_replying_phase_id<span class="token punctuation">}</span>;
</span><span class="code-line">          <span class="token punctuation">-</span> <span class="token key atrule">script.execute</span><span class="token punctuation">:</span> control_leds
</span><span class="code-line">          <span class="token comment"># Start a script that would potentially enable the stop word if the response is longer than a second</span>
</span><span class="code-line">          <span class="token punctuation">-</span> <span class="token key atrule">script.execute</span><span class="token punctuation">:</span> activate_stop_word_once
</span><span class="code-line">  <span class="token key atrule">on_tts_start</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token punctuation">-</span> <span class="token key atrule">if</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token key atrule">condition</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token comment"># The intent_progress trigger didn&#x27;t start the TTS Reponse</span>
</span><span class="code-line">          <span class="token key atrule">lambda</span><span class="token punctuation">:</span> <span class="token string">&#x27;return id(voice_assistant_phase) != ${voice_assist_replying_phase_id};&#x27;</span>
</span><span class="code-line">        <span class="token key atrule">then</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token punctuation">-</span> <span class="token key atrule">lambda</span><span class="token punctuation">:</span> id(voice_assistant_phase) = $<span class="token punctuation">{</span>voice_assist_replying_phase_id<span class="token punctuation">}</span>;
</span><span class="code-line">          <span class="token punctuation">-</span> <span class="token key atrule">script.execute</span><span class="token punctuation">:</span> control_leds
</span><span class="code-line">          <span class="token comment"># Start a script that would potentially enable the stop word if the response is longer than a second</span>
</span><span class="code-line">          <span class="token punctuation">-</span> <span class="token key atrule">script.execute</span><span class="token punctuation">:</span> activate_stop_word_once
</span><span class="code-line">  <span class="token comment"># When the voice assistant ends ...</span>
</span><span class="code-line">  <span class="token key atrule">on_end</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token punctuation">-</span> <span class="token key atrule">wait_until</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token key atrule">not</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">voice_assistant.is_running</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token comment"># Stop ducking audio.</span>
</span><span class="code-line">    <span class="token punctuation">-</span> <span class="token key atrule">mixer_speaker.apply_ducking</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token key atrule">id</span><span class="token punctuation">:</span> media_mixing_input
</span><span class="code-line">        <span class="token key atrule">decibel_reduction</span><span class="token punctuation">:</span> <span class="token number">0</span>
</span><span class="code-line">        <span class="token key atrule">duration</span><span class="token punctuation">:</span> 1.0s
</span><span class="code-line">    <span class="token comment"># If the end happened because of an error, let the error phase on for a second</span>
</span><span class="code-line">    <span class="token punctuation">-</span> <span class="token key atrule">if</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token key atrule">condition</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">lambda</span><span class="token punctuation">:</span> return id(voice_assistant_phase) == $<span class="token punctuation">{</span>voice_assist_error_phase_id<span class="token punctuation">}</span>;
</span><span class="code-line">        <span class="token key atrule">then</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token punctuation">-</span> <span class="token key atrule">delay</span><span class="token punctuation">:</span> 1s
</span><span class="code-line">    <span class="token comment"># Reset the voice assistant phase id and reset the LED animations.</span>
</span><span class="code-line">    <span class="token punctuation">-</span> <span class="token key atrule">lambda</span><span class="token punctuation">:</span> id(voice_assistant_phase) = $<span class="token punctuation">{</span>voice_assist_idle_phase_id<span class="token punctuation">}</span>;
</span><span class="code-line">    <span class="token punctuation">-</span> <span class="token key atrule">script.execute</span><span class="token punctuation">:</span> control_leds
</span><span class="code-line">  <span class="token key atrule">on_timer_finished</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token punctuation">-</span> <span class="token key atrule">switch.turn_on</span><span class="token punctuation">:</span> timer_ringing
</span><span class="code-line">  <span class="token key atrule">on_timer_started</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token punctuation">-</span> <span class="token key atrule">script.execute</span><span class="token punctuation">:</span> control_leds
</span><span class="code-line">  <span class="token key atrule">on_timer_cancelled</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token punctuation">-</span> <span class="token key atrule">script.execute</span><span class="token punctuation">:</span> control_leds
</span><span class="code-line">  <span class="token key atrule">on_timer_updated</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token punctuation">-</span> <span class="token key atrule">script.execute</span><span class="token punctuation">:</span> control_leds
</span><span class="code-line">  <span class="token key atrule">on_timer_tick</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token punctuation">-</span> <span class="token key atrule">script.execute</span><span class="token punctuation">:</span> control_leds
</span><span class="code-line">
</span><span class="code-line"><span class="token key atrule">button</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token punctuation">-</span> <span class="token key atrule">platform</span><span class="token punctuation">:</span> factory_reset
</span><span class="code-line">    <span class="token key atrule">id</span><span class="token punctuation">:</span> factory_reset_button
</span><span class="code-line">    <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">&quot;Factory Reset&quot;</span>
</span><span class="code-line">    <span class="token key atrule">entity_category</span><span class="token punctuation">:</span> diagnostic
</span><span class="code-line">    <span class="token key atrule">internal</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
</span><span class="code-line">  <span class="token punctuation">-</span> <span class="token key atrule">platform</span><span class="token punctuation">:</span> restart
</span><span class="code-line">    <span class="token key atrule">id</span><span class="token punctuation">:</span> restart_button
</span><span class="code-line">    <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">&quot;Restart&quot;</span>
</span><span class="code-line">    <span class="token key atrule">entity_category</span><span class="token punctuation">:</span> config
</span><span class="code-line">    <span class="token key atrule">disabled_by_default</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
</span><span class="code-line">    <span class="token key atrule">icon</span><span class="token punctuation">:</span> <span class="token string">&quot;mdi:restart&quot;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token key atrule">debug</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token key atrule">update_interval</span><span class="token punctuation">:</span> 5s
</span></code></pre></div>
<p><strong>Important:</strong> You need to set the PSRAM mode to octal or quad depending on the type of the board by referring to <a target="_blank" rel="noopener noreferrer" href="https://docs.espressif.com/projects/esp-idf/en/stable/esp32s3/hw-reference/esp32s3/user-guide-devkitc-1.html#ordering-information">this</a> link.</p>
<p><strong>Step 6</strong>: click on “<strong>Save</strong>” and then click on “<strong>Install</strong>” on the top right-hand corner.</p>
<p><strong>Step 7</strong>: Now, click on the “<strong>Manual Download</strong>” option and then choose “<strong>Modern Format</strong>”.</p>
<p><strong>Step 8</strong>: Save the file to your computer.</p>
<p><strong>Step 9</strong>: Open <a target="_blank" rel="noopener noreferrer" href="https://web.esphome.io">https://web.esphome.io</a>. in Chrome or Edge browser.</p>
<p><strong>Step 10</strong>: Now connect the ESP32 S3 dev Board to the laptop and click on “<strong>Connect</strong>” and you should get a popup window like this.</p>
<div><img alt="3-select-usb.webp" loading="lazy" width="567" height="247" decoding="async" data-nimg="1" style="color:transparent" src="/static/images/2023/esp32-voice-assistant/3-select-usb.webp"/></div>
<p><strong>Step 11</strong>: Select the USB serial port for your device and click on “<strong>Install</strong>”</p>
<p><strong>Step 12</strong>: Now load the file you saved in <strong>Step 8</strong> and click on “<strong>Install</strong>”.</p>
<div><img alt="4-erasing.webp" loading="lazy" width="314" height="227" decoding="async" data-nimg="1" style="color:transparent" src="/static/images/2023/esp32-voice-assistant/4-erasing.webp"/></div>
<blockquote>
<p><strong>Note:</strong> In case the board does not go from connecting to erasing after some time, you can try to put the device into flashing mode. For this, press and hold the <strong>Boot</strong> button, then the <strong>Reset</strong> button, leave the <strong>Reset</strong> button, and then finally leave the <strong>Boot</strong> button.</p>
</blockquote>
<p>With this, you have now prepared your ESP32 S3 to start receiving a voice command after detecting the Wake Word.</p>
<p>Next, we will connect it to Home Assistant.</p>
<h2 id="connecting-esp32-s3-as-voice-assistant-in-home-assistant"><a href="#connecting-esp32-s3-as-voice-assistant-in-home-assistant" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Connecting ESP32 S3 As Voice Assistant In Home Assistant</h2>
<p>Once the ESP32 S3 is flashed with the code in the above section, we will connect it to Home Assistant using the ESPHome Integration.</p>
<p>For this, follow these steps.</p>
<p><strong>Step 1</strong>: Click “<strong>Settings</strong>” in Home Assistant in the left panel.</p>
<p><strong>Step 2</strong>: Click on “<strong>Devices &amp; Services</strong>”</p>
<p>Now, if the device is already auto-discovered, you can click on “<strong>Configure</strong>” and with this, the device is connected to Home Assistant.</p>
<p>If the device is not auto-discovered, then</p>
<p><strong>Step 3</strong>: Click on “<strong>Add Integration</strong>” in the bottom right-hand corner.</p>
<p><strong>Step 4</strong>: Search for “<strong>ESPhome</strong>” and click on it.</p>
<p><strong>Step 5</strong>: Add the IP address of your ESP32 S3 board that is connected to your WiFi. Keep the port number as <strong>6053</strong> and click “<strong>Submit</strong>”</p>
<div><img alt="5-esp32-connect-home-assistant.webp" loading="lazy" width="431" height="320" decoding="async" data-nimg="1" style="color:transparent" src="/static/images/2023/esp32-voice-assistant/5-esp32-connect-home-assistant.webp"/></div>
<p><strong>Step 6</strong>: If you are asked to enter the encryption key then you can find that in ESPHome under the property <code>api: encryption: key</code>. Copy and paste the key in the window.</p>
<p>With this, you are now done setting up the ESP32 S3 with On-Device Wake Word detection for your Voice Assistant connected to Home Assistant.</p>
<ul>
<li><a target="_blank" rel="noopener noreferrer" href="https://smarthomecircle.com/connect-bluetooth-devices-to-home-assistant-with-bluetooth-proxy"><strong>Connect Bluetooth Devices to Home Assistant with Bluetooth Proxy</strong></a></li>
<li><a target="_blank" rel="noopener noreferrer" href="https://smarthomecircle.com/how-to-connect-led-strip-with-home-assistant-using-wled"><strong>Control LED Strip with Home Assistant Using WLED</strong></a></li>
<li><a target="_blank" rel="noopener noreferrer" href="https://smarthomecircle.com/how-to-connect-wifi-to-home-assistant-on-startup"><strong>Connect Home Assistant to the WIFI on First Boot</strong></a></li>
</ul><div class="not-prose mt-8 pt-6 border-t border-gray-200 dark:border-gray-700"><div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 p-4 bg-gray-50 dark:bg-gray-800/30 rounded-lg"><h3 class="text-sm font-medium text-gray-700 dark:text-gray-300 flex-shrink-0">Share this article:</h3><div class="flex flex-wrap gap-2"><button type="button" class="text-white bg-[#3b5998] hover:bg-[#3b5998]/90 font-medium rounded-md text-xs px-3 py-1.5 inline-flex items-center transition-colors" title="Share on Facebook"><svg class="w-3 h-3 mr-1.5" aria-hidden="true" focusable="false" data-prefix="fab" data-icon="facebook-f" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="fill-current"><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"></path></svg></svg>Share</button><button type="button" class="text-white bg-[#1da1f2] hover:bg-[#1da1f2]/90 font-medium rounded-md text-xs px-3 py-1.5 inline-flex items-center transition-colors" title="Share on Twitter"><svg class="w-3 h-3 mr-1.5" aria-hidden="true" focusable="false" data-prefix="fab" data-icon="twitter" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="fill-current"><path d="M23.953 4.57a10 10 0 0 1-2.825.775 4.958 4.958 0 0 0 2.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 0 0-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 0 0-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 0 1-2.228-.616v.06a4.923 4.923 0 0 0 3.946 4.827 4.996 4.996 0 0 1-2.212.085 4.936 4.936 0 0 0 4.604 3.417 9.867 9.867 0 0 1-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 0 0 7.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0 0 24 4.59z"></path></svg></svg>Tweet</button><button type="button" class="text-white bg-[#0077B5] hover:bg-[#00A0DC]/90 font-medium rounded-md text-xs px-3 py-1.5 inline-flex items-center transition-colors" title="Share on LinkedIn"><svg class="w-3 h-3 mr-1.5" aria-hidden="true" focusable="false" data-prefix="fab" data-icon="linkedin" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="fill-current"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.062 2.062 0 0 1-2.063-2.065 2.064 2.064 0 1 1 2.063 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"></path></svg></svg>Post</button><button type="button" class="text-white bg-gray-600 hover:bg-gray-700 font-medium rounded-md text-xs px-3 py-1.5 inline-flex items-center transition-colors" title="Share via Email"><svg class="w-3 h-3 mr-1.5" aria-hidden="true" focusable="false" data-prefix="fab" data-icon="email" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="fill-current"><path d="M2.003 5.884 10 9.882l7.997-3.998A2 2 0 0 0 16 4H4a2 2 0 0 0-1.997 1.884z"></path><path d="m18 8.118-8 4-8-4V14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8.118z"></path></svg></svg>Email</button></div></div></div></div></div><div class="lg:col-span-4 mt-12 lg:mt-0"><div class="space-y-8"><div class="bg-white dark:bg-gray-800 rounded-2xl p-6 shadow-lg border border-gray-200 dark:border-gray-700"><h3 class="text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4">Tags</h3><div class="flex flex-wrap gap-2"><a class="m-1 p-1 px-2 leading-4 h-6 rounded text-xs uppercase text-white font-bold bg-teal-500 hover:bg-teal-400 dark:hover:bg-teal-500 dark:bg-teal-600" href="/tags/wake-word">Wake Word</a><a class="m-1 p-1 px-2 leading-4 h-6 rounded text-xs uppercase text-white font-bold bg-teal-500 hover:bg-teal-400 dark:hover:bg-teal-500 dark:bg-teal-600" href="/tags/micro-wake-word">Micro Wake Word</a><a class="m-1 p-1 px-2 leading-4 h-6 rounded text-xs uppercase text-white font-bold bg-teal-500 hover:bg-teal-400 dark:hover:bg-teal-500 dark:bg-teal-600" href="/tags/esp32">ESP32</a><a class="m-1 p-1 px-2 leading-4 h-6 rounded text-xs uppercase text-white font-bold bg-teal-500 hover:bg-teal-400 dark:hover:bg-teal-500 dark:bg-teal-600" href="/tags/voice-assistant">Voice Assistant</a><a class="m-1 p-1 px-2 leading-4 h-6 rounded text-xs uppercase text-white font-bold bg-teal-500 hover:bg-teal-400 dark:hover:bg-teal-500 dark:bg-teal-600" href="/tags/home-assistant">Home Assistant</a></div></div><div class="bg-gradient-to-br from-primary-50 to-primary-100 dark:from-primary-900/20 dark:to-primary-800/20 rounded-2xl p-6 border border-primary-200 dark:border-primary-800"><a class="flex items-center text-primary-600 hover:text-primary-700 dark:text-primary-400 dark:hover:text-primary-300 font-semibold transition-colors group" href="/"><svg class="w-5 h-5 mr-2 transform group-hover:-translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg>Back to Articles</a></div></div></div></div></div></article></div></main><footer><div class="flex flex-col items-center mt-16"><div class="flex mb-3 space-x-4"><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="mailto:contactsmarthomecircle@gmail.com"><span class="sr-only">mail</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="fill-current text-gray-700 dark:text-gray-200 hover:text-blue-500 dark:hover:text-blue-400 h-6 w-6"><path d="M2.003 5.884 10 9.882l7.997-3.998A2 2 0 0 0 16 4H4a2 2 0 0 0-1.997 1.884z"></path><path d="m18 8.118-8 4-8-4V14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8.118z"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://www.youtube.com/@SmartHomeCircle"><span class="sr-only">youtube</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="fill-current text-gray-700 dark:text-gray-200 hover:text-blue-500 dark:hover:text-blue-400 h-6 w-6"><path d="M23.499 6.203a3.008 3.008 0 0 0-2.089-2.089c-1.87-.501-9.4-.501-9.4-.501s-7.509-.01-9.399.501a3.008 3.008 0 0 0-2.088 2.09A31.258 31.26 0 0 0 0 12.01a31.258 31.26 0 0 0 .523 5.785 3.008 3.008 0 0 0 2.088 2.089c1.869.502 9.4.502 9.4.502s7.508 0 9.399-.502a3.008 3.008 0 0 0 2.089-2.09 31.258 31.26 0 0 0 .5-5.784 31.258 31.26 0 0 0-.5-5.808zm-13.891 9.4V8.407l6.266 3.604z"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://twitter.com/smarthomecircle"><span class="sr-only">twitter</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="fill-current text-gray-700 dark:text-gray-200 hover:text-blue-500 dark:hover:text-blue-400 h-6 w-6"><path d="M23.953 4.57a10 10 0 0 1-2.825.775 4.958 4.958 0 0 0 2.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 0 0-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 0 0-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 0 1-2.228-.616v.06a4.923 4.923 0 0 0 3.946 4.827 4.996 4.996 0 0 1-2.212.085 4.936 4.936 0 0 0 4.604 3.417 9.867 9.867 0 0 1-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 0 0 7.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0 0 24 4.59z"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://bsky.app/profile/smarthomecircle.com"><span class="sr-only">blueSky</span><svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" class="fill-current text-gray-700 dark:text-gray-200 hover:text-blue-500 dark:hover:text-blue-400 h-6 w-6"><path d="M12 10.8c-1.087-2.114-4.046-6.053-6.798-7.995C2.566.944 1.561 1.266.902 1.565.139 1.908 0 3.08 0 3.768c0 .69.378 5.65.624 6.479.815 2.736 3.713 3.66 6.383 3.364.136-.02.275-.039.415-.056-.138.022-.276.04-.415.056-3.912.58-7.387 2.005-2.83 7.078 5.013 5.19 6.87-1.113 7.823-4.308.953 3.195 2.05 9.271 7.733 4.308 4.267-4.308 1.172-6.498-2.74-7.078a8.741 8.741 0 0 1-.415-.056c.14.017.279.036.415.056 2.67.297 5.568-.628 6.383-3.364.246-.828.624-5.79.624-6.478 0-.69-.139-1.861-.902-2.206-.659-.298-1.664-.62-4.3 1.24C16.046 4.748 13.087 8.687 12 10.8Z"></path></svg></a></div><div class="flex mb-2 space-x-2 text-sm text-gray-500 dark:text-gray-400"><div>Amrut Prabhu</div><div> • </div><div>© 2025</div><div> • </div><a href="/">Smart Home Circle</a><div> • </div><a href="/privacy">Privacy Policy</a></div><br/></div></footer></div></div><div class="max-w-3xl px-4 mx-auto sm:px-6 xl:max-w-6xl xl:px-0"><div id="cookie-notice" class="consent_consentname__W_12w"><br/><br/><p>By clicking “I Accept”, you agree to the storing of cookies on your device to enhance site navigation and analyze site usage</p><br/><br/><div><a id="cookie-notice-accept" class="consent_greenButton__rKcAp">I Accept</a><a href="/privacy">Privacy Policy</a></div><br/><br/><br/></div></div></div><script id="__NEXT_DATA__" type="application/json" crossorigin="">{"props":{"pageProps":{"post":{"mdxSource":"var Component=(()=\u003e{var u=Object.create;var i=Object.defineProperty;var N=Object.getOwnPropertyDescriptor;var k=Object.getOwnPropertyNames;var _=Object.getPrototypeOf,y=Object.prototype.hasOwnProperty;var p=a=\u003ei(a,\"__esModule\",{value:!0});var g=(a,s)=\u003e()=\u003e(s||a((s={exports:{}}).exports,s),s.exports),f=(a,s)=\u003e{p(a);for(var c in s)i(a,c,{get:s[c],enumerable:!0})},b=(a,s,c)=\u003e{if(s\u0026\u0026typeof s==\"object\"||typeof s==\"function\")for(let e of k(s))!y.call(a,e)\u0026\u0026e!==\"default\"\u0026\u0026i(a,e,{get:()=\u003es[e],enumerable:!(c=N(s,e))||c.enumerable});return a},v=a=\u003eb(p(i(a!=null?u(_(a)):{},\"default\",a\u0026\u0026a.__esModule\u0026\u0026\"default\"in a?{get:()=\u003ea.default,enumerable:!0}:{value:a,enumerable:!0})),a);var h=g((C,m)=\u003e{m.exports=_jsx_runtime});var A={};f(A,{default:()=\u003eS,frontmatter:()=\u003ew});var n=v(h()),w={title:\"How I Created My Voice Assistant With On-Device Wake Word Detection On ESP32 Using Micro Wake Word\",author:\"Amrut Prabhu\",categories:\"\",tags:[\"Wake Word\",\"Micro Wake Word\",\"ESP32\",\"Voice Assistant\",\"Home Assistant\"],\"photo-credits\":null,\"applaud-link\":\"2021/spring-boot-stream-kafka.json\",date:\"2024-05-23\",draft:!1,autoAds:!0,summary:\"In this article, we will look at how I created my Voice Assistant with an ESP32 S3 with on-device Wake Word detection using MicroWake Word to send commands to Home Assistant\",imageUrl:\"/static/images/2024/created-my-voice-assistant/cover.webp\",actualUrl:\"auto-generated\",customUrl:\"auto-generated\",youtubeLink:\"https://www.youtube.com/embed/aPP2alIU7Gg\"};function x(a={}){let{wrapper:s}=a.components||{};return s?(0,n.jsx)(s,Object.assign({},a,{children:(0,n.jsx)(c,{})})):c();function c(){let e=Object.assign({p:\"p\",h2:\"h2\",a:\"a\",span:\"span\",ol:\"ol\",li:\"li\",strong:\"strong\",br:\"br\",img:\"img\",div:\"div\",table:\"table\",thead:\"thead\",tr:\"tr\",th:\"th\",tbody:\"tbody\",td:\"td\",blockquote:\"blockquote\",pre:\"pre\",code:\"code\",ul:\"ul\"},a.components),{TOCInline:r,AffiliateLinks:t,VideoEmbed:d,Image:l}=e;return t||o(\"AffiliateLinks\",!0),l||o(\"Image\",!0),r||o(\"TOCInline\",!0),d||o(\"VideoEmbed\",!0),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(e.p,{children:\"In this article, we will look at how I created my voice Assistant with On-Device Wake Word detection on an ESP32 S3 using MicroWake Word to send commands to Home Assistant.\"}),`\n`,(0,n.jsx)(r,{toc:a.toc,asDisclosure:!0}),`\n`,(0,n.jsxs)(e.h2,{id:\"requirements\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#requirements\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Requirements\"]}),`\n`,(0,n.jsxs)(e.ol,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Home Assistant\"}),\" up and running.\",(0,n.jsx)(e.br,{}),`\n`,\"You can check \",(0,n.jsx)(e.a,{href:\"https://smarthomecircle.com/how-to-connect-wifi-to-home-assistant-on-startup\",children:\"this\"}),\" link to see how you can install it for the first time\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"ESPHome\"}),\" is setup and running\",(0,n.jsx)(e.br,{}),`\n`,\"In case you have not set it up, you can look at it \",(0,n.jsx)(e.a,{href:\"https://smarthomecircle.com/esp32-esp8266-esphome-with-home-assistant\",children:\"here\"}),\".\"]}),`\n`,(0,n.jsx)(e.li,{children:(0,n.jsx)(e.strong,{children:\"ESP32 S3 N8R2 or N16R8 Dev Board\"})}),`\n`]}),`\n`,(0,n.jsx)(e.p,{children:(0,n.jsx)(e.a,{href:\"https://s.click.aliexpress.com/e/_DFopt57\",children:(0,n.jsx)(e.img,{src:\"/static/images/components/esp32-s3-n8r2.webp\",alt:\"ESP32 S3 \"})})}),`\n`,(0,n.jsx)(t,{title:\"\",links:[{store:\"AliExpress\",url:\"https://s.click.aliexpress.com/e/_DFopt57\"},{store:\"Amazon\",url:\"https://amzn.to/3xnA8ax\"}]}),`\n`,(0,n.jsxs)(e.p,{children:[\"Guide for ordering ESP32 S3 N8R2 or N16R8 Board is \",(0,n.jsx)(e.a,{href:\"https://docs.espressif.com/projects/esp-idf/en/stable/esp32s3/hw-reference/esp32s3/user-guide-devkitc-1.html#ordering-information\",children:\"here\"})]}),`\n`,(0,n.jsx)(\"br\",{}),`\n`,(0,n.jsxs)(e.ol,{start:\"4\",children:[`\n`,(0,n.jsx)(e.li,{children:(0,n.jsx)(e.strong,{children:\"INMP441 Microphone\"})}),`\n`]}),`\n`,(0,n.jsx)(e.p,{children:(0,n.jsx)(e.a,{href:\"https://s.click.aliexpress.com/e/_Dmn2PyR\",children:(0,n.jsx)(e.img,{src:\"/static/images/2023/esp32-voice-assistant/inmp441-microphone.webp\",alt:\"INMP441 MICROPHONE\"})})}),`\n`,(0,n.jsx)(t,{title:\"\",links:[{store:\"AliExpress\",url:\"https://s.click.aliexpress.com/e/_Dmn2PyR\"},{store:\"Amazon\",url:\"https://amzn.to/3GdxO7o\"}]}),`\n`,(0,n.jsx)(\"br\",{}),`\n`,(0,n.jsxs)(e.ol,{start:\"5\",children:[`\n`,(0,n.jsx)(e.li,{children:(0,n.jsx)(e.strong,{children:\"MAX98357A Audio Amplifier\"})}),`\n`]}),`\n`,(0,n.jsx)(e.p,{children:(0,n.jsx)(e.a,{href:\"https://s.click.aliexpress.com/e/_DdyIFTH\",children:(0,n.jsx)(e.img,{src:\"/static/images/2023/esp32-voice-assistant/MAX98357A.webp\",alt:\"MAX98357A\"})})}),`\n`,(0,n.jsx)(t,{title:\"\",links:[{store:\"AliExpress\",url:\"https://s.click.aliexpress.com/e/_DdyIFTH\"},{store:\"Amazon\",url:\"https://amzn.to/46wKTmW\"}]}),`\n`,(0,n.jsx)(\"br\",{}),`\n`,(0,n.jsxs)(e.ol,{start:\"6\",children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"3-watt Speakers\"}),\" (Optional: Only required to listen to the pipeline output)\"]}),`\n`]}),`\n`,(0,n.jsx)(e.p,{children:(0,n.jsx)(e.a,{href:\"https://s.click.aliexpress.com/e/_DBDIScT\",children:(0,n.jsx)(e.img,{src:\"/static/images/2023/esp32-voice-assistant/3-watt-speakers.webp\",alt:\"3 watt speaker\"})})}),`\n`,(0,n.jsx)(t,{title:\"\",links:[{store:\"AliExpress\",url:\"https://s.click.aliexpress.com/e/_DBDIScT\"},{store:\"Amazon\",url:\"https://amzn.to/49BbAJR\"}]}),`\n`,(0,n.jsxs)(e.ol,{start:\"7\",children:[`\n`,(0,n.jsx)(e.li,{children:(0,n.jsx)(e.strong,{children:\"COB 5mm WS2812B LED Strip\"})}),`\n`]}),`\n`,(0,n.jsx)(e.p,{children:(0,n.jsx)(e.a,{href:\"https://s.click.aliexpress.com/e/_DDtD9SP\",children:(0,n.jsx)(e.img,{src:\"/static/images/components/Ws2812b-cob-led-strip.webp\",alt:\"WS2812B LED Strip\"})})}),`\n`,(0,n.jsx)(t,{title:\"\",links:[{store:\"AliExpress\",url:\"https://s.click.aliexpress.com/e/_DDtD9SP\"},{store:\"Amazon\",url:\"https://amzn.to/3yqR7t7\"}]}),`\n`,(0,n.jsxs)(e.h2,{id:\"3d-print-template-for-voice-assistant-case\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#3d-print-template-for-voice-assistant-case\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"3D Print Template For Voice Assistant Case\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"You can find the link \",(0,n.jsx)(e.a,{href:\"https://www.thingiverse.com/thing:6631205\",children:\"here\"}),\" to the STL file for 3D printing the case and the cover.\"]}),`\n`,(0,n.jsxs)(e.h2,{id:\"set-up-voice-assist-pipeline\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#set-up-voice-assist-pipeline\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Set up Voice Assist Pipeline\"]}),`\n`,(0,n.jsx)(e.p,{children:\"To set up voice assistant, we would need two components to create the Voice Assist pipeline in Home Assistant.\"}),`\n`,(0,n.jsxs)(e.ol,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Whisper\"}),\": For speech-to-text\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Piper\"}),\": For text-to-speech\"]}),`\n`]}),`\n`,(0,n.jsx)(e.p,{children:\"Now, following the below video, you have set up these components in Home Assistant using Addons.\"}),`\n`,(0,n.jsx)(d,{videoId:\"P4V2JqCmk7M\",title:\"Setting up Voice Assistant in Home Assistant\",width:\"half\"}),`\n`,(0,n.jsx)(e.p,{children:\"You will get to see how to set up the following components that are required\"}),`\n`,(0,n.jsxs)(e.ol,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Whisper\"}),\" Addon\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Piper\"}),\" Addon\"]}),`\n`,(0,n.jsxs)(e.li,{children:[\"And finally the entire \",(0,n.jsx)(e.strong,{children:\"Voice Assist\"}),\" pipeline.\"]}),`\n`]}),`\n`,(0,n.jsx)(e.p,{children:\"You don't need to set up the Wake Word addon, as we will use the on-device Wake Word detection with the Micro Wake Word framework\"}),`\n`,(0,n.jsxs)(e.p,{children:[\"So make sure to watch it and set up the \",(0,n.jsx)(e.strong,{children:\"Voice Assist\"}),\" pipeline\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Now we will look at how we can prepare our ESP32 S3 with a microphone and 3-watt speakers.\"}),`\n`,(0,n.jsxs)(e.h2,{id:\"circuit-diagram-for-esp32-s3-with-inmp441-microphone--max98357a-audio-amplifier\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#circuit-diagram-for-esp32-s3-with-inmp441-microphone--max98357a-audio-amplifier\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Circuit Diagram for ESP32 S3 With INMP441 Microphone \u0026 MAX98357A Audio Amplifier\"]}),`\n`,(0,n.jsx)(e.div,{children:(0,n.jsx)(l,{alt:\"esp32-wiring-diagram.webp\",src:\"/static/images/2024/created-my-voice-assistant/circuit-diagram.webp\",width:\"1375\",height:\"1426\"})}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Important:\"}),\" You need to connect the 5v pads as shown in the diagram to enable 5v output on the 5v pin.\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Here is the pin mapping table\"}),`\n`,(0,n.jsxs)(e.table,{children:[(0,n.jsx)(e.thead,{children:(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.th,{children:\"ESP32 S3 N8R2 or N16R8\"}),(0,n.jsx)(e.th,{children:\"INMP441 Microphone\"}),(0,n.jsx)(e.th,{children:\"Speaker\"}),(0,n.jsx)(e.th,{children:\"LED Strip WS2812B\"}),(0,n.jsx)(e.th,{children:\"Mute Switch\"})]})}),(0,n.jsxs)(e.tbody,{children:[(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:\"GND\"}),(0,n.jsx)(e.td,{}),(0,n.jsx)(e.td,{}),(0,n.jsx)(e.td,{}),(0,n.jsx)(e.td,{children:\"switch pin 1\"})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:\"GPIO 10\"}),(0,n.jsx)(e.td,{}),(0,n.jsx)(e.td,{}),(0,n.jsx)(e.td,{}),(0,n.jsx)(e.td,{children:\"switch pin 2\"})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:\"GND\"}),(0,n.jsx)(e.td,{}),(0,n.jsx)(e.td,{children:\"Gnd\"}),(0,n.jsx)(e.td,{}),(0,n.jsx)(e.td,{})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:\"GPIO 6\"}),(0,n.jsx)(e.td,{}),(0,n.jsx)(e.td,{children:\"LRC\"}),(0,n.jsx)(e.td,{}),(0,n.jsx)(e.td,{})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:\"GPIO 7\"}),(0,n.jsx)(e.td,{}),(0,n.jsx)(e.td,{children:\"BLCK\"}),(0,n.jsx)(e.td,{}),(0,n.jsx)(e.td,{})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:\"GPIO 8\"}),(0,n.jsx)(e.td,{}),(0,n.jsx)(e.td,{children:\"DIN\"}),(0,n.jsx)(e.td,{}),(0,n.jsx)(e.td,{})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:\"3v3\"}),(0,n.jsx)(e.td,{}),(0,n.jsx)(e.td,{children:\"Vin\"}),(0,n.jsx)(e.td,{}),(0,n.jsx)(e.td,{})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:\"GPIO 4\"}),(0,n.jsx)(e.td,{children:\"SD\"}),(0,n.jsx)(e.td,{}),(0,n.jsx)(e.td,{}),(0,n.jsx)(e.td,{})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:\"GPIO 3\"}),(0,n.jsx)(e.td,{children:\"WS\"}),(0,n.jsx)(e.td,{}),(0,n.jsx)(e.td,{}),(0,n.jsx)(e.td,{})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:\"GPIO 2\"}),(0,n.jsx)(e.td,{children:\"SCK\"}),(0,n.jsx)(e.td,{}),(0,n.jsx)(e.td,{}),(0,n.jsx)(e.td,{})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:\"3v3\"}),(0,n.jsx)(e.td,{children:\"VDD\"}),(0,n.jsx)(e.td,{}),(0,n.jsx)(e.td,{}),(0,n.jsx)(e.td,{})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:\"GND\"}),(0,n.jsx)(e.td,{children:\"GND \u0026 L/R\"}),(0,n.jsx)(e.td,{}),(0,n.jsx)(e.td,{}),(0,n.jsx)(e.td,{})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:\"GND\"}),(0,n.jsx)(e.td,{}),(0,n.jsx)(e.td,{}),(0,n.jsx)(e.td,{children:\"GND\"}),(0,n.jsx)(e.td,{})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:\"GPIO 9\"}),(0,n.jsx)(e.td,{}),(0,n.jsx)(e.td,{}),(0,n.jsx)(e.td,{children:\"Din\"}),(0,n.jsx)(e.td,{})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:\"Vin (5v)\"}),(0,n.jsx)(e.td,{}),(0,n.jsx)(e.td,{}),(0,n.jsx)(e.td,{children:\"Vin\"}),(0,n.jsx)(e.td,{})]})]})]}),`\n`,(0,n.jsx)(e.p,{children:\"Once you have connected the microphone and the audio amplifier, let\\u2019s look at the code we must flash to the ESP32 S3 using ESPHome.\"}),`\n`,(0,n.jsxs)(e.h2,{id:\"flashing-code-to-esp32-s3-with-esphome\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#flashing-code-to-esp32-s3-with-esphome\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Flashing Code to ESP32 S3 with ESPHome\"]}),`\n`,(0,n.jsxs)(e.blockquote,{children:[`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Note\"}),\": I faced problems while flashing the ESP32 S3 from an M series Macbook, so I switched to a Windows system.\"]}),`\n`]}),`\n`,(0,n.jsx)(e.p,{children:\"Now, you can follow these steps to flash the code required to make the ESP32 S3 work with the microphone and speakers.\"}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Step 1\"}),\": Create a new device in the ESPHome dashboard by clicking on \\u201C\",(0,n.jsx)(e.strong,{children:\"New Device\"}),\"\\u201D in the bottom right-hand corner.\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Step 2:\"}),\" Give it a name e.g. \\u201C\",(0,n.jsx)(e.strong,{children:\"Voice Assistant\"}),\"\\u201D and click \\u201C\",(0,n.jsx)(e.strong,{children:\"Next\"}),\"\\u201D.\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Step 3\"}),\": Now select ESP32 S3 from the options\"]}),`\n`,(0,n.jsx)(e.div,{children:(0,n.jsx)(l,{alt:\"1-select-esp32-device.webp\",src:\"/static/images/2024/on-device-wake-word/esphome-select.webp\",width:\"424\",height:\"493\"})}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Step 4\"}),\": Now, click on \\u201C\",(0,n.jsx)(e.strong,{children:\"Skip\"}),\"\\u201D and open the device card again by clicking on the \\u201C\",(0,n.jsx)(e.strong,{children:\"Edit\"}),\"\\u201D option.\"]}),`\n`,(0,n.jsx)(e.div,{children:(0,n.jsx)(l,{alt:\"2-edit-device.webp\",src:\"/static/images/2023/esp32-voice-assistant/2-edit-device.webp\",width:\"437\",height:\"173\"})}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Step 5\"}),\": Place the following YAML code below.\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"** \",(0,n.jsx)(e.strong,{children:\"Updated for Home Assistant 2025.07\"}),\" **\"]}),`\n`,(0,n.jsx)(e.pre,{className:\"language-yaml\",children:(0,n.jsxs)(e.code,{className:\"language-yaml code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"substitutions\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Phases of the Voice Assistant\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# The voice assistant is ready to be triggered by a wake word\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"voice_assist_idle_phase_id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'1'\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# The voice assistant is waiting for a voice command (after being triggered by the wake word)\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"voice_assist_waiting_for_command_phase_id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'2'\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# The voice assistant is listening for a voice command\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"voice_assist_listening_for_command_phase_id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'3'\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# The voice assistant is currently processing the command\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"voice_assist_thinking_phase_id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'4'\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# The voice assistant is replying to the command\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"voice_assist_replying_phase_id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'5'\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# The voice assistant is not ready\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"voice_assist_not_ready_phase_id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'10'\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# The voice assistant encountered an error\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"voice_assist_error_phase_id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'11'\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Change this to true in case you ahve a hidden SSID at home.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"hidden_ssid\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"false\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"no_of_leds\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'29'\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Substitutions for audio files\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"jack_connected_sound_file\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" https\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"//github.com/esphome/home\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\"assistant\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\"voice\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),`pe/raw/dev/sounds/jack_connected.flac\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"jack_disconnected_sound_file\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" https\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"//github.com/esphome/home\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\"assistant\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\"voice\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),`pe/raw/dev/sounds/jack_disconnected.flac\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"mute_switch_on_sound_file\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" https\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"//github.com/esphome/home\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\"assistant\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\"voice\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),`pe/raw/dev/sounds/mute_switch_on.flac\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"mute_switch_off_sound_file\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" https\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"//github.com/esphome/home\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\"assistant\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\"voice\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),`pe/raw/dev/sounds/mute_switch_off.flac\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"timer_finished_sound_file\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" https\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"//github.com/esphome/home\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\"assistant\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\"voice\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),`pe/raw/dev/sounds/timer_finished.flac\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"wake_word_triggered_sound_file\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" https\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"//github.com/esphome/home\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\"assistant\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\"voice\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),`pe/raw/dev/sounds/wake_word_triggered.flac\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"center_button_press_sound_file\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" https\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"//github.com/esphome/home\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\"assistant\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\"voice\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),`pe/raw/dev/sounds/center_button_press.flac\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"center_button_double_press_sound_file\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" https\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"//github.com/esphome/home\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\"assistant\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\"voice\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),`pe/raw/dev/sounds/center_button_double_press.flac\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"center_button_triple_press_sound_file\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" https\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"//github.com/esphome/home\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\"assistant\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\"voice\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),`pe/raw/dev/sounds/center_button_triple_press.flac\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"center_button_long_press_sound_file\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" https\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"//github.com/esphome/home\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\"assistant\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\"voice\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),`pe/raw/dev/sounds/center_button_long_press.flac\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"esphome\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"name\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" esp32\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\"s3\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\"ha\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\"pe\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),`update\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"friendly_name\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` ESP32 S3 Home Assistant PE Update\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"name_add_mac_suffix\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean important\",children:\"true\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"min_version\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 2025.9.3\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"on_boot\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"priority\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"375\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"then\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Run the script to refresh the LED status\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"script.execute\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` control_leds\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"delay\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 1s\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# - switch.turn_on: internal_speaker_amp\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# If after 10 minutes, the device is still initializing (It did not yet connect to Home Assistant), turn off the init_in_progress variable and run the script to refresh the LED status\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"delay\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 10min\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"if\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"condition\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"lambda\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` return id(init_in_progress);\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"then\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"lambda\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` id(init_in_progress) = false;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"script.execute\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` control_leds\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"esp32\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"board\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" esp32\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\"s3\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\"devkitc\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"cpu_frequency\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 240MHz\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"variant\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` esp32s3\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"flash_size\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 8MB\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"framework\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"type\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" esp\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),`idf\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"version\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` recommended\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"sdkconfig_options\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"CONFIG_ESP32S3_DATA_CACHE_64KB\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"y\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"CONFIG_ESP32S3_DATA_CACHE_LINE_64B\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"y\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"CONFIG_ESP32S3_INSTRUCTION_CACHE_32KB\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"y\"'}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Moves instructions and read only data from flash into PSRAM on boot.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Both enabled allows instructions to execute while a flash operation is in progress without needing to be placed in IRAM.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Considerably speeds up mWW at the cost of using more PSRAM.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"CONFIG_SPIRAM_RODATA\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"y\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"CONFIG_SPIRAM_FETCH_INSTRUCTIONS\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"y\"'}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"CONFIG_BT_ALLOCATION_FROM_SPIRAM_FIRST\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"y\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"CONFIG_BT_BLE_DYNAMIC_ENV_MEMORY\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"y\"'}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"CONFIG_MBEDTLS_EXTERNAL_MEM_ALLOC\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"y\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"CONFIG_MBEDTLS_SSL_PROTO_TLS1_3\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"y\"'}),\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# TLS1.3 support isn't enabled by default in IDF 5.1.5\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"wifi\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` wifi_id\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"ssid\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token tag\",children:\"!secret\"}),` wifi_ssid\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"password\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token tag\",children:\"!secret\"}),` wifi_password\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"manual_ip\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` \n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"static_ip\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 192.168.0.114\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"gateway\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 192.168.0.1\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"subnet\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 255.255.255.0\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"on_connect\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"lambda\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` id(improv_ble_in_progress) = false;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"script.execute\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` control_leds\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"on_disconnect\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"script.execute\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` control_leds\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Enable fallback hotspot (captive portal) in case wifi connection fails\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"ap\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"ssid\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"Esp32-S3-Wake-Word\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"password\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"LJfUrdJk3svP\"'}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"network\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"enable_ipv6\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean important\",children:\"true\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"logger\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"level\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` DEBUG\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"logs\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"sensor\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" WARN  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# avoids logging debug sensor updates\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"api\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` api_id\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"encryption\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"key\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"TFpb+pBAvQIS1MVwaA7EoJ2DkpWE+79UvVro7yMyGdU=\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"on_client_connected\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"script.execute\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` control_leds\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"on_client_disconnected\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"script.execute\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` control_leds\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# encryption:   # Uses key set by Home Assistant\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"ota\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"platform\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` esphome\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"password\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"1245211a05eef56614a2ef5a3f3e971c\"'}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"psram\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"mode\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` octal\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"speed\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 80MHz\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"globals\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Global index for our LEDs. So that switching between different animation does not lead to unwanted effects.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` global_led_animation_index\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"type\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` int\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"restore_value\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` no\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"initial_value\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'0'\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:'# Global initialization variable. Initialized to true and set to false once everything is connected. Only used to have a smooth \"plugging\" experience'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` init_in_progress\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"type\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` bool\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"restore_value\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` no\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"initial_value\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'true'\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Global variable storing the state of ImprovBLE. Used to draw different LED animations\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` improv_ble_in_progress\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"type\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` bool\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"restore_value\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` no\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"initial_value\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'false'\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Global variable tracking the phase of the voice assistant (defined above). Initialized to not_ready\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` voice_assistant_phase\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"type\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` int\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"restore_value\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` no\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"initial_value\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" $\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"voice_assist_not_ready_phase_id\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Global variable tracking if the dial was recently touched.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` dial_touched\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"type\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` bool\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"restore_value\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` no\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"initial_value\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'false'\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Global variable tracking if the LED color was recently changed.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` color_changed\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"type\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` bool\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"restore_value\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` no\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"initial_value\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'false'\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Global variable tracking if the jack has been plugged touched.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` jack_plugged_recently\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"type\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` bool\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"restore_value\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` no\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"initial_value\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'false'\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Global variable tracking if the jack has been unplugged touched.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` jack_unplugged_recently\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"type\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` bool\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"restore_value\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` no\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"initial_value\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'false'\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Global variable storing the first active timer\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` first_active_timer\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"type\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" voice_assistant\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`Timer\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"restore_value\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean important\",children:\"false\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Global variable storing if a timer is active\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` is_timer_active\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"type\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` bool\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"restore_value\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean important\",children:\"false\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Global variable storing if a factory reset was requested. If it is set to true, the device will factory reset once the center button is released\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` factory_reset_requested\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"type\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` bool\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"restore_value\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` no\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"initial_value\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'false'\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"switch\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# This is the master mute switch. It is exposed to Home Assistant. The user can only turn it on and off if the hardware switch is off. (The hardware switch overrides the software one)\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"platform\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` template\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` master_mute_switch\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"restore_mode\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` RESTORE_DEFAULT_OFF\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"icon\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"mdi:microphone-off\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"name\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` Mute\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"entity_category\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` config\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"optimistic\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean important\",children:\"True\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"lambda\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"|\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`      // Muted either if the hardware mute switch is on or the microphone's software mute switch is enabled\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      if (id(i2s_mics).get_mute_state()) \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`        return true;\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\" else \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`        return false;\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"turn_on_action\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# - if:\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"#     condition:\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"#       binary_sensor.is_off: hardware_mute_switch\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"#     then:\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"microphone.mute\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"turn_off_action\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# - if:\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"#     condition:\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"#       binary_sensor.is_off: hardware_mute_switch\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"#     then:\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"microphone.unmute\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"on_turn_on\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"script.execute\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` control_leds\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"on_turn_off\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"script.execute\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` control_leds\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Wake Word Sound Switch.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"platform\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` template\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` wake_sound\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"name\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` Wake sound\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"icon\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"mdi:bullhorn\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"entity_category\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` config\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"optimistic\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean important\",children:\"true\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"restore_mode\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` RESTORE_DEFAULT_ON\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Internal switch to track when a timer is ringing on the device.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"platform\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` template\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` timer_ringing\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"optimistic\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean important\",children:\"true\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"internal\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean important\",children:\"true\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"restore_mode\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` ALWAYS_OFF\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"on_turn_off\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Disable stop wake word\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"micro_wake_word.disable_model\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` stop\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"script.execute\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` disable_repeat\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Stop any current annoucement (ie: stop the timer ring mid playback)\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"if\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"condition\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"media_player.is_announcing\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"then\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"media_player.stop\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"announcement\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean important\",children:\"true\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Set back ducking ratio to zero\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"mixer_speaker.apply_ducking\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` media_mixing_input\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"decibel_reduction\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"duration\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 1.0s\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Refresh the LED ring\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"script.execute\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` control_leds\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"on_turn_on\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Duck audio\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"mixer_speaker.apply_ducking\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` media_mixing_input\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"decibel_reduction\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"20\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"duration\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 0.0s\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Enable stop wake word\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"micro_wake_word.enable_model\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` stop\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Ring timer\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"script.execute\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` ring_timer\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Refresh LED\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"script.execute\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` control_leds\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# If 15 minutes have passed and the timer is still ringing, stop it.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"delay\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 15min\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"switch.turn_off\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` timer_ringing\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"binary_sensor\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Center Button. Used for many things (See on_multi_click)\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"platform\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` gpio\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" center_button \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"#mute\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"pin\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"number\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` GPIO10\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"inverted\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean important\",children:\"true\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"mode\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"input\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean important\",children:\"True\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"pullup\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean important\",children:\"True\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"on_press\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"script.execute\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` control_leds\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"on_release\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"script.execute\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` control_leds\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# If a factory reset is requested, factory reset on release\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"if\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"condition\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"lambda\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` return id(factory_reset_requested);\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"then\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"button.press\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` factory_reset_button\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"on_multi_click\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Simple Click:\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token comment\",children:'#   - Abort \"things\" in order'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"#     - Timer\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"#     - Announcements\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"#     - Voice Assistant Pipeline run\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"#     - Music\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"#   - Starts the voice assistant if it is not yet running and if the device is not muted.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"timing\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),` ON for at most 1s\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),` OFF for at least 0.25s\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"then\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"if\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"condition\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"switch.is_off\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` master_mute_switch\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"then\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"script.execute\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` play_sound\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"priority\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean important\",children:\"false\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"sound_file\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token tag\",children:\"!lambda\"}),` return id(mute_switch_on_sound);\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"switch.turn_on\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` master_mute_switch\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"else\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"script.execute\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` play_sound\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"priority\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean important\",children:\"false\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"sound_file\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token tag\",children:\"!lambda\"}),` return id(mute_switch_off_sound);\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"microphone.unmute\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Double Click\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"#  . Exposed as an event entity. To be used in automations inside Home Assistant\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"timing\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),` ON for at most 1s\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),` OFF for at most 0.25s\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),` ON for at most 1s\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),` OFF for at least 0.25s\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"then\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"if\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"condition\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"lambda\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" return \",(0,n.jsx)(e.span,{className:\"token tag\",children:\"!id(init_in_progress)\"}),\" \",(0,n.jsx)(e.span,{className:\"token important\",children:\"\u0026\u0026\"}),\" \",(0,n.jsx)(e.span,{className:\"token tag\",children:\"!id(color_changed);\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"then\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"script.execute\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` play_sound\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"priority\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean important\",children:\"false\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"sound_file\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token tag\",children:\"!lambda\"}),` return id(center_button_double_press_sound);\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"event.trigger\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` button_press_event\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"event_type\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"double_press\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Triple Click\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"#  . Exposed as an event entity. To be used in automations inside Home Assistant\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"timing\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),` ON for at most 1s\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),` OFF for at most 0.25s\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),` ON for at most 1s\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),` OFF for at most 0.25s\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),` ON for at most 1s\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),` OFF for at least 0.25s\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"then\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"if\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"condition\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"lambda\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" return \",(0,n.jsx)(e.span,{className:\"token tag\",children:\"!id(init_in_progress)\"}),\" \",(0,n.jsx)(e.span,{className:\"token important\",children:\"\u0026\u0026\"}),\" \",(0,n.jsx)(e.span,{className:\"token tag\",children:\"!id(color_changed);\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"then\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"script.execute\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` play_sound\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"priority\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean important\",children:\"false\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"sound_file\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token tag\",children:\"!lambda\"}),` return id(center_button_triple_press_sound);\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"event.trigger\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` button_press_event\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"event_type\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"triple_press\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Long Press\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"#  . Exposed as an event entity. To be used in automations inside Home Assistant\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"timing\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),` ON for at least 1s\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"then\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"if\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"condition\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"lambda\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" return \",(0,n.jsx)(e.span,{className:\"token tag\",children:\"!id(init_in_progress)\"}),\" \",(0,n.jsx)(e.span,{className:\"token important\",children:\"\u0026\u0026\"}),\" \",(0,n.jsx)(e.span,{className:\"token tag\",children:\"!id(color_changed);\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"then\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"script.execute\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` play_sound\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"priority\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean important\",children:\"false\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"sound_file\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token tag\",children:\"!lambda\"}),` return id(center_button_long_press_sound);\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"light.turn_off\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` voice_assistant_leds\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"event.trigger\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` button_press_event\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"event_type\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"long_press\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Very important do not remove. Trust me :D\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"timing\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# H ....\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),` ON for at most 0.2s\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),` OFF for 0s to 2s\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),` ON for at most 0.2s\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),` OFF for 0s to 2s\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),` ON for at most 0.2s\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),` OFF for 0s to 2s\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),` ON for at most 0.2s\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),` OFF for 0.5s to 2s\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# A ._\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),` ON for at most 0.2s\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),` OFF for 0s to 2s\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),` ON for 0.2s to 2s\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"then\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"if\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"condition\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"lambda\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" return \",(0,n.jsx)(e.span,{className:\"token tag\",children:\"!id(init_in_progress);\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"then\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"light.turn_on\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"brightness\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 100%\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` voice_assistant_leds\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"effect\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"Tick\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"script.execute\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` play_sound\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"priority\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean important\",children:\"true\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"sound_file\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token tag\",children:\"!lambda\"}),` return id(easter_egg_tick_sound);\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"delay\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 4s\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"light.turn_off\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` voice_assistant_leds\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"script.execute\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` play_sound\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"priority\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean important\",children:\"true\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"sound_file\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token tag\",children:\"!lambda\"}),` return id(easter_egg_tada_sound);\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"light.turn_on\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"brightness\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 100%\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` voice_assistant_leds\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"effect\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"Rainbow\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"event.trigger\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` button_press_event\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"event_type\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"easter_egg_press\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Factory Reset Warning\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"#  . Audible and Visible warning.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"timing\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),` ON for at least 10s\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"then\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"if\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"condition\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"lambda\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" return \",(0,n.jsx)(e.span,{className:\"token tag\",children:\"!id(dial_touched);\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"then\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"light.turn_on\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"brightness\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 100%\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` voice_assistant_leds\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"effect\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"Factory Reset Coming Up\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"script.execute\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` play_sound\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"priority\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean important\",children:\"true\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"sound_file\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token tag\",children:\"!lambda\"}),` return id(factory_reset_initiated_sound);\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"wait_until\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"binary_sensor.is_off\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` center_button\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"if\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"condition\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                      \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"lambda\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" return \",(0,n.jsx)(e.span,{className:\"token tag\",children:\"!id(factory_reset_requested);\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"then\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"light.turn_off\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` voice_assistant_leds\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"script.execute\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` play_sound\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"priority\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean important\",children:\"true\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"sound_file\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token tag\",children:\"!lambda\"}),` return id(factory_reset_cancelled_sound);\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Factory Reset Confirmed.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"#  . Audible warning to prompt user to release the button\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"#  . Set factory_reset_requested to true\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"timing\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),` ON for at least 22s\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"then\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"if\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"condition\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"lambda\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" return \",(0,n.jsx)(e.span,{className:\"token tag\",children:\"!id(dial_touched);\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"then\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"script.execute\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` play_sound\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"priority\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean important\",children:\"true\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"sound_file\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token tag\",children:\"!lambda\"}),` return id(factory_reset_confirmed_sound);\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"light.turn_on\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"brightness\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 100%\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"red\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 100%\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"green\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 0%\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"blue\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 0%\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` voice_assistant_leds\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"effect\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"none\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"lambda\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` id(factory_reset_requested) = true;\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"light\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Hardware LED ring. Not used because remapping needed\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"platform\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` esp32_rmt_led_strip\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` leds_internal\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"rgb_order\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` GRB\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"pin\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` GPIO09\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"num_leds\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"29\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"rmt_symbols\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"96\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"chipset\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` ws2812\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# power_supply: led_power\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Voice Assistant LED ring. Remapping of the internal LED.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# This light is not exposed. The device controls it\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"platform\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` partition\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` voice_assistant_leds\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"internal\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean important\",children:\"true\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"default_transition_length\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 0ms\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"segments\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` leds_internal\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"from\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"15\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"to\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"28\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` leds_internal\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"from\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"to\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"14\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"effects\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"addressable_lambda\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"name\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"Waiting for Command\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"update_interval\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 100ms\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"lambda\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"|\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`            auto light_color = id(led_ring).current_values;\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            Color color(light_color.get_red() * 255\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" light_color.get_green() * 255\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`                  light_color.get_blue() * 255);\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            for (uint8_t i = 0; i \u003c $\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"no_of_leds\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\"; i++) \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              if (i == id(global_led_animation_index) % $\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"no_of_leds\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\") \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                it\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),` = color;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\" else if (i == (id(global_led_animation_index) + 11) % $\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"no_of_leds\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\") \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                it\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),` = color * 192;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\" else if (i == (id(global_led_animation_index) + 10) % $\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"no_of_leds\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\") \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                it\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),` = color * 128;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\" else if (i == (id(global_led_animation_index) + 6) % $\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"no_of_leds\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\") \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                it\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),` = color;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\" else if (i == (id(global_led_animation_index) + 5) % $\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"no_of_leds\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\") \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                it\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),` = color * 192;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\" else if (i == (id(global_led_animation_index) + 4) % $\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"no_of_leds\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\") \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                it\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),` = color * 128;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\" else \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                it\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" = Color\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`BLACK;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            id(global_led_animation_index) = (id(global_led_animation_index) + 1) % $\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"no_of_leds\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"addressable_lambda\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"name\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"Listening For Command\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"update_interval\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 50ms\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"lambda\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"|\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`            auto light_color = id(led_ring).current_values;\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            Color color(light_color.get_red() * 255\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" light_color.get_green() * 255\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`                  light_color.get_blue() * 255);\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            for (uint8_t i = 0; i \u003c $\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"no_of_leds\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\"; i++) \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              if (i == id(global_led_animation_index) % $\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"no_of_leds\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\") \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                it\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),` = color;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\" else if (i == (id(global_led_animation_index) + 11) % $\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"no_of_leds\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\") \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                it\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),` = color * 192;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\" else if (i == (id(global_led_animation_index) + 10) % $\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"no_of_leds\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\") \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                it\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),` = color * 128;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\" else if (i == (id(global_led_animation_index) + 6) % $\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"no_of_leds\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\") \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                it\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),` = color;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\" else if (i == (id(global_led_animation_index) + 5) % $\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"no_of_leds\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\") \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                it\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),` = color * 192;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\" else if (i == (id(global_led_animation_index) + 4) % $\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"no_of_leds\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\") \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                it\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),` = color * 128;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\" else \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                it\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" = Color\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`BLACK;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            id(global_led_animation_index) = (id(global_led_animation_index) + 1) % $\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"no_of_leds\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"addressable_lambda\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"name\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"Thinking\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"update_interval\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 10ms\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"lambda\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"|\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`            static uint8_t brightness_step = 0;\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`            static bool brightness_decreasing = true;\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`            static uint8_t brightness_step_number = 10;\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            if (initial_run) \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`              brightness_step = 0;\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`              brightness_decreasing = true;\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`            auto light_color = id(led_ring).current_values;\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            Color color(light_color.get_red() * 255\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" light_color.get_green() * 255\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`                  light_color.get_blue() * 255);\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            for (uint8_t i = 0; i \u003c $\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"no_of_leds\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\"; i++) \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              if (i == id(global_led_animation_index) % $\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"no_of_leds\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\") \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                it\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" = color * uint8_t(255/brightness_step_number\",(0,n.jsx)(e.span,{className:\"token important\",children:\"*(brightness_step_number-brightness_step));\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\" else if (i == (id(global_led_animation_index) + 5) % $\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"no_of_leds\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\") \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                it\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" = color * uint8_t(255/brightness_step_number\",(0,n.jsx)(e.span,{className:\"token important\",children:\"*(brightness_step_number-brightness_step));\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\" else if (i == (id(global_led_animation_index) + 10) % $\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"no_of_leds\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\") \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                it\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" = color * uint8_t(255/brightness_step_number\",(0,n.jsx)(e.span,{className:\"token important\",children:\"*(brightness_step_number-brightness_step));\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\" else if (i == (id(global_led_animation_index) + 15) % $\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"no_of_leds\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\") \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                it\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" = color * uint8_t(255/brightness_step_number\",(0,n.jsx)(e.span,{className:\"token important\",children:\"*(brightness_step_number-brightness_step));\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\" else if (i == (id(global_led_animation_index) + 20) % $\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"no_of_leds\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\") \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                it\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" = color * uint8_t(255/brightness_step_number\",(0,n.jsx)(e.span,{className:\"token important\",children:\"*(brightness_step_number-brightness_step));\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\" else if (i == (id(global_led_animation_index) + 25) % $\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"no_of_leds\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\") \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                it\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" = color * uint8_t(255/brightness_step_number\",(0,n.jsx)(e.span,{className:\"token important\",children:\"*(brightness_step_number-brightness_step));\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\" else \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                it\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" = Color\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`BLACK;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            if (brightness_decreasing) \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`              brightness_step++;\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\" else \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              brightness_step\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),`;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            if (brightness_step == 0 \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"|\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"|\"}),\" brightness_step == brightness_step_number) \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              brightness_decreasing = \",(0,n.jsx)(e.span,{className:\"token tag\",children:\"!brightness_decreasing;\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"addressable_lambda\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"name\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"Replying\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"update_interval\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 50ms\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"lambda\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"|\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            id(global_led_animation_index) = ($\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"no_of_leds\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\" + id(global_led_animation_index) \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" 1) % $\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"no_of_leds\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`;\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`            auto light_color = id(led_ring).current_values;\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            Color color(light_color.get_red() * 255\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" light_color.get_green() * 255\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`                  light_color.get_blue() * 255);\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            for (uint8_t i = 0; i \u003c $\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"no_of_leds\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\"; i++) \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              if (i == (id(global_led_animation_index)) % $\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"no_of_leds\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\") \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                it\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),` = color;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\" else if (i == ( id(global_led_animation_index) + 1) % $\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"no_of_leds\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\") \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                it\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),` = color * 192;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\" else if (i == ( id(global_led_animation_index) + 2) % $\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"no_of_leds\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\") \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                it\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),` = color * 128;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\" else if (i == ( id(global_led_animation_index) + 6) % $\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"no_of_leds\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\") \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                it\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),` = color;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\" else if (i == ( id(global_led_animation_index) + 7) % $\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"no_of_leds\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\") \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                it\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),` = color * 192;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\" else if (i == ( id(global_led_animation_index) + 8) % $\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"no_of_leds\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\") \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                it\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),` = color * 128;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\" else \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                it\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" = Color\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`BLACK;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"addressable_lambda\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"name\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"Muted or Silent\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"update_interval\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 16ms\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"lambda\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"|\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`            static int8_t index = 0;\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            Color muted_color(255\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),` 0);\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`            auto light_color = id(led_ring).current_values;\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            Color color(light_color.get_red() * 255\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" light_color.get_green() * 255\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`                  light_color.get_blue() * 255);\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            for (uint8_t i = 0; i \u003c $\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"no_of_leds\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\"; i++) \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              if ( light_color.get_state() ) \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                it\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),` = color;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\" else \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                it\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" = Color\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`BLACK;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            if ( id(master_mute_switch).state ) \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            if ( id(external_media_player).volume == 0.0f \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"|\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"|\"}),\" id(external_media_player).is_muted() \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"|\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"|\"}),\" id(master_mute_switch).state ) \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              it\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" = Color\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`BLACK;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              it\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"3\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),` = muted_color;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              it\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"6\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" = Color\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`BLACK;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              it\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"9\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),` = muted_color;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              it\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"12\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" = Color\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`BLACK;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              it\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"15\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),` = muted_color;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              it\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"18\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" = Color\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`BLACK;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              it\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"21\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),` = muted_color;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              it\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"24\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" = Color\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`BLACK;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              it\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"27\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),` = muted_color;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"addressable_lambda\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"name\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"Voice kit startup failed\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# update_interval: 16ms\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"lambda\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"|\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`            static int8_t index = 0;\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            Color fail_color(255\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),` 0);\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            for (uint8_t i = 0; i \u003c $\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"no_of_leds\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\"; i++) \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              if (i % 3) \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                it\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" = Color\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`BLACK;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\" else \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                it\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),` = fail_color;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"addressable_lambda\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"name\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"Center Button Touched\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"update_interval\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 16ms\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"lambda\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"|\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            if (initial_run) \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`              // set voice_assistant_leds light to colors based on led_ring\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`              auto led_ring_cv = id(led_ring).current_values;\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`              auto va_leds_call = id(voice_assistant_leds).make_call();\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`              va_leds_call.from_light_color_values(led_ring_cv);\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              va_leds_call.set_brightness( min ( max( id(led_ring).current_values.get_brightness() \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" 0.2f ) + 0.1f \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),` 1.0f ) );\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`              va_leds_call.set_state(true);\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`              va_leds_call.perform();\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`            auto light_color = id(voice_assistant_leds).current_values;\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            Color color(light_color.get_red() * 255\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" light_color.get_green() * 255\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`                  light_color.get_blue() * 255);\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            for (uint8_t i = 0; i \u003c $\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"no_of_leds\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\"; i++) \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              it\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),` = color;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"addressable_twinkle\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"name\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"Twinkle\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"twinkle_probability\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 50%\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"addressable_lambda\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"name\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"Error\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"update_interval\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 10ms\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"lambda\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"|\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`            static uint8_t brightness_step = 0;\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`            static bool brightness_decreasing = true;\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`            static uint8_t brightness_step_number = 10;\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            if (initial_run) \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`              brightness_step = 0;\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`              brightness_decreasing = true;\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            Color error_color(255\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),` 0);\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            for (uint8_t i = 0; i \u003c $\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"no_of_leds\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\"; i++) \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              it\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" = error_color * uint8_t(255/brightness_step_number\",(0,n.jsx)(e.span,{className:\"token important\",children:\"*(brightness_step_number-brightness_step));\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            if (brightness_decreasing) \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`              brightness_step++;\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\" else \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              brightness_step\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),`;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            if (brightness_step == 0 \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"|\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"|\"}),\" brightness_step == brightness_step_number) \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              brightness_decreasing = \",(0,n.jsx)(e.span,{className:\"token tag\",children:\"!brightness_decreasing;\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"addressable_lambda\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"name\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"Timer Ring\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"update_interval\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 10ms\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"lambda\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"|\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`            static uint8_t brightness_step = 0;\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`            static bool brightness_decreasing = true;\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`            static uint8_t brightness_step_number = 10;\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            if (initial_run) \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`              brightness_step = 0;\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`              brightness_decreasing = true;\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`            auto light_color = id(led_ring).current_values;\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            Color color(light_color.get_red() * 255\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" light_color.get_green() * 255\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`                  light_color.get_blue() * 255);\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            Color muted_color(255\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),` 0);\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            for (uint8_t i = 0; i \u003c $\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"no_of_leds\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\"; i++) \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              it\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" = color * uint8_t(255/brightness_step_number\",(0,n.jsx)(e.span,{className:\"token important\",children:\"*(brightness_step_number-brightness_step));\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            if ( id(master_mute_switch).state ) \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              it\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"3\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),` = muted_color;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              it\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"9\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),` = muted_color;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            if (brightness_decreasing) \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`              brightness_step++;\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\" else \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              brightness_step\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),`;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            if (brightness_step == 0 \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"|\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"|\"}),\" brightness_step == brightness_step_number) \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              brightness_decreasing = \",(0,n.jsx)(e.span,{className:\"token tag\",children:\"!brightness_decreasing;\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"addressable_lambda\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"name\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"Timer Tick\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"update_interval\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 100ms\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"lambda\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"|\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`            auto light_color = id(led_ring).current_values;\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            Color color(light_color.get_red() * 255\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" light_color.get_green() * 255\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`                  light_color.get_blue() * 255);\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            Color muted_color(255\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),` 0);\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            auto timer_ratio = 12.0f * id(first_active_timer).seconds_left / max(id(first_active_timer).total_seconds \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" static_cast\u003cuint32_t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"}),`(1));\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            uint8_t last_led_on = static_cast\u003cuint8_t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"}),\"(ceil(timer_ratio)) \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),` 1;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            for (uint8_t i = 0; i \u003c $\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"no_of_leds\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\"; i++) \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              float brightness_dip = ( i == id(global_led_animation_index) % $\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"no_of_leds\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\" \",(0,n.jsx)(e.span,{className:\"token important\",children:\"\u0026\u0026\"}),\" i \",(0,n.jsx)(e.span,{className:\"token tag\",children:\"!=\"}),\" last_led_on ) \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"?\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"0.9f\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 1.0f ;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              if (i \u003c= timer_ratio) \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                it\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" = color * min(255.0f * brightness_dip * (timer_ratio \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" i) \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),` 255.0f * brightness_dip) ;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\" else \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                it\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" = Color\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`BLACK;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            if (id(master_mute_switch).state) \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              it\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"2\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" = Color\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`BLACK;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              it\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"3\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),` = muted_color;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              it\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"4\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" = Color\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`BLACK;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              it\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"8\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" = Color\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`BLACK;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              it\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"9\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),` = muted_color;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              it\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"10\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" = Color\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`BLACK;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            id(global_led_animation_index) = ($\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"no_of_leds\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\" + id(global_led_animation_index) \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" 1) % $\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"no_of_leds\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"addressable_rainbow\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"name\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"Rainbow\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"width\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"29\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"addressable_lambda\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"name\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"Tick\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"update_interval\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 333ms\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"lambda\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"|\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`            static uint8_t index = 0;\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            Color color(255\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),` 0);\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            if (initial_run) \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`              index = 0;\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            for (uint8_t i = 0; i \u003c $\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"no_of_leds\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\"; i++) \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              if (i \u003c= index ) \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                it\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" = Color\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`BLACK;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\" else \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                it\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),` = color;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            index = (index + 1) % $\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"no_of_leds\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"addressable_lambda\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"name\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"Factory Reset Coming Up\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"update_interval\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 1s\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"lambda\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"|\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`            static uint8_t index = 0;\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            Color color(255\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),` 0);\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            if (initial_run) \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`              index = 0;\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            for (uint8_t i = 0; i \u003c $\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"no_of_leds\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\"; i++) \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              if (i \u003c= index ) \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                it\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),` = color;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\" else \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                it\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" = Color\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`BLACK;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            index = (index + 1) % $\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"no_of_leds\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`;\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# User facing LED ring. Remapping of the internal LEDs.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Exposed to be used by the user.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"platform\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` partition\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` led_ring\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"name\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` LED Ring\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"entity_category\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` config\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"icon\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"mdi:circle-outline\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"default_transition_length\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 0ms\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"restore_mode\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` RESTORE_DEFAULT_OFF\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"initial_state\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"color_mode\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` rgb\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"brightness\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 66%\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"red\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 9.4%\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"green\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 73.3%\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"blue\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 94.9%\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"segments\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` leds_internal\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"from\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"7\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"to\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"11\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` leds_internal\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"from\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"to\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"6\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"# power_supply:\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"#   - id: led_power\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"#     pin: GPIO45\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"event\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Event entity exposed to the user to automate on complex center button presses.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# The simple press is not exposed as it is used to control the device itself.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"platform\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` template\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` button_press_event\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"name\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"Button press\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"icon\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" mdi\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"button\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),`pointer\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"device_class\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` button\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"event_types\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),` double_press\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),` triple_press\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),` long_press\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),` easter_egg_press\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"script\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Master script controlling the LEDs, based on different conditions : initialization in progress, wifi and api connected and voice assistant phase.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# For the sake of simplicity and re-usability, the script calls child scripts defined below.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# This script will be called every time one of these conditions is changing.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` control_leds\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"then\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"lambda\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"|\"}),(0,n.jsx)(e.span,{className:\"token scalar string\",children:`\n`})]}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token scalar string\",children:`          id(check_if_timers_active).execute();\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token scalar string\",children:`          if (id(is_timer_active)){\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token scalar string\",children:`            id(fetch_first_active_timer).execute();\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token scalar string\",children:`          }\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token scalar string\",children:`          if (id(improv_ble_in_progress)) {\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token scalar string\",children:`            id(control_leds_improv_ble_state).execute();\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token scalar string\",children:`          } else if (id(init_in_progress)) {\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token scalar string\",children:`            id(control_leds_init_state).execute();\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token scalar string\",children:`          } else if (!id(wifi_id).is_connected() || !id(api_id).is_connected()){\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token scalar string\",children:`            id(control_leds_no_ha_connection_state).execute();\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token scalar string\",children:`          //} else if (id(center_button).state) {\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token scalar string\",children:`          //  id(control_leds_center_button_touched).execute();\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token scalar string\",children:`          } else if (id(jack_plugged_recently)) {\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token scalar string\",children:`            id(control_leds_jack_plugged_recently).execute();\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token scalar string\",children:`          } else if (id(jack_unplugged_recently)) {\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token scalar string\",children:`            id(control_leds_jack_unplugged_recently).execute();\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token scalar string\",children:`          } else if (id(dial_touched)) {\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token scalar string\",children:`            id(control_leds_dial_touched).execute();\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token scalar string\",children:`          } else if (id(timer_ringing).state) {\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token scalar string\",children:`            id(control_leds_timer_ringing).execute();\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token scalar string\",children:\"          } else if (id(voice_assistant_phase) == ${voice_assist_waiting_for_command_phase_id}) {\\n\"})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token scalar string\",children:`            id(control_leds_voice_assistant_waiting_for_command_phase).execute();\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token scalar string\",children:\"          } else if (id(voice_assistant_phase) == ${voice_assist_listening_for_command_phase_id}) {\\n\"})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token scalar string\",children:`            id(control_leds_voice_assistant_listening_for_command_phase).execute();\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token scalar string\",children:\"          } else if (id(voice_assistant_phase) == ${voice_assist_thinking_phase_id}) {\\n\"})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token scalar string\",children:`            id(control_leds_voice_assistant_thinking_phase).execute();\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token scalar string\",children:\"          } else if (id(voice_assistant_phase) == ${voice_assist_replying_phase_id}) {\\n\"})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token scalar string\",children:`            id(control_leds_voice_assistant_replying_phase).execute();\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token scalar string\",children:\"          } else if (id(voice_assistant_phase) == ${voice_assist_error_phase_id}) {\\n\"})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token scalar string\",children:`            id(control_leds_voice_assistant_error_phase).execute();\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token scalar string\",children:\"          } else if (id(voice_assistant_phase) == ${voice_assist_not_ready_phase_id}) {\\n\"})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token scalar string\",children:`            id(control_leds_voice_assistant_not_ready_phase).execute();\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token scalar string\",children:`          } else if (id(is_timer_active)) {\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token scalar string\",children:`            id(control_leds_timer_ticking).execute();\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token scalar string\",children:`          } else if (id(master_mute_switch).state) {\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token scalar string\",children:`            id(control_leds_muted_or_silent).execute();\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token scalar string\",children:`          } else if (id(external_media_player).volume == 0.0f || id(external_media_player).is_muted()) {\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token scalar string\",children:`            id(control_leds_muted_or_silent).execute();\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token scalar string\",children:\"          } else if (id(voice_assistant_phase) == ${voice_assist_idle_phase_id}) {\\n\"})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token scalar string\",children:`            id(control_leds_voice_assistant_idle_phase).execute();\n`})}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token scalar string\",children:\"          }\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Script executed if voice_kit startup failed\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:'# Static red \"X\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` control_leds_voice_kit_startup_failed\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"then\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"light.turn_on\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"brightness\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 40%\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"red\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 0%\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"green\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 0%\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"blue\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 0%\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` voice_assistant_leds\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"effect\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"Voice kit startup failed\"'}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Script executed during Improv BLE\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Warm White Twinkle\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` control_leds_improv_ble_state\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"then\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"light.turn_on\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"brightness\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 66%\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"red\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 100%\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"green\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 89%\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"blue\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 71%\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` voice_assistant_leds\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"effect\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"Twinkle\"'}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Script executed during initialization\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Blue Twinkle if Wifi is connected, Else solid warm white\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` control_leds_init_state\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"then\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"if\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"condition\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"wifi.connected\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"then\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"light.turn_on\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"brightness\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 66%\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"red\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 9.4%\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"green\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 73.3%\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"blue\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 94.9%\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` voice_assistant_leds\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"effect\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"Twinkle\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"else\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"light.turn_on\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"brightness\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 66%\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"red\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 100%\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"green\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 89%\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"blue\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 71%\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` voice_assistant_leds\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"effect\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"none\"'}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Script executed when the device has no connection to Home Assistant\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Red Twinkle (This will be visible during HA updates for example)\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` control_leds_no_ha_connection_state\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"then\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"light.turn_on\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"brightness\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 66%\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"red\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"green\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"blue\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` voice_assistant_leds\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"effect\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"Twinkle\"'}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Script executed when the voice assistant is idle (waiting for a wake word)\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Nothing (Either LED ring off or LED ring on if the user decided to turn the user facing LED ring on)\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` control_leds_voice_assistant_idle_phase\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"then\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"light.turn_off\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` voice_assistant_leds\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"if\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"condition\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"light.is_on\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` led_ring\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"then\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"light.turn_on\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` led_ring\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Script executed when the voice assistant is waiting for a command (After the wake word)\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Slow clockwise spin of the LED ring.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` control_leds_voice_assistant_waiting_for_command_phase\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"then\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"light.turn_on\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"brightness\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token tag\",children:\"!lambda\"}),\" return max( id(led_ring).current_values.get_brightness() \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),` 0.2f );\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` voice_assistant_leds\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"effect\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"Waiting for Command\"'}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Script executed when the voice assistant is listening to a command\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Fast clockwise spin of the LED ring.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` control_leds_voice_assistant_listening_for_command_phase\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"then\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"light.turn_on\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"brightness\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token tag\",children:\"!lambda\"}),\" return max( id(led_ring).current_values.get_brightness() \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),` 0.2f );\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` voice_assistant_leds\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"effect\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"Listening For Command\"'}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Script executed when the voice assistant is thinking to a command\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# The spin stops and the 2 LEDs that are currently on and blinking indicating the commend is being processed.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` control_leds_voice_assistant_thinking_phase\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"then\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"light.turn_on\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"brightness\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token tag\",children:\"!lambda\"}),\" return max( id(led_ring).current_values.get_brightness() \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),` 0.2f );\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` voice_assistant_leds\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"effect\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"Thinking\"'}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Script executed when the voice assistant is thinking to a command\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Fast anticlockwise spin of the LED ring.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` control_leds_voice_assistant_replying_phase\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"then\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"light.turn_on\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"brightness\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token tag\",children:\"!lambda\"}),\" return max( id(led_ring).current_values.get_brightness() \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),` 0.2f );\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` voice_assistant_leds\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"effect\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"Replying\"'}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Script executed when the voice assistant is in error\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Fast Red Pulse\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` control_leds_voice_assistant_error_phase\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"then\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"light.turn_on\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"brightness\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token tag\",children:\"!lambda\"}),\" return min ( max( id(led_ring).current_values.get_brightness() \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" 0.2f ) + 0.1f \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),` 1.0f );\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"red\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"green\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"blue\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` voice_assistant_leds\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"effect\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"Error\"'}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Script executed when the voice assistant is muted or silent\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# The LED next to the 2 microphones turn red / one red LED next to the speaker grill\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` control_leds_muted_or_silent\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"then\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"light.turn_on\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"brightness\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token tag\",children:\"!lambda\"}),\" return max( id(led_ring).current_values.get_brightness() \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),` 0.2f );\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` voice_assistant_leds\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"effect\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"Muted or Silent\"'}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Script executed when the voice assistant is not ready\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` control_leds_voice_assistant_not_ready_phase\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"then\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"light.turn_on\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"brightness\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 66%\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"red\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"green\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"blue\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` voice_assistant_leds\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"effect\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"Twinkle\"'}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Script executed when the dial is touched\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# A number of LEDs turn on indicating a visual representation of the volume of the media player entity.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` control_leds_dial_touched\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"then\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"light.turn_on\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"brightness\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token tag\",children:\"!lambda\"}),\" return max( id(led_ring).current_values.get_brightness() \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),` 0.2f );\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` voice_assistant_leds\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"effect\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"Volume Display\"'}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Script executed when the jack has just been unplugged\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# A ripple effect\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` control_leds_jack_unplugged_recently\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"then\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"light.turn_on\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"brightness\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token tag\",children:\"!lambda\"}),\" return max( id(led_ring).current_values.get_brightness() \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),` 0.2f );\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` voice_assistant_leds\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"effect\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"Jack Unplugged\"'}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Script executed when the jack has just been plugged\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# A ripple effect\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` control_leds_jack_plugged_recently\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"then\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"light.turn_on\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"brightness\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token tag\",children:\"!lambda\"}),\" return max( id(led_ring).current_values.get_brightness() \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),` 0.2f );\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` voice_assistant_leds\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"effect\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"Jack Plugged\"'}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Script executed when the center button is touched\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# The complete LED ring turns on\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` control_leds_center_button_touched\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"then\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"light.turn_on\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"brightness\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token tag\",children:\"!lambda\"}),\" return min ( max( id(led_ring).current_values.get_brightness() \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" 0.2f ) + 0.1f \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),` 1.0f );\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` voice_assistant_leds\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"effect\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"Center Button Touched\"'}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Script executed when the timer is ringing, to control the LEDs\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# The LED ring blinks.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` control_leds_timer_ringing\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"then\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"light.turn_on\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"brightness\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token tag\",children:\"!lambda\"}),\" return min ( max( id(led_ring).current_values.get_brightness() \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" 0.2f ) + 0.1f \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),` 1.0f );\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` voice_assistant_leds\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"effect\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"Timer Ring\"'}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Script executed when the timer is ticking, to control the LEDs\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# The LEDs shows the remaining time as a fraction of the full ring.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` control_leds_timer_ticking\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"then\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"light.turn_on\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"brightness\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token tag\",children:\"!lambda\"}),\" return max( id(led_ring).current_values.get_brightness() \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),` 0.2f );\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` voice_assistant_leds\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"effect\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"Timer tick\"'}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Script executed when the volume is increased/decreased from the dial\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` control_volume\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"mode\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` restart\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"parameters\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"increase_volume\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" bool  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# True: Increase volume / False: Decrease volume.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"then\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"delay\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 16ms\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"if\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"condition\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"lambda\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` return increase_volume;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"then\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"media_player.volume_up\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"else\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"media_player.volume_down\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"script.execute\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` control_leds\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"delay\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 1s\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"lambda\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` id(dial_touched) = false;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"script.execute\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` control_leds\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Script executed when the hue is increased/decreased from the dial\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Script executed when the timer is ringing, to playback sounds.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` ring_timer\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"then\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"script.execute\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` enable_repeat_one\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"script.execute\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` play_sound\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"priority\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean important\",children:\"true\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"sound_file\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token tag\",children:\"!lambda\"}),` return id(timer_finished_sound);\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Script executed when the timer is ringing, to repeat the timer finished sound.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` enable_repeat_one\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"then\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Turn on the repeat mode and pause for 500 ms between playlist items/repeats\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"lambda\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"|\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`            id(external_media_player)\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"}),`make_call()\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              .set_command(media_player\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"MediaPlayerCommand\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`MEDIA_PLAYER_COMMAND_REPEAT_ONE)\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`              .set_announcement(true)\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`              .perform();\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            id(external_media_player)\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"}),\"set_playlist_delay_ms(speaker\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"AudioPipelineType\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"ANNOUNCEMENT\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),` 500);\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Script execute when the timer is done ringing, to disable repeat mode.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` disable_repeat\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"then\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Turn off the repeat mode and pause for 0 ms between playlist items/repeats\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"lambda\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"|\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`            id(external_media_player)\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"}),`make_call()\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              .set_command(media_player\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"MediaPlayerCommand\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`MEDIA_PLAYER_COMMAND_REPEAT_OFF)\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`              .set_announcement(true)\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`              .perform();\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            id(external_media_player)\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"}),\"set_playlist_delay_ms(speaker\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"AudioPipelineType\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"ANNOUNCEMENT\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),` 0);\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Script executed when we want to play sounds on the device.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` play_sound\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"parameters\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"priority\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` bool\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"sound_file\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"audio::AudioFile*\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"then\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"lambda\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"|\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          if (priority) \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`            id(external_media_player)\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"}),`make_call()\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              .set_command(media_player\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"MediaPlayerCommand\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`MEDIA_PLAYER_COMMAND_STOP)\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`              .set_announcement(true)\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`              .perform();\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          if ( (id(external_media_player).state \",(0,n.jsx)(e.span,{className:\"token tag\",children:\"!=\"}),\" media_player\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"MediaPlayerState\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"MEDIA_PLAYER_STATE_ANNOUNCING ) \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"|\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"|\"}),\" priority) \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`            id(external_media_player)\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"}),\"play_file(sound_file\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean important\",children:\"true\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),` false);\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Script used to fetch the first active timer (Stored in global first_active_timer)\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` fetch_first_active_timer\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"then\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"lambda\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"|\"}),(0,n.jsx)(e.span,{className:\"token scalar string\",children:`\n`})]}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token scalar string\",children:`          const auto timers = id(va).get_timers();\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token scalar string\",children:`          auto output_timer = timers.begin()-\u003esecond;\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token scalar string\",children:`          for (auto \u0026iterable_timer : timers) {\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token scalar string\",children:`            if (iterable_timer.second.is_active \u0026\u0026 iterable_timer.second.seconds_left \u003c= output_timer.seconds_left) {\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token scalar string\",children:`              output_timer = iterable_timer.second;\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token scalar string\",children:`            }\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token scalar string\",children:`          }\n`})}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token scalar string\",children:\"          id(first_active_timer) = output_timer;\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Script used to check if a timer is active (Stored in global is_timer_active)\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` check_if_timers_active\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"then\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"lambda\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"|\"}),(0,n.jsx)(e.span,{className:\"token scalar string\",children:`\n`})]}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token scalar string\",children:`          const auto timers = id(va).get_timers();\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token scalar string\",children:`          bool output = false;\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token scalar string\",children:`          if (timers.size() \u003e 0) {\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token scalar string\",children:`            for (auto \u0026iterable_timer : timers) {\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token scalar string\",children:`              if(iterable_timer.second.is_active) {\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token scalar string\",children:`                output = true;\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token scalar string\",children:`              }\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token scalar string\",children:`            }\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token scalar string\",children:`          }\n`})}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token scalar string\",children:\"          id(is_timer_active) = output;\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Script used activate the stop word if the TTS step is long.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Why is this wrapped on a script?\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"#   Becasue we want to stop the sequence if the TTS step is faster than that.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"#   This allows us to prevent having the deactivation of the stop word before its own activation.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` activate_stop_word_once\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"then\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"delay\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 1s\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Enable stop wake word\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"if\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"condition\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"switch.is_off\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` timer_ringing\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"then\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"micro_wake_word.enable_model\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` stop\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"wait_until\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"not\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"media_player.is_announcing\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"if\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"condition\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"switch.is_off\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` timer_ringing\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"then\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"micro_wake_word.disable_model\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` stop\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"i2s_audio\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` i2s_output\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# i2s_output data pin is gpio10\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"i2s_lrclk_pin\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"number\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` GPIO6\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"i2s_bclk_pin\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"number\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` GPIO7\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` i2s_input\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# data line is GPIO15\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"i2s_lrclk_pin\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"number\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` GPIO3\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"i2s_bclk_pin\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"number\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` GPIO2\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"microphone\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"platform\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` i2s_audio\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` i2s_mics\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"i2s_din_pin\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` GPIO4\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"adc_type\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` external\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"pdm\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean important\",children:\"false\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# sample_rate: 16000\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"bits_per_sample\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 32bit\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# i2s_mode: secondary\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"i2s_audio_id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` i2s_input\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"channel\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` left\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"speaker\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Hardware speaker output\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"platform\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` i2s_audio\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` i2s_audio_speaker\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"sample_rate\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"48000\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# i2s_mode: secondary\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"i2s_dout_pin\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` GPIO8\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"bits_per_sample\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 32bit\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"i2s_audio_id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` i2s_output\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"dac_type\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` external\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"channel\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` stereo\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"timeout\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` never\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"buffer_duration\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 100ms\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# audio_dac: aic3204_dac\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Virtual speakers to combine the announcement and media streams together into one output\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"platform\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` mixer\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` mixing_speaker\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"output_speaker\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` i2s_audio_speaker\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"num_channels\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"2\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"source_speakers\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` announcement_mixing_input\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"timeout\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` never\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` media_mixing_input\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"timeout\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` never\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Vritual speakers to resample each pipelines' audio, if necessary, as the mixer speaker requires the same sample rate\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"platform\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` resampler\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` announcement_resampling_speaker\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"output_speaker\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` announcement_mixing_input\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"sample_rate\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"48000\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"bits_per_sample\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"16\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"platform\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` resampler\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` media_resampling_speaker\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"output_speaker\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` media_mixing_input\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"sample_rate\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"48000\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"bits_per_sample\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"16\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"media_player\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"platform\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` speaker\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` external_media_player\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"name\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` Media Player\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"internal\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean important\",children:\"False\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"volume_increment\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0.05\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"volume_min\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0.4\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"volume_max\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0.85\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"announcement_pipeline\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"speaker\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` announcement_resampling_speaker\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"format\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" FLAC     \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# FLAC is the least processor intensive codec\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"num_channels\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Stereo audio is unnecessary for announcements\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"sample_rate\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"48000\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"media_pipeline\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"speaker\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` media_resampling_speaker\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"format\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" FLAC     \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# FLAC is the least processor intensive codec\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"num_channels\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"2\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"sample_rate\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"48000\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"on_mute\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"script.execute\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` control_leds\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"on_unmute\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"script.execute\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` control_leds\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"on_volume\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"script.execute\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` control_leds\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"on_announcement\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"mixer_speaker.apply_ducking\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` media_mixing_input\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"decibel_reduction\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"20\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"duration\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 0.0s\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"on_state\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"if\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"condition\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"and\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"switch.is_off\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` timer_ringing\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"not\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"voice_assistant.is_running\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"not\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"media_player.is_announcing\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"then\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"mixer_speaker.apply_ducking\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` media_mixing_input\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"decibel_reduction\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"duration\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 1.0s\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"files\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` center_button_press_sound\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"file\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" $\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"center_button_press_sound_file\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` center_button_double_press_sound\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"file\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" $\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"center_button_double_press_sound_file\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` center_button_triple_press_sound\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"file\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" $\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"center_button_triple_press_sound_file\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` center_button_long_press_sound\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"file\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" $\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"center_button_long_press_sound_file\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` factory_reset_initiated_sound\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"file\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" https\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"//github.com/esphome/home\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\"assistant\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\"voice\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),`pe/raw/dev/sounds/factory_reset_initiated.mp3\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` factory_reset_cancelled_sound\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"file\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" https\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"//github.com/esphome/home\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\"assistant\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\"voice\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),`pe/raw/dev/sounds/factory_reset_cancelled.mp3\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` factory_reset_confirmed_sound\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"file\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" https\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"//github.com/esphome/home\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\"assistant\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\"voice\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),`pe/raw/dev/sounds/factory_reset_confirmed.mp3\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` jack_connected_sound\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"file\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" $\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"jack_connected_sound_file\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` jack_disconnected_sound\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"file\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" $\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"jack_disconnected_sound_file\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` mute_switch_on_sound\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"file\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" $\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"mute_switch_on_sound_file\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` mute_switch_off_sound\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"file\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" $\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"mute_switch_off_sound_file\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` timer_finished_sound\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"file\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" $\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"timer_finished_sound_file\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` wake_word_triggered_sound\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"file\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" $\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"wake_word_triggered_sound_file\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` easter_egg_tick_sound\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"file\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" https\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"//github.com/esphome/home\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\"assistant\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\"voice\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),`pe/raw/dev/sounds/easter_egg_tick.mp3\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` easter_egg_tada_sound\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"file\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" https\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"//github.com/esphome/home\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\"assistant\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\"voice\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),`pe/raw/dev/sounds/easter_egg_tada.mp3\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` error_cloud_expired\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"file\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" https\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"//github.com/esphome/home\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\"assistant\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\"voice\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),`pe/raw/dev/sounds/error_cloud_expired.mp3\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"external_components\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"source\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"type\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` git\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"url\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" https\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"//github.com/esphome/home\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\"assistant\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\"voice\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),`pe\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"ref\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` dev\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"components\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),` voice_kit\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"refresh\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 0s\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"micro_wake_word\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` mww\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"microphone\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"microphone\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` i2s_mics\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"channels\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"gain_factor\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"4\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"stop_after_detection\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean important\",children:\"false\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"models\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"model\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" https\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`//github.com/kahrendt/microWakeWord/releases/download/okay_nabu_20241226.3/okay_nabu.json\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` okay_nabu\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"model\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` hey_jarvis\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` hey_jarvis\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"model\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` hey_mycroft\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` hey_mycroft\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"model\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" https\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`//github.com/kahrendt/microWakeWord/releases/download/stop/stop.json\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` stop\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"internal\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean important\",children:\"true\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"vad\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"on_wake_word_detected\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# If the wake word is detected when the device is muted (Possible with the software mute switch): Do nothing\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"if\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"condition\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"switch.is_off\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` master_mute_switch\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"then\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# If a timer is ringing: Stop it, do not start the voice assistant (We can stop timer from voice!)\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"if\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"condition\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"switch.is_on\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` timer_ringing\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"then\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"switch.turn_off\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` timer_ringing\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Stop voice assistant if running\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"else\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"if\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"condition\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                      \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"voice_assistant.is_running\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"then\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                      \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"voice_assistant.stop\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                    \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Stop any other media player announcement\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"else\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"if\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"condition\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                            \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"media_player.is_announcing\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"then\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                            \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"media_player.stop\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                                \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"announcement\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean important\",children:\"true\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                          \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Start the voice assistant and play the wake sound, if enabled\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"else\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                            \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"if\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                                \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"condition\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                                  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"switch.is_on\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` wake_sound\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                                \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"then\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                                  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"script.execute\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                                      \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` play_sound\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                                      \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"priority\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean important\",children:\"true\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                                      \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"sound_file\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token tag\",children:\"!lambda\"}),` return id(wake_word_triggered_sound);\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                                  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"delay\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 300ms\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                            \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"voice_assistant.start\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                                \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"wake_word\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token tag\",children:\"!lambda\"}),` return wake_word;\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"select\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"platform\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` template\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"name\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"Wake word sensitivity\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"optimistic\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean important\",children:\"true\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"initial_option\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` Slightly sensitive\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"restore_value\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean important\",children:\"true\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"entity_category\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` config\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"options\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),` Slightly sensitive\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),` Moderately sensitive\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),` Very sensitive\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"on_value\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Sets specific wake word probabilities computed for each particular model\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Note probability cutoffs are set as a quantized uint8 value, each comment has the corresponding floating point cutoff\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# False Accepts per Hour values are tested against all units and channels from the Dinner Party Corpus.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# These cutoffs apply only to the specific models included in the firmware: okay_nabu@20241226.3, hey_jarvis@v2, hey_mycroft@v2\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"lambda\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"|\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:['        if (x == \"Slightly sensitive\") ',(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          id(okay_nabu).set_probability_cutoff(217);    // 0.85 \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"}),` 0.000 FAPH on DipCo (Manifest's default)\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          id(hey_jarvis).set_probability_cutoff(247);   // 0.97 \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"}),` 0.563 FAPH on DipCo (Manifest's default)\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          id(hey_mycroft).set_probability_cutoff(253);  // 0.99 \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"}),` 0.567 FAPH on DipCo\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),' else if (x == \"Moderately sensitive\") ',(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          id(okay_nabu).set_probability_cutoff(176);    // 0.69 \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"}),` 0.376 FAPH on DipCo\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          id(hey_jarvis).set_probability_cutoff(235);   // 0.92 \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"}),` 0.939 FAPH on DipCo\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          id(hey_mycroft).set_probability_cutoff(242);  // 0.95 \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"}),` 1.502 FAPH on DipCo (Manifest's default)\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),' else if (x == \"Very sensitive\") ',(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          id(okay_nabu).set_probability_cutoff(143);    // 0.56 \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"}),` 0.751 FAPH on DipCo\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          id(hey_jarvis).set_probability_cutoff(212);   // 0.83 \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"}),` 1.502 FAPH on DipCo\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          id(hey_mycroft).set_probability_cutoff(237);  // 0.93 \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"}),` 1.878 FAPH on DipCo\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"voice_assistant\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` va\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"microphone\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"microphone\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` i2s_mics\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"channels\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"media_player\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` external_media_player\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"micro_wake_word\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` mww\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"use_wake_word\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean important\",children:\"false\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"noise_suppression_level\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"auto_gain\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 0 dbfs\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"volume_multiplier\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"on_client_connected\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"lambda\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` id(init_in_progress) = false;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"micro_wake_word.start\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"lambda\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" id(voice_assistant_phase) = $\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"voice_assist_idle_phase_id\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"script.execute\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` control_leds\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"on_client_disconnected\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"voice_assistant.stop\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"lambda\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" id(voice_assistant_phase) = $\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"voice_assist_not_ready_phase_id\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"script.execute\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` control_leds\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"on_error\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Only set the error phase if the error code is different than duplicate_wake_up_detected or stt-no-text-recognized\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# These two are ignored for a better user experience\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"if\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"condition\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"and\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"lambda\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" return \",(0,n.jsx)(e.span,{className:\"token tag\",children:\"!id(init_in_progress);\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"lambda\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" return code \",(0,n.jsx)(e.span,{className:\"token tag\",children:\"!=\"}),` \"duplicate_wake_up_detected\";\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"lambda\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" return code \",(0,n.jsx)(e.span,{className:\"token tag\",children:\"!=\"}),' \"stt',(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\"no\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\"text\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),`recognized\";\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"then\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"lambda\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" id(voice_assistant_phase) = $\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"voice_assist_error_phase_id\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"script.execute\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` control_leds\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# If the error code is cloud-auth-failed, serve a local audio file guiding the user.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"if\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"condition\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"lambda\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),' return code == \"cloud',(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\"auth\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),`failed\";\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"then\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"script.execute\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` play_sound\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"priority\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean important\",children:\"true\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"sound_file\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token tag\",children:\"!lambda\"}),` return id(error_cloud_expired);\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# When the voice assistant starts: Play a wake up sound, duck audio.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"on_start\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"mixer_speaker.apply_ducking\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` media_mixing_input\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"decibel_reduction\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"20\"}),\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Number of dB quieter; higher implies more quiet, 0 implies full volume\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"duration\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" 0.0s         \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# The duration of the transition (default is no transition)\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"on_listening\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"lambda\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" id(voice_assistant_phase) = $\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"voice_assist_waiting_for_command_phase_id\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"script.execute\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` control_leds\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"on_stt_vad_start\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"lambda\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" id(voice_assistant_phase) = $\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"voice_assist_listening_for_command_phase_id\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"script.execute\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` control_leds\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"on_stt_vad_end\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"lambda\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" id(voice_assistant_phase) = $\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"voice_assist_thinking_phase_id\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"script.execute\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` control_leds\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"on_intent_progress\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"if\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"condition\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# A nonempty x variable means a streaming TTS url was sent to the media player\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"lambda\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'return !x.empty();'\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"then\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"lambda\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" id(voice_assistant_phase) = $\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"voice_assist_replying_phase_id\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"script.execute\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` control_leds\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Start a script that would potentially enable the stop word if the response is longer than a second\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"script.execute\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` activate_stop_word_once\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"on_tts_start\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"if\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"condition\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# The intent_progress trigger didn't start the TTS Reponse\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"lambda\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'return id(voice_assistant_phase) != ${voice_assist_replying_phase_id};'\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"then\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"lambda\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" id(voice_assistant_phase) = $\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"voice_assist_replying_phase_id\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"script.execute\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` control_leds\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Start a script that would potentially enable the stop word if the response is longer than a second\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"script.execute\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` activate_stop_word_once\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# When the voice assistant ends ...\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"on_end\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"wait_until\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"not\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"voice_assistant.is_running\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Stop ducking audio.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"mixer_speaker.apply_ducking\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` media_mixing_input\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"decibel_reduction\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"duration\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 1.0s\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# If the end happened because of an error, let the error phase on for a second\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"if\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"condition\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"lambda\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" return id(voice_assistant_phase) == $\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"voice_assist_error_phase_id\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"then\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"delay\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 1s\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Reset the voice assistant phase id and reset the LED animations.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"lambda\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" id(voice_assistant_phase) = $\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"voice_assist_idle_phase_id\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`;\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"script.execute\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` control_leds\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"on_timer_finished\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"switch.turn_on\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` timer_ringing\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"on_timer_started\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"script.execute\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` control_leds\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"on_timer_cancelled\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"script.execute\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` control_leds\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"on_timer_updated\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"script.execute\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` control_leds\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"on_timer_tick\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"script.execute\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` control_leds\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"button\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"platform\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` factory_reset\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` factory_reset_button\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"name\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"Factory Reset\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"entity_category\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` diagnostic\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"internal\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean important\",children:\"true\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"platform\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` restart\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` restart_button\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"name\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"Restart\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"entity_category\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` config\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"disabled_by_default\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean important\",children:\"true\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"icon\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"mdi:restart\"'}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"debug\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"update_interval\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 5s\n`]})]})}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Important:\"}),\" You need to set the PSRAM mode to octal or quad depending on the type of the board by referring to \",(0,n.jsx)(e.a,{href:\"https://docs.espressif.com/projects/esp-idf/en/stable/esp32s3/hw-reference/esp32s3/user-guide-devkitc-1.html#ordering-information\",children:\"this\"}),\" link.\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Step 6\"}),\": click on \\u201C\",(0,n.jsx)(e.strong,{children:\"Save\"}),\"\\u201D and then click on \\u201C\",(0,n.jsx)(e.strong,{children:\"Install\"}),\"\\u201D on the top right-hand corner.\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Step 7\"}),\": Now, click on the \\u201C\",(0,n.jsx)(e.strong,{children:\"Manual Download\"}),\"\\u201D option and then choose \\u201C\",(0,n.jsx)(e.strong,{children:\"Modern Format\"}),\"\\u201D.\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Step 8\"}),\": Save the file to your computer.\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Step 9\"}),\": Open \",(0,n.jsx)(e.a,{href:\"https://web.esphome.io\",children:\"https://web.esphome.io\"}),\". in Chrome or Edge browser.\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Step 10\"}),\": Now connect the ESP32 S3 dev Board to the laptop and click on \\u201C\",(0,n.jsx)(e.strong,{children:\"Connect\"}),\"\\u201D and you should get a popup window like this.\"]}),`\n`,(0,n.jsx)(e.div,{children:(0,n.jsx)(l,{alt:\"3-select-usb.webp\",src:\"/static/images/2023/esp32-voice-assistant/3-select-usb.webp\",width:\"567\",height:\"247\"})}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Step 11\"}),\": Select the USB serial port for your device and click on \\u201C\",(0,n.jsx)(e.strong,{children:\"Install\"}),\"\\u201D\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Step 12\"}),\": Now load the file you saved in \",(0,n.jsx)(e.strong,{children:\"Step 8\"}),\" and click on \\u201C\",(0,n.jsx)(e.strong,{children:\"Install\"}),\"\\u201D.\"]}),`\n`,(0,n.jsx)(e.div,{children:(0,n.jsx)(l,{alt:\"4-erasing.webp\",src:\"/static/images/2023/esp32-voice-assistant/4-erasing.webp\",width:\"314\",height:\"227\"})}),`\n`,(0,n.jsxs)(e.blockquote,{children:[`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Note:\"}),\" In case the board does not go from connecting to erasing after some time, you can try to put the device into flashing mode. For this, press and hold the \",(0,n.jsx)(e.strong,{children:\"Boot\"}),\" button, then the \",(0,n.jsx)(e.strong,{children:\"Reset\"}),\" button, leave the \",(0,n.jsx)(e.strong,{children:\"Reset\"}),\" button, and then finally leave the \",(0,n.jsx)(e.strong,{children:\"Boot\"}),\" button.\"]}),`\n`]}),`\n`,(0,n.jsx)(e.p,{children:\"With this, you have now prepared your ESP32 S3 to start receiving a voice command after detecting the Wake Word.\"}),`\n`,(0,n.jsx)(e.p,{children:\"Next, we will connect it to Home Assistant.\"}),`\n`,(0,n.jsxs)(e.h2,{id:\"connecting-esp32-s3-as-voice-assistant-in-home-assistant\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#connecting-esp32-s3-as-voice-assistant-in-home-assistant\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Connecting ESP32 S3 As Voice Assistant In Home Assistant\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Once the ESP32 S3 is flashed with the code in the above section, we will connect it to Home Assistant using the ESPHome Integration.\"}),`\n`,(0,n.jsx)(e.p,{children:\"For this, follow these steps.\"}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Step 1\"}),\": Click \\u201C\",(0,n.jsx)(e.strong,{children:\"Settings\"}),\"\\u201D in Home Assistant in the left panel.\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Step 2\"}),\": Click on \\u201C\",(0,n.jsx)(e.strong,{children:\"Devices \u0026 Services\"}),\"\\u201D\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"Now, if the device is already auto-discovered, you can click on \\u201C\",(0,n.jsx)(e.strong,{children:\"Configure\"}),\"\\u201D and with this, the device is connected to Home Assistant.\"]}),`\n`,(0,n.jsx)(e.p,{children:\"If the device is not auto-discovered, then\"}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Step 3\"}),\": Click on \\u201C\",(0,n.jsx)(e.strong,{children:\"Add Integration\"}),\"\\u201D in the bottom right-hand corner.\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Step 4\"}),\": Search for \\u201C\",(0,n.jsx)(e.strong,{children:\"ESPhome\"}),\"\\u201D and click on it.\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Step 5\"}),\": Add the IP address of your ESP32 S3 board that is connected to your WiFi. Keep the port number as \",(0,n.jsx)(e.strong,{children:\"6053\"}),\" and click \\u201C\",(0,n.jsx)(e.strong,{children:\"Submit\"}),\"\\u201D\"]}),`\n`,(0,n.jsx)(e.div,{children:(0,n.jsx)(l,{alt:\"5-esp32-connect-home-assistant.webp\",src:\"/static/images/2023/esp32-voice-assistant/5-esp32-connect-home-assistant.webp\",width:\"431\",height:\"320\"})}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Step 6\"}),\": If you are asked to enter the encryption key then you can find that in ESPHome under the property \",(0,n.jsx)(e.code,{children:\"api: encryption: key\"}),\". Copy and paste the key in the window.\"]}),`\n`,(0,n.jsx)(e.p,{children:\"With this, you are now done setting up the ESP32 S3 with On-Device Wake Word detection for your Voice Assistant connected to Home Assistant.\"}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:(0,n.jsx)(e.a,{href:\"https://smarthomecircle.com/connect-bluetooth-devices-to-home-assistant-with-bluetooth-proxy\",children:(0,n.jsx)(e.strong,{children:\"Connect Bluetooth Devices to Home Assistant with Bluetooth Proxy\"})})}),`\n`,(0,n.jsx)(e.li,{children:(0,n.jsx)(e.a,{href:\"https://smarthomecircle.com/how-to-connect-led-strip-with-home-assistant-using-wled\",children:(0,n.jsx)(e.strong,{children:\"Control LED Strip with Home Assistant\\u200AUsing WLED\"})})}),`\n`,(0,n.jsx)(e.li,{children:(0,n.jsx)(e.a,{href:\"https://smarthomecircle.com/how-to-connect-wifi-to-home-assistant-on-startup\",children:(0,n.jsx)(e.strong,{children:\"Connect Home Assistant to the WIFI on First Boot\"})})}),`\n`]})]})}}var S=x;function o(a,s){throw new Error(\"Expected \"+(s?\"component\":\"object\")+\" `\"+a+\"` to be defined: you likely forgot to import, pass, or provide it.\")}return A;})();\n;return Component;","toc":[{"value":"Requirements","url":"#requirements","depth":2},{"value":"3D Print Template For Voice Assistant Case","url":"#3d-print-template-for-voice-assistant-case","depth":2},{"value":"Set up Voice Assist Pipeline","url":"#set-up-voice-assist-pipeline","depth":2},{"value":"Circuit Diagram for ESP32 S3 With INMP441 Microphone \u0026 MAX98357A Audio Amplifier","url":"#circuit-diagram-for-esp32-s3-with-inmp441-microphone--max98357a-audio-amplifier","depth":2},{"value":"Flashing Code to ESP32 S3 with ESPHome","url":"#flashing-code-to-esp32-s3-with-esphome","depth":2},{"value":"Connecting ESP32 S3 As Voice Assistant In Home Assistant","url":"#connecting-esp32-s3-as-voice-assistant-in-home-assistant","depth":2}],"frontMatter":{"readingTime":{"text":"63 min read","minutes":62.435,"time":3746100,"words":12487},"slug":"2024/How-I-created-my-voice-assistant-with-on-device-wake-word-using-home-assistant","fileName":"2024/How-I-created-my-voice-assistant-with-on-device-wake-word-using-home-assistant.md","title":"How I Created My Voice Assistant With On-Device Wake Word Detection On ESP32 Using Micro Wake Word","author":"Amrut Prabhu","categories":"","tags":["Wake Word","Micro Wake Word","ESP32","Voice Assistant","Home Assistant"],"photo-credits":null,"applaud-link":"2021/spring-boot-stream-kafka.json","date":"2024-05-23T00:00:00.000Z","draft":false,"autoAds":true,"summary":"In this article, we will look at how I created my Voice Assistant with an ESP32 S3 with on-device Wake Word detection using MicroWake Word to send commands to Home Assistant","imageUrl":"/static/images/2024/created-my-voice-assistant/cover.webp","actualUrl":"2024/How-I-created-my-voice-assistant-with-on-device-wake-word-using-home-assistant","customUrl":"How-I-created-my-voice-assistant-with-on-device-wake-word-using-home-assistant","youtubeLink":"https://www.youtube.com/embed/aPP2alIU7Gg"}},"authorDetails":[{"readingTime":{"text":"2 min read","minutes":1.045,"time":62700,"words":209},"slug":["default"],"fileName":"default.md","name":"Amrut Prabhu","avatar":"/static/images/avatar-small.jpg","avatarBig":"/static/images/avatar-big.jpg","occupation":"","company":"","email":"contactsmarthomecircle@gmail.com","twitter":"https://twitter.com/smarthomecircle","linkedin":"","github":"","youtube":"https://www.youtube.com/@SmartHomeCircle","customUrl":"default","actualUrl":"default","date":null}],"prev":{"title":"How To Setup On-Device Wake Word Detection For Voice Assistant using Micro Wake Word","author":"Amrut Prabhu","categories":"","tags":["Wake Word","Micro Wake Word","ESP32","Voice Assistant","Home Assistant"],"photo-credits":null,"applaud-link":"2021/spring-boot-stream-kafka.json","date":"2024-04-04T00:00:00.000Z","draft":false,"autoAds":true,"summary":"In this article, we will look at how we can set up an ESP32 S3 with on-device Wake Word detection using MicroWake Word for your Voice Assistant to send commands to Home Assistant","imageUrl":"/static/images/2024/on-device-wake-word/cover.webp","actualUrl":"2024/How-to-setup-on-device-wake-word-for-voice-assistant-home-assistant","customUrl":"How-to-setup-on-device-wake-word-for-voice-assistant-home-assistant","youtubeLink":"https://www.youtube.com/embed/rT_q0g8dtmY","slug":"How-to-setup-on-device-wake-word-for-voice-assistant-home-assistant"},"next":{"title":"Voice Assistant Timers With On-Device Wake Word Detection On ESP32 S3","author":"Amrut Prabhu","categories":"","tags":["Wake Word","Micro Wake Word","ESP32","Voice Assistant","Home Assistant"],"photo-credits":null,"applaud-link":"2021/spring-boot-stream-kafka.json","date":"2024-07-18T00:00:00.000Z","draft":false,"autoAds":true,"summary":"In this article, we will look at how I added timers to my Voice Assistant with an ESP32 S3 with on-device Wake Word detection","imageUrl":"/static/images/2024/add-timer-to-voice-assistant/cover.webp","actualUrl":"2024/add-timers-to-voice-assistant-on-device-wake-word-home-assistant","customUrl":"add-timers-to-voice-assistant-on-device-wake-word-home-assistant","youtubeLink":"https://www.youtube.com/embed/QMCB6hLPUM4","slug":"add-timers-to-voice-assistant-on-device-wake-word-home-assistant"}},"__N_SSG":true},"page":"/[slug]","query":{"slug":"How-I-created-my-voice-assistant-with-on-device-wake-word-using-home-assistant"},"buildId":"IF3Ce1pL9YmMukIvsy3Ax","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>